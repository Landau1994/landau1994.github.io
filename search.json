[{"title":"LUMI-lab","url":"/2026/02/25/LUMI-lab/","content":"\n# Cell 2026 LUMI-lab: A foundation model-driven autonomous platform enabling discovery of ionizable lipid designs for mRNA delivery\n\n## Quick Summary\n> The authors present [[Cell 2026 LUMI-lab]], a fully autonomous self-driving laboratory that integrates a molecular foundation model with high-throughput robotics to discover novel [[ionizable lipids]] for [[mRNA delivery]]. By employing an iterative [[active learning]] workflow that balances exploration and exploitation, the system synthesized and screened over 1,700 lipid candidates, identifying [[brominated lipid tails]] as a potent structural motif. The top candidate, [[LUMI-6]], demonstrated superior pulmonary transfection efficiency, achieving 20.3% gene editing efficacy in mouse lung epithelial cells.\n\n## Key Points\n- Introduction of **LUMI-lab**, a closed-loop platform combining AI, robotics, and biological screening.\n- Development of **LUMI-model**, a transformer-based 3D molecular foundation model adapted for data-sparse environments via continual pretraining.\n- Autonomous synthesis and screening of >1,700 [[Lipid Nanoparticles]] (LNPs) over 10 active learning iterations.\n- Discovery of **brominated tails** as a non-intuitive structural feature that significantly enhances [[endosomal escape]] and mRNA transfection.\n- In vivo validation showed [[LUMI-6]] outperforms clinically approved benchmarks ([[SM-102]] and [[MC3]]) in pulmonary gene editing.\n\n## Methods\n### Data\n- **Pretraining Dataset**: 13,369,320 generic small molecules with 147M 3D conformations (derived from [[Uni-Mol]] dataset).\n- **Continual Pretraining Dataset**: 15,491,072 lipid-like molecules (170M conformations) generated via combinatorial enumeration of the Ugi-4CR reaction space.\n- **Experimental Data**: 1,781 distinct ionizable lipids synthesized and tested for mRNA transfection potency (mTP) in human bronchial epithelial ([[HBE]]) cells.\n\n### Model Architecture\n- **LUMI-model**: A 15-layer [[Transformer]] architecture based on [[Uni-Mol]].\n- **Input**: Atom types and 3D atomic coordinates to capture conformation-aware representations.\n- **Embeddings**: Atom-type aware Gaussian Kernel used to encode pairwise distances, ensuring invariance to global rotation/translation.\n\n### Training Strategy\n- **Stage 1: Unsupervised Pretraining**: Masked atom prediction, 3D position recovery, and contrastive learning on generic molecules.\n- **Stage 2: Continual Pretraining**: Domain adaptation on the lipid-like dataset to prioritize features relevant to LNP engineering.\n- **Stage 3: Active Learning Fine-tuning**: Supervised fine-tuning on experimental data collected during iterations.\n    - **Dual-Plate Strategy**: Each iteration synthesized two platesâ€”one for **exploitation** (high predicted potency) and one for **exploration** (high ensemble uncertainty).\n\n## Results\n| Metric | Value | Baseline ([[SM-102]]/[[MC3]]) |\n|--------|-------|----------|\n| In vivo Gene Editing (Lung Epithelial) | 20.3% | < 5% (estimated from plots) |\n| Top 25% Pearson Correlation (Noise $\\sigma$=8) | 0.51 | ~0.37 ([[LiON]]) |\n| Transfection Efficiency (relative to LUMI-6D) | 1.8-fold higher | N/A |\n\n## Figures\n\n| Figure | Description |\n| ------ | ----------- |\n| Fig 1  | Overview of [[Cell 2026 LUMI-lab]] hardware/software architecture, demonstrating the closed-loop cycle of design, synthesis, formulation, and testing. |\n| Fig 2  | The three-stage training pipeline of [[LUMI-model]] and benchmark comparisons showing superior performance against GNNs and XGBoost. |\n| Fig 3  | Visualization of the dual-plate [[active learning]] strategy (exploitation vs. exploration) and the rapid enrichment of high-potency lipids over 10 iterations. |\n| Fig 4  | UMAP analysis revealing the clustering of [[brominated lipids]] and their high prediction/experimental performance. |\n| Fig 5  | Identification of top candidates (LUMI-1 to LUMI-6) and *in vivo* validation in mice via intratracheal administration. |\n| Fig 6  | Evaluation of [[LUMI-6]] for [[CRISPR-Cas9]] gene editing in [[Ai9 mice]], showing high efficiency in lung epithelial cells. |\n\n## Critical Analysis\n### Strengths\n- **Closed-Loop Integration**: Seamlessly connects computational prediction with robotic execution, removing human bottlenecks in the DMTA (Design-Make-Test-Analyze) cycle.\n- **Data Efficiency**: The foundation model approach allows effective learning from sparse wet-lab data (few-shot learning), a common hurdle in material discovery.\n- **Novel Insight**: The system identified [[bromination]] as a key feature, a modification not typically prioritized in expert-driven lipid design, validating the AI's ability to find non-intuitive SARs.\n- **Robust Validation**: Moved beyond *in vitro* screening to demonstrate significant functional efficacy in live animal models.\n\n### Weaknesses\n- **Fixed Formulation**: The screening used a standardized helper lipid formulation. The paper acknowledges that co-optimizing the lipid structure *and* the formulation ratio simultaneously could yield even better results.\n- **Chemical Space Limits**: Synthesis was restricted to 4-component Ugi reactions. While combinatorial, it doesn't cover all possible lipid chemistries.\n- **Generative Limits**: The model selects from an enumerated library rather than performing *de novo* generative design, potentially limiting the search space to the pre-defined building blocks.\n\n### Questions\n- How transferable is the [[LUMI-model]] to other tissue targets (e.g., liver, spleen, brain) without extensive retraining?\n- Does the bromination motif pose any long-term toxicity or metabolic accumulation risks not captured in the 28-day subchronic toxicity study?\n\n## Connections\n### Related Papers\n- [[Uni-Mol]]: The architectural backbone for the foundation model.\n- [[LiON]]: A graph-based hybrid method used as a baseline comparison.\n- Papers describing [[SM-102]] (Moderna) and [[MC3]] (Alnylam) as industry standards.\n\n### Related Concepts\n- [[Self-Driving Laboratories]] (SDLs)\n- [[Active Learning]]\n- [[Foundation Models]] in Chemistry\n- [[Lipid Nanoparticles]] (LNPs)\n- [[CRISPR-Cas9]] Delivery\n\n### Potential Applications\n- Pulmonary gene therapy (e.g., Cystic Fibrosis).\n- Rapid development of mRNA vaccines for emerging pathogens.\n- Automated discovery of materials for other biomedical applications (e.g., polymer design).\n\n## Notes\n- The \"2026\" date in the citation suggests this is a \"future-dated\" issue or pre-press release metadata provided in the prompt.\n- The use of \"Exploitation\" and \"Exploration\" plates is a clever practical implementation of Bayesian Optimization principles in a high-throughput physical setting.","tags":["note"],"categories":["genomics"]},{"title":"AlphaGenome ç®€ä»‹","url":"/2026/02/25/AlphaGenome/","content":"\n\n\n# Nature 2026 Advancing regulatory variant effect prediction with AlphaGenome\n\n## Quick Summary\n\n> AlphaGenome æ˜¯ç”± Google DeepMind å¼€å‘å¹¶å‘è¡¨äº _Nature_ çš„ä¸€ç§ç»Ÿä¸€çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œæ—¨åœ¨è§£å†³åŸºå› ç»„åºåˆ—å»ºæ¨¡ä¸­â€œé•¿è·ç¦»ä¸Šä¸‹æ–‡â€ä¸â€œé«˜åˆ†è¾¨ç‡é¢„æµ‹â€ä¹‹é—´çš„æƒè¡¡éš¾é¢˜ã€‚è¯¥æ¨¡å‹æ¥å— **1 Mb** çš„ DNA åºåˆ—ä½œä¸ºè¾“å…¥ï¼Œèƒ½å¤Ÿä»¥ **å•ç¢±åŸºåˆ†è¾¨ç‡** åŒæ—¶é¢„æµ‹ 5,930 ä¸ªï¼ˆäººç±»ï¼‰å’Œ 1,128 ä¸ªï¼ˆå°é¼ ï¼‰åŠŸèƒ½åŸºå› ç»„è½¨é“ï¼Œæ¶µç›–åŸºå› è¡¨è¾¾ã€å‰ªæ¥ï¼ˆä½ç‚¹ã€ä½¿ç”¨ç‡åŠè¿æ¥ï¼‰ã€æŸ“è‰²è´¨å¯åŠæ€§ã€ç»„è›‹ç™½ä¿®é¥°ã€è½¬å½•å› å­ç»“åˆä»¥åŠ 3D æŸ“è‰²ä½“æ¥è§¦å›¾è°±ã€‚åœ¨ 26 é¡¹å˜å¼‚æ•ˆåº”é¢„æµ‹ï¼ˆVEPï¼‰åŸºå‡†æµ‹è¯•ä¸­ï¼ŒAlphaGenome åœ¨ **25 é¡¹** ä¸Šè¾¾åˆ°æˆ–è¶…è¿‡äº†ç°æœ‰çš„æœ€ä½³æ¨¡å‹ï¼ˆSOTAï¼‰ï¼Œå¹¶å±•ç¤ºäº†åœ¨è§£é‡Šç½•è§ç—…å’Œç™Œç—‡ï¼ˆå¦‚ T-ALL ä¸­çš„ _TAL1_ å¢å¼ºå­çªå˜ï¼‰éç¼–ç åŒºå˜å¼‚æœºåˆ¶æ–¹é¢çš„å¼ºå¤§èƒ½åŠ›ã€‚\n\n## Key Points\n\n- **ç»Ÿä¸€çš„å…¨èƒ½æ¶æ„**ï¼šåœ¨ä¸€ä¸ªæ¨¡å‹ä¸­åŒæ—¶å®ç°äº†é•¿åºåˆ—å»ºæ¨¡ï¼ˆ1 Mb ä¸Šä¸‹æ–‡ï¼‰å’Œå•ç¢±åŸºè¾“å‡ºç²¾åº¦ï¼Œæ‰“ç ´äº†ä»¥å¾€æ¨¡å‹ï¼ˆå¦‚ Enformer ç‰ºç‰²åˆ†è¾¨ç‡ï¼ŒSpliceAI ç‰ºç‰²é•¿åº¦ï¼‰çš„å±€é™ã€‚\n    \n- **SOTA æ€§èƒ½**ï¼šåœ¨ 22/24 ä¸ªåŸºå› ç»„è½¨é“é¢„æµ‹ä»»åŠ¡å’Œ 25/26 ä¸ªå˜å¼‚æ•ˆåº”é¢„æµ‹ä»»åŠ¡ä¸­è¡¨ç°ä¼˜äºç°æœ‰æœ€ä½³æ¨¡å‹ï¼ˆåŒ…æ‹¬ Borzoi, Orca, Pangolin ç­‰ï¼‰ã€‚\n    \n- **å‰ªæ¥é¢„æµ‹çš„çªç ´**ï¼šä¸ä»…é¢„æµ‹å‰ªæ¥ä½ç‚¹ï¼Œè¿˜å¼•å…¥äº†ç›´æ¥é¢„æµ‹ **å‰ªæ¥è¿æ¥ï¼ˆSplice Junctionsï¼‰** çš„æœºåˆ¶ï¼Œèƒ½æ›´å‡†ç¡®åœ°è¯†åˆ«å¤–æ˜¾å­è·³è·ƒç­‰å¤æ‚å‰ªæ¥å˜å¼‚ã€‚\n    \n- **é«˜æ•ˆè’¸é¦**ï¼šé€šè¿‡â€œé¢„è®­ç»ƒ+è’¸é¦â€ç­–ç•¥ï¼Œå°†å¤§å‹é›†æˆæ¨¡å‹çš„çŸ¥è¯†å‹ç¼©åˆ°å•ä¸ªå­¦ç”Ÿæ¨¡å‹ä¸­ï¼Œåœ¨å•ä¸ª GPU ä¸Šæ¨ç†æ—¶é—´å°äº 1 ç§’ï¼Œå¤§å¹…é™ä½äº†åº”ç”¨é—¨æ§›ã€‚\n    \n\n## Methods\n\n### Data\n\n- **è®­ç»ƒæ•°æ®**ï¼šæ¥è‡ª ENCODE, GTEx, FANTOM5, 4D Nucleome ç­‰é¡¹ç›®çš„å…¬å¼€æ•°æ®ã€‚\n    \n- **æ¶µç›–æ¨¡æ€**ï¼šRNA-seq, CAGE, PRO-cap, DNase-seq, ATAC-seq, ChIP-seq (TF & Histone), Hi-C/Micro-Cã€‚\n    \n- **ç‰©ç§**ï¼šäººç±» (hg38) å’Œ å°é¼  (mm10)ã€‚\n    \n\n### Model Architecture\n\n- **ä¸»å¹²**ï¼šU-Net é£æ ¼çš„ç¼–ç å™¨-è§£ç å™¨æ¶æ„ ã€‚\n    \n    - **Encoder**ï¼šå·ç§¯å±‚å°† 1 Mb åºåˆ—ä¸‹é‡‡æ ·ã€‚\n        \n    - **Transformer Tower**ï¼šå¤„ç†é•¿è·ç¦»ä¾èµ–å…³ç³»ï¼Œå¹¶ç”Ÿæˆç”¨äºé¢„æµ‹æ¥è§¦å›¾è°±çš„ 2D åµŒå…¥ã€‚\n        \n    - **Decoder**ï¼šé€šè¿‡è·³è·ƒè¿æ¥ï¼ˆSkip connectionsï¼‰å°†ç‰¹å¾ä¸Šé‡‡æ ·å› 1 bp åˆ†è¾¨ç‡ã€‚\n        \n- **è¾“å‡ºå¤´**ï¼šé’ˆå¯¹ä¸åŒæ¨¡æ€åœ¨ä¸åŒåˆ†è¾¨ç‡ï¼ˆ1 bp, 128 bp, 2048 bpï¼‰è¾“å‡ºé¢„æµ‹ç»“æœã€‚ç‰¹åˆ«è®¾è®¡äº†èƒ½å¤Ÿæ•æ‰ä¾›ä½“-å—ä½“ç›¸äº’ä½œç”¨çš„å‰ªæ¥è¿æ¥é¢„æµ‹å¤´ ã€‚\n    \n\n### Training Strategy\n\n- **ä¸¤é˜¶æ®µè®­ç»ƒ**ï¼š\n    \n    1. **é¢„è®­ç»ƒ (Pre-training)**ï¼šåœ¨ 8 ä¸ª TPUv3 æ ¸å¿ƒä¸Šè¿›è¡Œåºåˆ—å¹¶è¡Œè®­ç»ƒï¼Œå­¦ä¹ é¢„æµ‹å®éªŒè½¨é“æ•°æ® ã€‚\n        \n    2. **è’¸é¦ (Distillation)**ï¼šè®­ç»ƒä¸€ä¸ªå­¦ç”Ÿæ¨¡å‹æ¥æ¨¡ä»¿â€œå…¨æŠ˜å ï¼ˆall-foldï¼‰â€æ•™å¸ˆæ¨¡å‹é›†æˆçš„é¢„æµ‹ã€‚æ­¤é˜¶æ®µå¼•å…¥äº†æ›´å¼ºçš„å¢å¼ºç­–ç•¥ï¼ˆå¦‚éšæœºçªå˜ï¼‰ï¼Œæ˜¾è‘—æå‡äº†æ¨¡å‹çš„é²æ£’æ€§å’Œå˜å¼‚æ•ˆåº”é¢„æµ‹èƒ½åŠ› ã€‚\n        \n\n## Results\n\n|**Metric**|**Value (AlphaGenome)**|**Baseline (SOTA)**|**Description**|\n|---|---|---|---|\n|VEP Benchmarks|**25/26**|-|åœ¨ 26 é¡¹å˜å¼‚æ•ˆåº”é¢„æµ‹åŸºå‡†ä¸­ï¼Œ25 é¡¹è¾¾åˆ°æˆ–è¶…è¶Š SOTA|\n|Gene Expr LFC (Pearson r)|**+14.7%**|(vs Borzoi)|ç»†èƒç±»å‹ç‰¹å¼‚æ€§åŸºå› è¡¨è¾¾é¢„æµ‹çš„ç›¸å¯¹æå‡|\n|Contact Map (Pearson r)|**+6.3%**|(vs Orca)|3D åŸºå› ç»„æ¥è§¦å›¾è°±é¢„æµ‹çš„ç›¸å¯¹æå‡|\n|eQTL Sign Prediction (auROC)|**0.80**|0.75 (Borzoi)|é¢„æµ‹ eQTL æ•ˆåº”æ–¹å‘çš„å‡†ç¡®æ€§|\n|ClinVar (Deep Intronic)|**0.66**|0.64 (Pangolin)|æ·±å±‚å†…å«å­è‡´ç—…å˜å¼‚çš„åˆ†ç±»ç²¾åº¦ (auPRC)|\n\n## Figures\n\n|**Figure**|**Description**|\n|---|---|\n|Fig 1|æ¨¡å‹æ¶æ„ã€è®­ç»ƒæµç¨‹ï¼ˆé¢„è®­ç»ƒä¸è’¸é¦ï¼‰æ¦‚è§ˆï¼Œä»¥åŠä¸ SOTA æ¨¡å‹åœ¨å„é¡¹åŸºå‡†ä¸Šçš„æ€§èƒ½å¯¹æ¯”æ‘˜è¦ ã€‚|\n|Fig 2|å±•ç¤ºäº†æ¨¡å‹åœ¨ LDLR ç­‰åŸºå› åº§ä¸Šçš„é«˜ç²¾åº¦è½¨é“é¢„æµ‹ï¼ˆåŒ…æ‹¬å‰ªæ¥è¿æ¥ï¼‰ï¼Œä»¥åŠå„æ¨¡æ€é¢„æµ‹å€¼ä¸è§‚æµ‹å€¼çš„é«˜ç›¸å…³æ€§ ã€‚|\n|Fig 3|å‰ªæ¥å˜å¼‚é¢„æµ‹æ·±å…¥åˆ†æï¼šå±•ç¤ºäº†æ¨¡å‹å¦‚ä½•å‡†ç¡®é¢„æµ‹å¯¼è‡´å¤–æ˜¾å­è·³è·ƒçš„ç½•è§å˜å¼‚ï¼Œå¹¶åœ¨ ClinVar åŸºå‡†æµ‹è¯•ä¸­é¢†å…ˆ ã€‚|\n|Fig 4|åŸºå› è¡¨è¾¾å˜å¼‚é¢„æµ‹ï¼ˆeQTLï¼‰ï¼šå±•ç¤ºäº†åœ¨ GTEx eQTL æ•ˆåº”å€¼å’Œæ–¹å‘é¢„æµ‹ä¸Šçš„æ˜¾è‘—æå‡ï¼Œä»¥åŠåœ¨ GWAS ä¿¡å·è§£è¯»ä¸­çš„åº”ç”¨ ã€‚|\n|Fig 5|æŸ“è‰²è´¨çŠ¶æ€å˜å¼‚é¢„æµ‹ï¼ˆcaQTL/bQTLï¼‰ï¼šå±•ç¤ºäº†å¯¹æŸ“è‰²è´¨å¯åŠæ€§å’Œè½¬å½•å› å­ç»“åˆå˜å¼‚çš„ç²¾å‡†é¢„æµ‹ ã€‚|\n|Fig 6|è·¨æ¨¡æ€æ¡ˆä¾‹åˆ†æï¼šè§£æ T-ALL ä¸­ TAL1 ç™ŒåŸºå› çš„éç¼–ç çªå˜æœºåˆ¶ï¼Œå±•ç¤ºæ¨¡å‹å¦‚ä½•é€šè¿‡å¤šæ¨¡æ€è¾“å‡ºæ­ç¤ºè‡´ç—…æœºç† ã€‚|\n\n## Critical Analysis\n\n### Strengths\n\n- **å¤šæ¨¡æ€æ•´åˆ**ï¼šæˆåŠŸå°†æ­¤å‰åˆ†è£‚çš„å¤šä¸ªé¢†åŸŸï¼ˆå¦‚å‰ªæ¥ã€è¡¨è¾¾ã€3Dç»“æ„ï¼‰æ•´åˆåˆ°ä¸€ä¸ªç»Ÿä¸€æ¡†æ¶ä¸­ï¼Œä¸”åœ¨å„å­ä»»åŠ¡ä¸Šå‡ä¸è¾“äºä¸“ç”¨æ¨¡å‹ã€‚\n    \n- **åˆ†è¾¨ç‡ä¼˜åŠ¿**ï¼šç›¸æ¯” Borzoi/Enformerï¼Œæä¾›äº†å•ç¢±åŸºåˆ†è¾¨ç‡çš„è¾“å‡ºï¼Œè¿™å¯¹äºè¯†åˆ«ç²¾ç»†çš„å‰ªæ¥ä½ç‚¹å’Œ TF ç»“åˆä½ç‚¹è‡³å…³é‡è¦ã€‚\n    \n- **æœºåˆ¶å¯è§£é‡Šæ€§**ï¼šä¸ä»…èƒ½é¢„æµ‹â€œå˜å¼‚è‡´ç—…â€ï¼Œè¿˜èƒ½é€šè¿‡å¤šæ¨¡æ€è¾“å‡ºï¼ˆå¦‚â€œè¯¥å˜å¼‚ç ´åäº† CTCF ç»“åˆå¹¶æ”¹å˜äº† 3D ç»“æ„ä»è€Œå½±å“è¡¨è¾¾â€ï¼‰æä¾›æœºåˆ¶è§£é‡Š ã€‚\n    \n\n### Weaknesses\n\n- **è¿œç«¯è°ƒæ§å±€é™**ï¼šå°½ç®¡è¾“å…¥é•¿è¾¾ 1 Mbï¼Œä½†åœ¨é¢„æµ‹è·ç¦»è¶…è¿‡ 100 kb çš„è¿œç«¯è°ƒæ§å…ƒä»¶å½±å“æ—¶ï¼Œæ€§èƒ½ä»æœ‰ä¸‹é™ï¼Œä»æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ ã€‚\n    \n- **ç»„ç»‡ç‰¹å¼‚æ€§**ï¼šè™½ç„¶è¡¨ç°ä¼˜å¼‚ï¼Œä½†åœ¨è·¨ç»†èƒèƒŒæ™¯ä¸‹ç²¾ç¡®å¤ç°æŸäº›ç»„ç»‡ç‰¹å¼‚æ€§æ¨¡å¼æ–¹é¢ä»æœ‰æå‡ç©ºé—´ ã€‚\n    \n- **éç¼–ç åŸºå› è¦†ç›–**ï¼šç›®å‰çš„è®­ç»ƒå’Œè¯„ä¼°ä¸»è¦é›†ä¸­åœ¨è›‹ç™½ç¼–ç åŸºå› ï¼Œå¯¹ microRNAs ç­‰éç¼–ç åŸºå› çš„è¦†ç›–ä¸è¶³ ã€‚\n    \n\n### Questions\n\n- å¦‚ä½•è¿›ä¸€æ­¥æ‰©å±•æ¨¡å‹ä»¥å¤„ç†æ›´é•¿èŒƒå›´ï¼ˆ>1 Mbï¼‰çš„ç›¸äº’ä½œç”¨ï¼Œä»¥æ•æ‰è¶…é•¿è·ç¦»çš„å¢å¼ºå­-å¯åŠ¨å­äº’ä½œï¼Ÿ\n    \n- æœªæ¥çš„ç‰ˆæœ¬æ˜¯å¦ä¼šæ•´åˆå•ç»†èƒæ•°æ®ï¼Œä»¥æé«˜åœ¨å¤æ‚ç»„ç»‡ä¸­ç»†èƒç±»å‹ç‰¹å¼‚æ€§çš„åˆ†è¾¨ç‡ï¼Ÿ\n    \n\n## Connections\n\n### Related Papers\n\n- **Borzoi (Linder et al., 2025)**: ä¸Šä¸€ä»£å¤šæ¨¡æ€ SOTAï¼ŒAlphaGenome çš„ä¸»è¦å¯¹æ¯”åŸºçº¿ã€‚\n    \n- **Enformer (Avsec et al., 2021)**: æœ¬æ–‡ç¬¬ä¸€ä½œè€…ä¹‹å‰çš„å¼€åˆ›æ€§å·¥ä½œï¼Œå¼•å…¥äº† Transformer å¤„ç†é•¿åºåˆ—ã€‚\n    \n- **Orca (Zhou, 2022)**: 3D åŸºå› ç»„é¢„æµ‹çš„ä¸“ç”¨æ¨¡å‹ï¼Œè¢« AlphaGenome åœ¨æ¥è§¦å›¾è°±ä»»åŠ¡ä¸Šè¶…è¶Šã€‚\n    \n- **Pangolin / SpliceAI**: å‰ªæ¥é¢„æµ‹é¢†åŸŸçš„æ ‡æ†ï¼ŒAlphaGenome åœ¨å‰ªæ¥ä»»åŠ¡ä¸Šçš„å¯¹æ¯”å¯¹è±¡ã€‚\n    \n\n### Related Concepts\n\n- **Sequence-to-Function**: ä»åºåˆ—ç›´æ¥é¢„æµ‹åŠŸèƒ½çš„å»ºæ¨¡èŒƒå¼ã€‚\n    \n- **In Silico Mutagenesis (ISM)**: è®¡ç®—æœºæ¨¡æ‹Ÿè¯±å˜ï¼Œç”¨äºè§£ææ¨¡å‹é¢„æµ‹èƒŒåçš„åºåˆ—åŸºåºï¼ˆMotifï¼‰ã€‚\n    \n- **Knowledge Distillation**: çŸ¥è¯†è’¸é¦ï¼Œæœ¬æ–‡ç”¨äºæå‡æ¨¡å‹æ¨ç†æ•ˆç‡å’Œé²æ£’æ€§çš„å…³é”®æŠ€æœ¯ã€‚\n    \n\n### Potential Applications\n\n- **å…¨åŸºå› ç»„å…³è”åˆ†æ (GWAS) è§£è¯»**ï¼šä¸ºéç¼–ç åŒº GWAS ä¿¡å·æä¾›å› æœå˜å¼‚å’Œåˆ†å­æœºåˆ¶çš„å‡è®¾ï¼ˆå¦‚ç¡®å®š eQTL çš„æ–¹å‘ï¼‰ã€‚\n    \n- **ä¸´åºŠå˜å¼‚è§£è¯»**ï¼šè¾…åŠ©è¯Šæ–­ç½•è§ç—…ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹é‚£äº›ç°æœ‰å·¥å…·éš¾ä»¥è§£é‡Šçš„æ·±å±‚å†…å«å­å˜å¼‚æˆ–éç¼–ç è°ƒæ§å˜å¼‚ã€‚\n    \n- **åºåˆ—è®¾è®¡**ï¼šç”¨äºè®¾è®¡å…·æœ‰ç‰¹å®šç»„ç»‡ç‰¹å¼‚æ€§çš„å¢å¼ºå­æˆ–ä¼˜åŒ–åä¹‰å¯¡æ ¸è‹·é…¸ï¼ˆASOï¼‰ç–—æ³• ã€‚\n    \n\n## Notes\n\n- è¿™æ˜¯ AlphaGenome çš„æ­£å¼å‘è¡¨ç‰ˆæœ¬ï¼ˆNature 2026ï¼‰ï¼Œä¸ä¹‹å‰çš„ bioRxiv ç‰ˆæœ¬ç›¸æ¯”ï¼ŒåŸºå‡†æµ‹è¯•ç»“æœæ›´åŠ å®Œå–„ï¼ˆå¦‚ VEP SOTA æ•°ä» 24/26 æ›´æ–°ä¸º 25/26ï¼‰ã€‚\n    \n- è®ºæ–‡æ˜ç¡®æŒ‡å‡ºï¼Œè¯¥æ¨¡å‹å¹¶æœªåœ¨â€œä¸ªäººåŸºå› ç»„é¢„æµ‹ï¼ˆpersonal genome predictionï¼‰â€ä»»åŠ¡ä¸Šè¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼Œè¿™æ˜¯è¯¥é¢†åŸŸæ¨¡å‹çš„ä¸€ä¸ªå·²çŸ¥å¼±ç‚¹ ã€‚","tags":["note","AIVC"],"categories":["genomics"]},{"title":"æˆ‘èŠ±äº†ä¸‰å¹´æ—¶é—´ï¼Œæ•´ç†äº†è¿™ä»½ç”Ÿç‰©ä¿¡æ¯å­¦èµ„æºæ¸…å•ï¼ˆ2026æœ€æ–°ç‰ˆï¼‰","url":"/2026/02/25/bioinformatics-resources-2026/","content":"\n## å†™åœ¨å‰é¢\n\nä½œä¸ºä¸€åç”Ÿç‰©ä¿¡æ¯å­¦ PhDï¼Œè¿™ä¸‰å¹´æ¥æœ€å¸¸è¢«å¸ˆå¼Ÿå¸ˆå¦¹ä»¬é—®åˆ°çš„é—®é¢˜å°±æ˜¯ï¼š\n\n> \"å­¦é•¿ï¼Œæœ‰ä»€ä¹ˆå¥½çš„ç”Ÿä¿¡å­¦ä¹ èµ„æºæ¨èå—ï¼Ÿ\"\n> \"AlphaFold æ€ä¹ˆç”¨å•Šï¼Ÿ\"\n> \"å“ªä¸ªå¤§æ¨¡å‹é€‚åˆå†™ä»£ç ï¼Ÿ\"\n> \"R å’Œ Python ç”¨ä»€ä¹ˆ IDE æ¯”è¾ƒå¥½ï¼Ÿ\"\n\næ¯æ¬¡éƒ½è¦ç¿»èŠå¤©è®°å½•æ‰¾é“¾æ¥ï¼Œå®åœ¨å¤ªéº»çƒ¦äº†ã€‚äºæ˜¯ï¼Œæˆ‘å†³å®šæŠŠè¿™äº›å¹´æ”¶è—çš„ä¼˜è´¨èµ„æº**ç³»ç»Ÿæ€§åœ°æ•´ç†å‡ºæ¥**ï¼Œåšæˆä¸€ä¸ªå®Œæ•´çš„èµ„æºå¯¼èˆªé¡µé¢ã€‚\n\nä»Šå¤©å°±æŠŠè¿™ä»½æ¸…å•åˆ†äº«ç»™å¤§å®¶ã€‚**å…¨æ–‡ 7000+ å­—ï¼Œå»ºè®®å…ˆæ”¶è—å†çœ‹ï¼**\n\n<!-- more -->\n\n## ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªæ¸…å•ï¼Ÿ\n\nè¯´å®è¯ï¼Œç”Ÿç‰©ä¿¡æ¯å­¦çš„å­¦ä¹ æ›²çº¿çœŸçš„å¾ˆé™¡å³­ï¼š\n\n- ç”Ÿç‰©å­¦èƒŒæ™¯çš„åŒå­¦ï¼Œ**ç¼–ç¨‹æ˜¯æ‹¦è·¯è™**\n- è®¡ç®—æœºèƒŒæ™¯çš„åŒå­¦ï¼Œ**ç”Ÿç‰©çŸ¥è¯†æ˜¯å¤©ä¹¦**\n- ä¸¤è¾¹éƒ½æ‡‚ä¸€ç‚¹çš„ï¼Œ**ä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹ç³»ç»Ÿå­¦ä¹ **\n\nå¸‚é¢ä¸Šçš„èµ„æºè™½ç„¶å¾ˆå¤šï¼Œä½†**è‰¯è ä¸é½**ã€‚æˆ‘è§è¿‡å¤ªå¤šäººå› ä¸ºæ‰¾ä¸åˆ°åˆé€‚çš„èµ„æºï¼Œåœ¨å…¥é—¨é˜¶æ®µå°±æ”¾å¼ƒäº†ã€‚\n\næ‰€ä»¥è¿™ä¸ªæ¸…å•çš„ç›®æ ‡å¾ˆæ˜ç¡®ï¼š\n\nâœ… **åªæ”¶å½•çœŸæ­£æœ‰ä»·å€¼çš„èµ„æº**\nâœ… **è¦†ç›–ä»å…¥é—¨åˆ°è¿›é˜¶çš„å®Œæ•´è·¯å¾„**\nâœ… **ç´§è·Ÿæœ€æ–°æŠ€æœ¯å‘å±•**ï¼ˆå°¤å…¶æ˜¯ AI å·¥å…·ï¼‰\n\n---\n\n## ğŸ“‹ æ¸…å•æ¦‚è§ˆ\n\nè¿™ä»½æ¸…å•åŒ…å« **13 ä¸ªä¸»é¢˜æ¿å—**ï¼Œ**190+ ä¸ªç²¾é€‰èµ„æº**ï¼Œæ¶µç›–ï¼š\n\n| æ¿å— | èµ„æºæ•° | é€‚åˆäººç¾¤ |\n|------|--------|----------|\n| ğŸ”¬ åŸºæœ¬èµ„æº | 15+ | æ‰€æœ‰äºº |\n| ğŸ“š ç”Ÿç‰©ä¿¡æ¯å­¦èµ„æº | 20+ | å…¥é—¨&è¿›é˜¶ |\n| ğŸ›ï¸ ç ”ç©¶æœºæ„ä¸å¤§å‹é¡¹ç›® | 18+ | ç§‘ç ”å·¥ä½œè€… |\n| ğŸ› ï¸ å·¥å…·ä¸æ•™ç¨‹ | 12+ | å®è·µè€… |\n| ğŸ§¬ AI ç”Ÿç‰©å­¦å·¥å…· | 25+ | å‰æ²¿ç ”ç©¶è€… |\n| ğŸ¤– AI å¤§è¯­è¨€æ¨¡å‹ | 40+ | æ•ˆç‡æå‡ |\n| ğŸ“Š å¯è§†åŒ–å·¥å…· | 5+ | æ•°æ®åˆ†æ |\n| ğŸ’» æ•°æ®åˆ†æå·¥å…· | 25+ | æ—¥å¸¸å¼€å‘ |\n| ğŸ“ è¯¾ç¨‹ä¸è§†é¢‘ | 5+ | ç³»ç»Ÿå­¦ä¹  |\n\nå®Œæ•´æ¸…å•åœ¨è¿™é‡Œ ğŸ‘‰ [**èµ„æºå¯¼èˆªé¡µé¢**](/links/)\n\nä¸‹é¢æˆ‘æŒ‘å‡ ä¸ª**æœ€å€¼å¾—å…³æ³¨çš„æ¿å—**è¯¦ç»†è¯´è¯´ã€‚\n\n---\n\n## ğŸ§¬ é‡ç‚¹æ¿å—ä¸€ï¼šAI ç”Ÿç‰©å­¦å·¥å…·\n\nè¿™æ˜¯ 2024-2026 å¹´å˜åŒ–æœ€å¤§çš„é¢†åŸŸï¼**ä¸å¤¸å¼ åœ°è¯´ï¼ŒAI æ­£åœ¨é‡æ–°å®šä¹‰ç”Ÿç‰©å­¦ç ”ç©¶ã€‚**\n\n### 1. è›‹ç™½è´¨ç»“æ„é¢„æµ‹ - å·²ç»æ˜¯åŸºæ“äº†\n\nè¿˜è®°å¾— 2020 å¹´ AlphaFold 2 æ¨ªç©ºå‡ºä¸–çš„éœ‡æ’¼å—ï¼Ÿç°åœ¨ï¼š\n\n- **[AlphaFold 3](https://alphafoldserver.com/)** - æœ€æ–°ç‰ˆæœ¬ï¼Œç²¾åº¦æ›´é«˜ï¼Œé€Ÿåº¦æ›´å¿«\n  - æ•°æ®åº“å·²ç»æœ‰ **2 äº¿+** è›‹ç™½è´¨ç»“æ„\n  - åŸºæœ¬ä¸Šä½ æƒ³è¦çš„è›‹ç™½ï¼Œéƒ½èƒ½æ‰¾åˆ°é¢„æµ‹ç»“æ„\n\n- **[RoseTTAFold](https://robetta.bakerlab.org/)** - Baker Lab å‡ºå“ï¼Œå¼€æºå®ç°\n  - åœ¨æŸäº›è›‹ç™½è´¨å®¶æ—ä¸Šæ¯” AlphaFold è¿˜å‡†\n\n- **[ESMFold](https://esmatlas.com/)** - Meta å‡ºå“ï¼Œ**æœ€å¿«**\n  - å®åŸºå› ç»„è›‹ç™½ç»“æ„å›¾è°±è¾¾åˆ° **6 äº¿+**\n  - é€‚åˆå¤§è§„æ¨¡ç­›é€‰\n\n**å®ç”¨å»ºè®®**ï¼šç°åœ¨åšè›‹ç™½ç›¸å…³ç ”ç©¶ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯å» AlphaFold Database æŸ¥ç»“æ„ã€‚å®éªŒéªŒè¯ä¹‹å‰å…ˆé¢„æµ‹ä¸€ä¸‹ï¼Œèƒ½çœå¥½å¤šæ—¶é—´å’Œç»è´¹ï¼\n\n### 2. è›‹ç™½è´¨è®¾è®¡ - ä»é¢„æµ‹åˆ°åˆ›é€ \n\næ›´æ¿€è¿›çš„æ˜¯ï¼ŒAI ç°åœ¨ä¸åªèƒ½é¢„æµ‹ç»“æ„ï¼Œè¿˜èƒ½**ä»å¤´è®¾è®¡è›‹ç™½è´¨**ï¼š\n\n- **[ProteinMPNN](https://github.com/dauparas/ProteinMPNN)** - ç»™å®šç»“æ„ï¼Œç”Ÿæˆåºåˆ—\n- **[RFdiffusion](https://github.com/RosettaCommons/RFdiffusion)** - æ‰©æ•£æ¨¡å‹è®¾è®¡è›‹ç™½\n- **[Chroma](https://generatebiomedicines.com/chroma)** - Generate Biomedicines çš„å•†ä¸šåŒ–äº§å“\n\nè¿™ä¸ªæ–¹å‘å¤ªç«äº†ï¼Œå·²ç»æœ‰å¥½å‡ ä¸ª Biotech å…¬å¸æ‹¿åˆ°å·¨é¢èèµ„ã€‚**æœªæ¥çš„è¯ç‰©è®¾è®¡ï¼Œå¯èƒ½ä¸éœ€è¦ä»è‡ªç„¶ç•Œç­›é€‰ï¼Œè€Œæ˜¯ç›´æ¥ AI ç”Ÿæˆã€‚**\n\n### 3. åˆ†å­å¯¹æ¥ - è¯ç‰©å‘ç°çš„åŠ é€Ÿå™¨\n\n- **[DiffDock](https://github.com/gcorso/DiffDock)** - æ‰©æ•£æ¨¡å‹åšåˆ†å­å¯¹æ¥\n  - æ¯”ä¼ ç»Ÿæ–¹æ³•å¿« 100 å€\n  - ç²¾åº¦è¿˜æ›´é«˜\n\n**æˆ‘çš„è§‚å¯Ÿ**ï¼šä¼ ç»Ÿçš„è™šæ‹Ÿç­›é€‰ç®¡çº¿æ­£åœ¨è¢« AI å¿«é€Ÿæ›¿ä»£ã€‚å¦‚æœä½ åšè¯ç‰©å‘ç°ï¼Œä¸å­¦è¿™äº›å·¥å…·å°±çœŸçš„è½ä¼äº†ã€‚\n\n---\n\n## ğŸ¤– é‡ç‚¹æ¿å—äºŒï¼šAI å¤§è¯­è¨€æ¨¡å‹\n\nå¤§æ¨¡å‹ä¸åªæ˜¯èŠå¤©å·¥å…·ï¼Œ**ç”¨å¯¹äº†èƒ½è®©ç§‘ç ”æ•ˆç‡ç¿»å€ï¼**\n\n### 1. é€šç”¨å¤§æ¨¡å‹ - æ—¥å¸¸å¿…å¤‡\n\n**å›½é™…ç‰ˆï¼š**\n- **ChatGPT (GPT-5.3)** - æœ€å¼ºç»¼åˆèƒ½åŠ›ï¼Œä½†éœ€è¦é­”æ³•ä¸Šç½‘\n- **Claude 4** - **é•¿æ–‡æœ¬ä¹‹ç‹**ï¼ˆå¯ä»¥å¤„ç†æ•´æœ¬ä¹¦ï¼‰\n  - æˆ‘ç°åœ¨å†™è®ºæ–‡éƒ½å…ˆè®© Claude å¸®å¿™æ¶¦è‰²\n- **Gemini** - Google å‡ºå“ï¼Œå¤šæ¨¡æ€èƒ½åŠ›å¼º\n\n**å›½å†…ç‰ˆï¼š**\n- **Kimi** - é•¿æ–‡æœ¬å¤„ç†å¾ˆä¸é”™ï¼Œå…è´¹ï¼\n- **DeepSeek** - æ¨ç†èƒ½åŠ›å¼ºï¼Œé€‚åˆåšæ•°å­¦é¢˜å’Œä»£ç \n- **è±†åŒ…** - å­—èŠ‚å‡ºå“ï¼Œé€Ÿåº¦å¿«\n\n**å®ç”¨æŠ€å·§**ï¼š\n- å†™ä»£ç ç”¨ **Claude** æˆ– **DeepSeek**\n- è¯»æ–‡çŒ®ç”¨ **Kimi**ï¼ˆä¸€æ¬¡èƒ½å¡å¥½å‡ ç¯‡è®ºæ–‡ï¼‰\n- ç”»å›¾è§£ç”¨ **GPT-5.3** æˆ– **Gemini**\n\n### 2. ç”Ÿç‰©åŒ»å­¦ä¸“ç”¨æ¨¡å‹ - ä¸“ä¸šé—®é¢˜æ‰¾ä¸“å®¶\n\n- **[BioGPT](https://github.com/microsoft/BioGPT)** - å¾®è½¯è®­ç»ƒçš„ç”Ÿç‰©åŒ»å­¦æ–‡æœ¬ç”Ÿæˆæ¨¡å‹\n- **[Med-PaLM](https://sites.research.google/med-palm/)** - Google çš„åŒ»ç–—ä¸“ç”¨æ¨¡å‹\n- **[GeneGPT](https://github.com/ncbi/GeneGPT)** - NCBI å‡ºå“ï¼Œä¸“é—¨å›ç­”åŸºå› é—®é¢˜\n\n**ä¸¾ä¸ªä¾‹å­**ï¼šæˆ‘æœ€è¿‘åœ¨ç ”ç©¶ä¸€ä¸ªä¸ç†Ÿæ‚‰çš„åŸºå› ï¼Œç›´æ¥é—® GeneGPTï¼Œå®ƒç»™å‡ºçš„è§£é‡Šæ¯”æˆ‘è‡ªå·±æŸ¥æ–‡çŒ®å¿«å¤šäº†ã€‚\n\n### 3. AI è¾…åŠ©å·¥å…· - æ•ˆç‡åŠ å€å™¨\n\n- **[Cursor](https://cursor.sh/)** - AI ä»£ç ç¼–è¾‘å™¨\n  - **å¼ºçƒˆæ¨èï¼** å†™ä»£ç æ•ˆç‡è‡³å°‘æå‡ 50%\n  - ç›´æ¥åœ¨ç¼–è¾‘å™¨é‡Œé—® AIï¼Œä¸ç”¨æ¥å›åˆ‡æ¢\n\n- **[GitHub Copilot](https://github.com/features/copilot)** - AI ç¼–ç¨‹åŠ©æ‰‹\n  - ä»£ç è¡¥å…¨éå¸¸æ™ºèƒ½\n  - å­¦ç”Ÿå¯ä»¥å…è´¹ç”¨\n\n- **[Consensus](https://consensus.app/)** - AI æ–‡çŒ®æœç´¢\n  - è¾“å…¥é—®é¢˜ï¼Œç›´æ¥ç»™ä½ æ–‡çŒ®æ€»ç»“\n  - æ¯”è‡ªå·±ç¿» PubMed å¿«å¤ªå¤š\n\n- **[Elicit](https://elicit.org/)** - AI ç ”ç©¶åŠ©æ‰‹\n  - å¸®ä½ åšç³»ç»Ÿæ€§æ–‡çŒ®ç»¼è¿°\n  - è‡ªåŠ¨æå–è®ºæ–‡å…³é”®ä¿¡æ¯\n\n**çœŸå¿ƒè¯**ï¼šå¦‚æœä½ è¿˜åœ¨çº¯æ‰‹å·¥å†™ä»£ç ã€è¯»æ–‡çŒ®ï¼ŒçœŸçš„è¯¥è¯•è¯•è¿™äº›å·¥å…·äº†ã€‚**å·¥å…·ç”¨å¾—å¥½ï¼Œä¸‹ç­ä¸‹å¾—æ—©ï¼**\n\n---\n\n## ğŸ’» é‡ç‚¹æ¿å—ä¸‰ï¼šæ•°æ®åˆ†æå·¥å…·é“¾\n\nå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚è¿™ä¸ªæ¿å—æˆ‘èŠ±äº†å¾ˆå¤šå¿ƒæ€æ•´ç†ã€‚\n\n### 1. IDE é€‰æ‹© - æ‰¾åˆ°æœ€é€‚åˆä½ çš„\n\n**R ç”¨æˆ·ï¼š**\n- **[RStudio](https://posit.co/)** - è€ç‰ŒIDEï¼ŒåŠŸèƒ½å®Œå–„\n- **[Positron](https://github.com/posit-dev/positron)** - Posit æ–°äº§å“\n  - **åŒæ—¶æ”¯æŒ Python å’Œ R**\n  - ç•Œé¢ç°ä»£åŒ–ï¼Œæ¨èå°é²œ\n\n**Python ç”¨æˆ·ï¼š**\n- **[VS Code](https://code.visualstudio.com/)** - ä¸‡èƒ½ç¼–è¾‘å™¨\n  - è½»é‡ã€æ’ä»¶ä¸°å¯Œ\n  - æˆ‘ç°åœ¨ 80% çš„ä»£ç éƒ½åœ¨ VS Code å†™\n\n- **[PyCharm](https://www.jetbrains.com/pycharm/)** - ä¸“ä¸š Python IDE\n  - åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ¯”è¾ƒé‡\n\n- **[Jupyter Lab](https://jupyter.org/)** - äº¤äº’å¼åˆ†æ\n  - æ•°æ®æ¢ç´¢å¿…å¤‡\n  - å‡ºå›¾ç‰¹åˆ«æ–¹ä¾¿\n\n### 2. åŒ…ç®¡ç†å·¥å…· - ä¾èµ–ç®¡ç†ä¸å†å¤´ç–¼\n\n**Python ç¯å¢ƒï¼š**\n- **[uv](https://github.com/astral-sh/uv)** - **æ–°æ˜Ÿå·¥å…·ï¼**\n  - ç”¨ Rust å†™çš„ï¼Œæ¯” pip å¿« **10-100 å€**\n  - å¼ºçƒˆæ¨èï¼ŒçœŸçš„å¿«åˆ°é£èµ·\n\n- **[Poetry](https://python-poetry.org/)** - ç°ä»£åŒ–ä¾èµ–ç®¡ç†\n  - æ¯” pip + requirements.txt å¥½ç”¨å¤ªå¤š\n\n- **[Conda](https://docs.conda.io/)** - è·¨è¯­è¨€åŒ…ç®¡ç†\n  - ç”Ÿä¿¡é¢†åŸŸçš„æ ‡é…\n\n**R ç¯å¢ƒï¼š**\n- **[rig](https://github.com/r-lib/rig)** - R ç‰ˆæœ¬ç®¡ç†\n  - å¤šç‰ˆæœ¬ R åˆ‡æ¢å¾ˆæ–¹ä¾¿\n\n- **[renv](https://rstudio.github.io/renv/)** - é¡¹ç›®ç¯å¢ƒç®¡ç†\n  - ä¿è¯é¡¹ç›®çš„å¯å¤ç°æ€§\n\n**é¿å‘ç»éªŒ**ï¼šå¾ˆå¤šäººé‡åˆ°çš„ \"æˆ‘ç”µè„‘ä¸Šèƒ½è·‘ï¼Œä½ ç”µè„‘ä¸Šä¸èƒ½è·‘\" é—®é¢˜ï¼Œ90% æ˜¯å› ä¸ºç¯å¢ƒç®¡ç†ä¸å½“ã€‚**å­¦ä¼šç”¨è¿™äº›å·¥å…·ï¼Œèƒ½çœæ— æ•°æ—¶é—´ï¼**\n\n---\n\n## ğŸ“š é‡ç‚¹æ¿å—å››ï¼šå­¦ä¹ è·¯å¾„æ¨è\n\nèµ„æºè™½å¥½ï¼Œä½†**å¦‚ä½•ç³»ç»Ÿå­¦ä¹ **æ‰æ˜¯å…³é”®ã€‚æ ¹æ®æˆ‘çš„ç»éªŒï¼š\n\n### æ–°æ‰‹è·¯å¾„ï¼ˆ0-6 ä¸ªæœˆï¼‰\n\n1. **ç¼–ç¨‹åŸºç¡€**\n   - Pythonï¼š[Rosalind](http://rosalind.info/) - ç”Ÿä¿¡ç¼–ç¨‹ç»ƒä¹ ï¼Œè¾¹ç©è¾¹å­¦\n   - Rï¼šç›´æ¥ä¸Šæ‰‹ Bioconductorï¼Œè¾¹ç”¨è¾¹å­¦\n\n2. **ç”Ÿä¿¡åŸºç¡€**\n   - [ç”Ÿä¿¡æŠ€èƒ½æ ‘](http://www.biotrainee.com/) - ä¸­æ–‡æ•™ç¨‹ä¸°å¯Œ\n   - [The Carpentries](https://carpentries.org/) - ç³»ç»ŸåŒ–åŸ¹è®­\n\n3. **å®æˆ˜é¡¹ç›®**\n   - è·Ÿç€ [NGS Analysis Tutorial](https://github.com/griffithlab/rnaseq_tutorial) åšä¸€é\n   - å» [Kaggle](https://www.kaggle.com/) æ‰¾ç”Ÿä¿¡ç«èµ›ç»ƒæ‰‹\n\n### è¿›é˜¶è·¯å¾„ï¼ˆ6-18 ä¸ªæœˆï¼‰\n\n1. **æ·±å…¥ç‰¹å®šæ–¹å‘**\n   - å•ç»†èƒï¼šä» [Seurat](https://satijalab.org/seurat/) å…¥æ‰‹\n   - è›‹ç™½è´¨ï¼šå­¦ AlphaFold å’Œåˆ†å­å¯¹æ¥\n\n2. **å…³æ³¨å‰æ²¿åŠ¨æ€**\n   - å®šæœŸçœ‹ [bioRxiv](https://www.biorxiv.org/) é¢„å°æœ¬\n   - å…³æ³¨å‡ ä¸ªå¤§ç‰›çš„ Twitter/X\n\n3. **å‚ä¸å¼€æºé¡¹ç›®**\n   - å» GitHub æ‰¾æ„Ÿå…´è¶£çš„é¡¹ç›®è´¡çŒ®ä»£ç \n   - å»ºç«‹è‡ªå·±çš„ä½œå“é›†\n\n### é«˜çº§è·¯å¾„ï¼ˆ18 ä¸ªæœˆ+ï¼‰\n\n1. **å‘è¡¨ç ”ç©¶**\n   - æ‰¾åˆ°ç»†åˆ†é¢†åŸŸçš„ gap\n   - å¼€å‘è‡ªå·±çš„å·¥å…·/ç®—æ³•\n\n2. **å»ºç«‹å½±å“åŠ›**\n   - å†™æŠ€æœ¯åšå®¢åˆ†äº«ç»éªŒ\n   - åœ¨ç¤¾åŒºé‡Œæ´»è·ƒ\n\n**æ ¸å¿ƒå»ºè®®**ï¼š**ä¸è¦å›¤ç§¯èµ„æºï¼** é€‰ 2-3 ä¸ªæœ€é€‚åˆä½ çš„ï¼Œæ·±å…¥å­¦ä¹ ï¼Œæ¯”æ”¶è— 100 ä¸ªèµ„æºæ›´æœ‰ç”¨ã€‚\n\n---\n\n## ğŸ›ï¸ å€¼å¾—å…³æ³¨çš„ç ”ç©¶æœºæ„\n\nå¦‚æœä½ æƒ³äº†è§£æœ€å‰æ²¿çš„ç ”ç©¶ï¼Œå…³æ³¨è¿™äº›æœºæ„å‡†æ²¡é”™ï¼š\n\n### å›½é™…é¡¶å°–æœºæ„\n\n- **[Wellcome Sanger Institute](https://www.sanger.ac.uk/)** - åŸºå› ç»„å­¦ç ”ç©¶å…ˆé©±\n  - äººç±»åŸºå› ç»„è®¡åˆ’çš„ä¸»åŠ›å†›\n\n- **[Broad Institute](https://www.broadinstitute.org/)** - å“ˆä½›-MIT è”åˆç ”ç©¶æ‰€\n  - å•ç»†èƒæµ‹åºæŠ€æœ¯çš„å¼•é¢†è€…\n\n- **[Arc Institute](https://arcinstitute.org/)** - æ–°å…´ç ”ç©¶æœºæ„\n  - Patrick Hsu åˆ›ç«‹ï¼Œä¸“æ³¨å‰æ²¿ç”Ÿç‰©æŠ€æœ¯\n\n### å¤§å‹ç§‘ç ”è®¡åˆ’\n\n- **[Human Cell Atlas](https://www.humancellatlas.org/)** - äººç±»ç»†èƒå›¾è°±è®¡åˆ’\n  - æƒ³äº†è§£å•ç»†èƒé¢†åŸŸï¼Œè¿™æ˜¯å¿…çœ‹çš„\n\n- **[Chan Zuckerberg Initiative](https://chanzuckerberg.com/)** - CZI\n  - [CELLxGENE](https://cellxgene.cziscience.com/) å•ç»†èƒæ•°æ®é—¨æˆ·è¶…å¥½ç”¨\n\n**å®ç”¨å»ºè®®**ï¼šè¿™äº›æœºæ„ç»å¸¸æœ‰å…¬å¼€çš„è®²åº§å’ŒåŸ¹è®­ï¼Œå¯ä»¥å…³æ³¨ä»–ä»¬çš„ YouTube é¢‘é“ã€‚\n\n---\n\n## ğŸ’¡ æˆ‘çš„ä½¿ç”¨å¿ƒå¾—\n\n### 1. å»ºç«‹è‡ªå·±çš„å·¥å…·ç®±\n\nä¸è¦ä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œæ ¹æ®ä½ çš„ç ”ç©¶æ–¹å‘ï¼Œ**ç²¾é€‰ 10-15 ä¸ªå¸¸ç”¨å·¥å…·æ·±åº¦æŒæ¡**ã€‚\n\næˆ‘è‡ªå·±çš„å¸¸ç”¨å·¥å…·ç®±ï¼š\n- IDE: VS Code + Jupyter Lab\n- åŒ…ç®¡ç†: uv + Conda\n- ä»£ç åŠ©æ‰‹: Cursor + GitHub Copilot\n- æ–‡çŒ®ç®¡ç†: Zotero\n- å¤§æ¨¡å‹: Claude + Kimi\n- ç»˜å›¾: ggplot2 + BioRender\n\n### 2. å–„ç”¨ AI ææ•ˆ\n\n**èƒ½è®© AI åšçš„ï¼Œå°±ä¸è¦æ‰‹å·¥åšï¼š**\n- è¯»æ–‡çŒ® â†’ ç”¨ Consensus æˆ– Elicit\n- å†™ä»£ç  â†’ ç”¨ Cursor æˆ– Copilot\n- ç”»å›¾ â†’ ç”¨ BioRender æˆ– GPT-4\n- æ¶¦è‰²æ–‡ç«  â†’ ç”¨ Claude\n\nä½†è®°ä½ï¼š**AI æ˜¯åŠ©æ‰‹ï¼Œä¸æ˜¯æ›¿ä»£å“ã€‚** æ‰¹åˆ¤æ€§æ€ç»´æ°¸è¿œä¸èƒ½ä¸¢ã€‚\n\n### 3. æŒç»­å­¦ä¹ çš„èŠ‚å¥\n\n**ä¸è¦è¯•å›¾ä¸€æ¬¡æ€§å­¦å®Œæ‰€æœ‰ä¸œè¥¿ï¼** å»ºè®®ï¼š\n\n- æ¯å‘¨å›ºå®š 1-2 ä¸ªå°æ—¶å­¦æ–°å·¥å…·\n- æ¯æœˆè¯» 2-3 ç¯‡å‰æ²¿è®ºæ–‡\n- æ¯å­£åº¦å­¦ä¸€ä¸ªæ–°æŠ€èƒ½\n\n**å…³é”®æ˜¯æŒç»­ï¼Œè€Œä¸æ˜¯çˆ†å‘ã€‚**\n\n---\n\n## ğŸ“ å¸¸è§é—®é¢˜\n\n### Q1: è¿™ä¹ˆå¤šèµ„æºï¼Œä»å“ªé‡Œå¼€å§‹ï¼Ÿ\n\n**A**: æ ¹æ®ä½ çš„ç›®æ ‡é€‰æ‹©ï¼š\n- æƒ³å¿«é€Ÿä¸Šæ‰‹ â†’ å…ˆçœ‹ **å·¥å…·ä¸æ•™ç¨‹** æ¿å—\n- æƒ³ç³»ç»Ÿå­¦ä¹  â†’ å…ˆçœ‹ **è¯¾ç¨‹ä¸è§†é¢‘** æ¿å—\n- æƒ³äº†è§£å‰æ²¿ â†’ å…ˆçœ‹ **AI ç”Ÿç‰©å­¦å·¥å…·** æ¿å—\n\n### Q2: å…è´¹èµ„æºå¤Ÿç”¨å—ï¼Ÿè¦ä¸è¦ä»˜è´¹ï¼Ÿ\n\n**A**: **90% çš„æƒ…å†µä¸‹å…è´¹èµ„æºå°±å¤Ÿäº†ã€‚** ä»˜è´¹å·¥å…·æˆ‘åªæ¨èï¼š\n- GitHub Copilotï¼ˆå­¦ç”Ÿå…è´¹ï¼‰\n- ChatGPT Plusï¼ˆå¦‚æœä½ é«˜é¢‘ä½¿ç”¨ï¼‰\n\nå…¶ä»–çš„ç­‰ä½ çœŸæ­£æœ‰éœ€æ±‚äº†å†è€ƒè™‘ã€‚\n\n### Q3: è‹±æ–‡ä¸å¥½æ€ä¹ˆåŠï¼Ÿ\n\n**A**:\n1. **ä¼˜å…ˆç”¨å›½å†…èµ„æº**ï¼šç”Ÿä¿¡æŠ€èƒ½æ ‘ã€ç”Ÿä¿¡èœé¸Ÿå›¢çš„ä¸­æ–‡æ•™ç¨‹å¾ˆå…¨é¢\n2. **å€ŸåŠ©ç¿»è¯‘å·¥å…·**ï¼šDeepL çš„ç¿»è¯‘è´¨é‡å¾ˆé«˜\n3. **è¾¹ç”¨è¾¹å­¦**ï¼šå®è·µä¸­ç§¯ç´¯ä¸“ä¸šè¯æ±‡ï¼Œæ¯”æ­»è®°ç¡¬èƒŒå¿«\n\n### Q4: èµ„æºä¼šæŒç»­æ›´æ–°å—ï¼Ÿ\n\n**A**: ä¼šçš„ï¼æˆ‘ä¼šä¿æŒæ¯æœˆæ›´æ–°ï¼Œæ·»åŠ æ–°çš„ä¼˜è´¨èµ„æºã€‚\n\nå®Œæ•´æ¸…å•åœ¨è¿™é‡Œ ğŸ‘‰ [**èµ„æºå¯¼èˆªé¡µé¢**](/links/)\n\n---\n\n## å†™åœ¨æœ€å\n\nè¿™ä»½æ¸…å•è€—è´¹äº†æˆ‘å¤§é‡å¿ƒè¡€ï¼Œä½†å¦‚æœèƒ½å¸®åˆ°ä¸€ä¸ªäººå°‘èµ°å¼¯è·¯ï¼Œå°±å€¼äº†ã€‚\n\n**ç”Ÿç‰©ä¿¡æ¯å­¦çš„å­¦ä¹ ä¹‹è·¯å¾ˆé•¿ï¼Œä½†ä¸å­¤å•ã€‚** æˆ‘ä»¬éƒ½æ˜¯åœ¨è¿™æ¡è·¯ä¸Šæ‘¸ç´¢å‰è¿›çš„ã€‚\n\nå‡ å¥è‚ºè…‘ä¹‹è¨€ï¼š\n\n1. **ä¸è¦è¢«èµ„æºçš„æ•°é‡å“åˆ°** - é€‰æ‹©é€‚åˆä½ çš„ï¼Œæ·±å…¥å­¦ä¹ \n2. **ä¸è¦é—­é—¨é€ è½¦** - å¤šå‚ä¸ç¤¾åŒºè®¨è®ºï¼Œåˆ†äº«ä½ çš„ç»éªŒ\n3. **ä¸è¦åœæ­¢å­¦ä¹ ** - è¿™ä¸ªé¢†åŸŸå˜åŒ–å¤ªå¿«ï¼Œä¿æŒå¥½å¥‡å¿ƒ\n4. **ä¸è¦å¿˜è®°åˆå¿ƒ** - æˆ‘ä»¬åšè¿™äº›ï¼Œæ˜¯ä¸ºäº†æ¨åŠ¨ç§‘å­¦è¿›æ­¥\n\n---\n\n## ğŸ™ è‡´è°¢\n\nè¿™ä»½æ¸…å•çš„è¯ç”Ÿç¦»ä¸å¼€ï¼š\n- ç”Ÿä¿¡ç¤¾åŒºçš„å‰è¾ˆä»¬æ— ç§åˆ†äº«\n- å¸ˆå…„å¸ˆå§ä»¬çš„ç»éªŒä¼ æˆ\n- å¼€æºç¤¾åŒºçš„è´¡çŒ®è€…ä»¬\n\n**å¦‚æœä½ è§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿åˆ†äº«ç»™æ›´å¤šäººï¼**\n\næœ‰ä»»ä½•å»ºè®®æˆ–è¡¥å……ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ–è€…ç›´æ¥è®¿é—® [èµ„æºå¯¼èˆªé¡µé¢](/links/) æŸ¥çœ‹å®Œæ•´å†…å®¹ã€‚\n\n---\n\n**ç›¸å…³é˜…è¯»ï¼š**\n- [è®¡ç®—ç”Ÿç‰©å­¦æˆé•¿è·¯çº¿å›¾](/links/) ï¼ˆé™„è·¯çº¿å›¾ï¼‰\n\n---\n\n*æœ¬æ–‡çº¦ 7000 å­—ï¼Œé˜…è¯»æ—¶é—´çº¦ 15 åˆ†é’Ÿ*\n*æœ€åæ›´æ–°ï¼š2026-02-25*\n*è½¬è½½è¯·æ³¨æ˜å‡ºå¤„*\n","tags":["ç”Ÿç‰©ä¿¡æ¯å­¦","èµ„æºå¯¼èˆª","AIå·¥å…·","å­¦ä¹ è·¯å¾„"],"categories":["note"]},{"title":"test mermaid","url":"/2025/01/15/mermaid_example/","content":"\n<!-- htmlmin:ignore -->\n<pre class=\"mermaid\">\nsequenceDiagram\nAlice-&gt;&gt;John: Hello John, how are you?\nloop Healthcheck\n    John-&gt;&gt;John: Fight against hypochondria\nend\nNote right of John: Rational thoughts!\nJohn--&gt;&gt;Alice: Great!\nJohn-&gt;&gt;Bob: How about you?\nBob--&gt;&gt;John: Jolly good!\n</pre>\n<!-- htmlmin:ignore -->\n\n\n<!-- htmlmin:ignore -->\n<pre class=\"mermaid\">\ngraph TD\n    A[å¼€å§‹] --> B{åˆ¤æ–­}\n    B -- Yes --> C[æ‰§è¡Œ]\n    B -- No --> D[è·³è¿‡]\n    C --> E[ç»“æŸ]\n    D --> E\n</pre>\n<!-- htmlmin:ignore -->\n\n","tags":["AI"],"categories":["implementation"]},{"title":"udl-chap3-4","url":"/2025/01/15/udl-chap3-4/","content":"\n# chapter 3: Shallow neural networks\n\nå¦‚ä¸Šä¸€ç« æœ«å°¾æ‰€è¨€ï¼Œç¬¬3ç« è®¨è®ºäº†æµ…å±‚ç¥ç»ç½‘ç»œï¼Œå®ƒæ¯”çº¿æ€§å›å½’ç¨å¤æ‚ï¼Œä½†èƒ½æè¿°æ›´å¹¿æ³›çš„è¾“å…¥/è¾“å‡ºå…³ç³»ã€‚è¿™ç« ä¸»è¦ä»¥æµ…å±‚ç¥ç»ç½‘ç»œä¸ºä¾‹ï¼Œåˆæ­¥ä»‹ç»ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µã€‚æµ…å±‚ç¥ç»ç½‘ç»œçš„æ¶æ„ï¼Œæ¿€æ´»å‡½æ•°ï¼ˆä¸»è¦ä»‹ç»ReLUï¼‰ï¼Œä»¥åŠuniversal approximation theorem\n\n> æµ…å±‚ç¥ç»ç½‘ç»œæœ‰ä¸€ä¸ªéšè—å±‚ã€‚å®ƒä»¬ï¼ˆiï¼‰è®¡ç®—è¾“å…¥çš„å¤šä¸ªçº¿æ€§å‡½æ•°ï¼Œï¼ˆiiï¼‰å°†æ¯ä¸ªç»“æœé€šè¿‡ä¸€ä¸ªæ¿€æ´»å‡½æ•°ï¼Œç„¶åï¼ˆiiiï¼‰å–è¿™äº›æ¿€æ´»çš„çº¿æ€§ç»„åˆä»¥å½¢æˆè¾“å‡ºã€‚æµ…å±‚ç¥ç»ç½‘ç»œé€šè¿‡å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸ºè¿ç»­çš„åˆ†æ®µçº¿æ€§åŒºåŸŸæ¥åŸºäºè¾“å…¥ \\( x \\) è¿›è¡Œé¢„æµ‹ \\( y \\)ã€‚åªè¦æœ‰è¶³å¤Ÿçš„éšè—å•å…ƒï¼ˆç¥ç»å…ƒï¼‰ï¼Œæµ…å±‚ç¥ç»ç½‘ç»œå¯ä»¥ä»»æ„ç²¾ç¡®åœ°è¿‘ä¼¼ä»»ä½•è¿ç»­å‡½æ•°ã€‚\n\n> ç¬¬4ç« è®¨è®ºäº†æ·±åº¦ç¥ç»ç½‘ç»œï¼Œå®ƒé€šè¿‡å¢åŠ æ›´å¤šçš„éšè—å±‚æ¥æ‰©å±•æœ¬ç« ä¸­çš„æ¨¡å‹ã€‚ç¬¬5-7ç« æè¿°äº†å¦‚ä½•è®­ç»ƒè¿™äº›æ¨¡å‹ã€‚\n\n\n# chapter 4: deep neural networks\n\nè¿™æ›´è¿›ä¸€æ­¥ï¼Œåˆæ­¥ä»‹ç»äº†æ·±å±‚ç¥ç»ç½‘ç»œã€‚\n\n\n$h_1 = a[\\beta_0 + \\Omega_1x]$\n\n$h_2 = a[\\beta_1 + \\Omega_2h_1]$\n\n$h_3 = a[\\beta_2 + \\Omega_2h_2]$\n\n$\\vdots$\n\n$h_K = a[\\beta_{K-1} + \\Omega_{K}h_{K-1}]$\n\n$y = \\beta_K + \\Omega_Kh_K$\n\n<!-- htmlmin:ignore -->\n<pre class=\"mermaid\">\ngraph LR\n    x1((xâ‚)) --> h11((hâ‚â‚))\n    x1 --> h12((hâ‚â‚‚))\n    x1 --> h13((hâ‚â‚ƒ))\n    x2((xâ‚‚)) --> h11\n    x2 --> h12\n    x2 --> h13\n    h11 --> h21((hâ‚‚â‚))\n    h12 --> h21\n    h13 --> h21\n    h11 --> h22((hâ‚‚â‚‚))\n    h12 --> h22\n    h13 --> h22\n    h21 --> y((y))\n    h22 --> y\n    \n    style x1 fill:#f9f,stroke:#333,stroke-width:2px\n    style x2 fill:#f9f,stroke:#333,stroke-width:2px\n    style h11 fill:#bbf,stroke:#333,stroke-width:2px\n    style h12 fill:#bbf,stroke:#333,stroke-width:2px\n    style h13 fill:#bbf,stroke:#333,stroke-width:2px\n    style h21 fill:#fbb,stroke:#333,stroke-width:2px\n    style h22 fill:#fbb,stroke:#333,stroke-width:2px\n    style y fill:#bfb,stroke:#333,stroke-width:2px\n</pre>\n<!-- htmlmin:ignore -->\n\næœ€é‡è¦çš„æ˜¯æœ«å°¾çš„ï¼š\n\næ·±å±‚ç¥ç»ç½‘ç»œä¸æµ…å±‚ç¥ç»ç½‘ç»œçš„æ¯”è¾ƒï¼š\n\n+ Ability to approximate different functions \n+ Number of linear regions per parameter \n+ Depth efficiencyï¼ˆæ·±å±‚ä¼˜åŠ¿ï¼Œä½œè€…åœ¨æœ«å°¾çš„noteéƒ¨åˆ†ä¸¾äº†ä¸€äº›ç†è®ºçš„ä¾‹å­ï¼‰\n+ Large, structured inputs (å¦‚å›¾åƒï¼Œå®é™…ä¸Šåªèƒ½æ·±å±‚)\n+ Training and generalization \n\n> åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè€ƒè™‘äº†å½“æˆ‘ä»¬ç»„åˆä¸¤ä¸ªæµ…å±‚ç½‘ç»œæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚æˆ‘ä»¬è®ºè¯äº†ç¬¬ä¸€ä¸ªç½‘ç»œ\"æŠ˜å \"è¾“å…¥ç©ºé—´ï¼Œè€Œç¬¬äºŒä¸ªç½‘ç»œåˆ™å¯¹å…¶åº”ç”¨åˆ†æ®µçº¿æ€§å‡½æ•°ã€‚å½“è¾“å…¥ç©ºé—´è¢«æŠ˜å åˆ°è‡ªèº«æ—¶ï¼Œç¬¬äºŒä¸ªç½‘ç»œçš„æ•ˆæœä¼šè¢«å¤åˆ¶ã€‚\n>\n> æˆ‘ä»¬æ¥ç€è¯æ˜äº†è¿™ç§æµ…å±‚ç½‘ç»œçš„ç»„åˆæ˜¯æ·±åº¦ç½‘ç»œä¸­ä¸¤å±‚çš„ç‰¹ä¾‹ã€‚æˆ‘ä»¬å°†æ¯ä¸€å±‚ä¸­çš„ ReLU å‡½æ•°è§£é‡Šä¸ºåœ¨å¤šä¸ªä½ç½®è£å‰ªè¾“å…¥å‡½æ•°ï¼Œå¹¶åœ¨è¾“å‡ºå‡½æ•°ä¸­åˆ›é€ \"æ–°çš„ç‚¹\"ã€‚æˆ‘ä»¬å¼•å…¥äº†è¶…å‚æ•°çš„æ¦‚å¿µï¼Œå°±ç›®å‰æ‰€è§çš„ç½‘ç»œè€Œè¨€ï¼Œè¶…å‚æ•°åŒ…æ‹¬æ¯å±‚ä¸­éšè—å•å…ƒçš„æ•°é‡ã€‚\n>\n> æœ€åï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†æµ…å±‚å’Œæ·±åº¦ç½‘ç»œã€‚æˆ‘ä»¬å‘ç°ï¼š(i) ä¸¤ç§ç½‘ç»œéƒ½èƒ½ä»¥è¶³å¤Ÿçš„å®¹é‡è¿‘ä¼¼ä»»ä½•å‡½æ•°ï¼›(ii) æ·±åº¦ç½‘ç»œæ¯ä¸ªå‚æ•°äº§ç”Ÿæ›´å¤šçš„çº¿æ€§åŒºåŸŸï¼Œä½¿å¾—æŸäº›å‡½æ•°èƒ½å¤Ÿç”¨æ·±åº¦ç½‘ç»œæ›´æœ‰æ•ˆåœ°è¿‘ä¼¼ï¼›(iv) å¤§å‹ã€ç»“æ„åŒ–çš„è¾“å…¥ï¼ˆå¦‚å›¾åƒï¼‰æœ€å¥½åœ¨å¤šä¸ªé˜¶æ®µå¤„ç†ï¼›ä»¥åŠ (v) åœ¨å®è·µä¸­ï¼Œæœ€å¥½çš„ç»“æœå¾€å¾€æ˜¯ä½¿ç”¨å…·æœ‰å¤šå±‚çš„æ·±åº¦ç½‘ç»œè·å¾—çš„ã€‚\n>\n> ç°åœ¨æˆ‘ä»¬å·²ç»ç†è§£äº†æ·±åº¦å’Œæµ…å±‚ç½‘ç»œæ¨¡å‹ï¼Œæˆ‘ä»¬å°†æ³¨æ„åŠ›è½¬å‘è®­ç»ƒå®ƒä»¬ã€‚åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºæŸå¤±å‡½æ•°ã€‚å¯¹äºä»»ä½•ç»™å®šçš„å‚æ•°å€¼ $\\varphi$ï¼ŒæŸå¤±å‡½æ•°è¿”å›ä¸€ä¸ªå•ä¸€æ•°å€¼ï¼Œè¡¨ç¤ºæ¨¡å‹è¾“å‡ºä¸è®­ç»ƒæ•°æ®é›†çš„çœŸå®é¢„æµ‹ä¹‹é—´çš„ä¸åŒ¹é…ç¨‹åº¦ã€‚åœ¨ç¬¬ 6 ç« å’Œç¬¬ 7 ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºè®­ç»ƒè¿‡ç¨‹æœ¬èº«ï¼Œå³æˆ‘ä»¬å¦‚ä½•å¯»æ‰¾èƒ½æœ€å°åŒ–è¿™ä¸ªæŸå¤±çš„å‚æ•°å€¼ã€‚","tags":["note","AI"],"categories":["implementation"]},{"title":"åŒ—å²›-å¿…å®šæœ‰äººé‡å†™çˆ±æƒ…","url":"/2025/01/12/åŒ—å²›-å¿…å®šæœ‰äººé‡å†™çˆ±æƒ…/","content":"\nã€Šæˆ‘ä»¬ã€‹ åŒ—å²›  \n\nå¤±é­‚è½é­„  \næç€ç¯ç¬¼è¿½èµ¶æ˜¥å¤©  \n\nä¼¤ç–¤å‘äº®ï¼Œæ¯å­è½¬åŠ¨  \nå…‰çº¿è¢«åˆ›é€   \nçœ‹é‚£è¿·äººçš„æ—¶åˆ»ï¼š  \nç›—è´¼æ½œå…¥é‚®å±€  \nä¿¡å‘å‡ºå«å–Š  \n\né’‰å­å•Šé’‰å­  \nè¿™æ­Œè¯ä¸å¯æ›´æ”¹  \næœ¨æŸ´ç´§ç´§æ‚åœ¨ä¸€èµ·  \nå¯»æ‰¾å¬ä¼—  \n\nå¯»æ‰¾å†¬å¤©çš„å¿ƒ  \næ²³æµå°½å¤´  \nèˆ¹å¤«ç­‰å¾…ç€èŒ«èŒ«æš®è‰²  \n\nå¿…æœ‰äººé‡å†™çˆ±æƒ…","tags":["art"],"categories":["others"]},{"title":"çŸ¥ä¹ä¸Šçš„æœ‰è¶£çš„æ¦‚ç‡è®ºä¸çº¿æ€§ä»£æ•°é—®é¢˜æ±‡æ€»","url":"/2025/01/12/çŸ¥ä¹ä¸Šçš„æœ‰è¶£çš„æ¦‚ç‡è®ºä¸çº¿æ€§ä»£æ•°é—®é¢˜æ±‡æ€»/","content":"\n# æ¦‚ç‡è®º\n\nåœ†ä¸Šéšæœºå–ç‚¹ï¼Œåœ¨åŒä¸€ä¸ªåŠåœ†å†…çš„æ¦‚ç‡æœ‰å¤šå¤§ï¼Ÿ - Dylaaançš„æ–‡ç«  - çŸ¥ä¹\nhttps://zhuanlan.zhihu.com/p/17491774604","tags":["note"],"categories":["genomics"]},{"title":"udl-chap1-2","url":"/2025/01/12/udl-chap1-2/","content":"\n## ä¿¡æ¯\næœ¬ä¹¦ç½‘ç«™è§ï¼Œhttps://udlbook.github.io/udlbook/\n\n## å¦‚ä½•é˜…è¯»è¿™æœ¬ä¹¦\nç¬¬ä¸€ç« æ˜¯æ¦‚è®ºï¼Œä½œè€…è®²äº†åº”è¯¥å¦‚ä½•å­¦ä¹ è¿™æœ¬ä¹¦ï¼Œ\n\n> æœ¬ä¹¦ä¸­å¤§å¤šæ•°å‰©ä½™ç« èŠ‚åŒ…å«ä¸»ä½“æ–‡æœ¬ã€æ³¨é‡Šéƒ¨åˆ†å’Œä¸€ç»„ä¹ é¢˜ã€‚\n>\n> ä¸»ä½“æ–‡æœ¬æ—¨åœ¨è‡ªæˆä¸€ä½“ï¼Œå¯ä»¥åœ¨ä¸å‚è€ƒç« èŠ‚å…¶ä»–éƒ¨åˆ†çš„æƒ…å†µä¸‹é˜…è¯»ã€‚å°½å¯èƒ½åœ°ï¼ŒèƒŒæ™¯æ•°å­¦è¢«çº³å…¥ä¸»ä½“æ–‡æœ¬ä¸­ã€‚ç„¶è€Œï¼Œå¯¹äºè¾ƒå¤§çš„ä¸»é¢˜ï¼Œå¦‚æœå®ƒä¼šåˆ†æ•£è®ºç‚¹çš„ä¸»çº¿ï¼ŒèƒŒæ™¯ææ–™ä¼šè¢«é™„å½•å¤„ç†ï¼Œå¹¶åœ¨è¾¹ç¼˜æä¾›å‚è€ƒã€‚ä¹¦ä¸­å¤§å¤šæ•°ç¬¦å·éµå¾ªé™„å½•Açš„ç¬¦å·æ ‡å‡†ã€‚ç„¶è€Œï¼Œä¸€äº›çº¦å®šä¸å¤ªå¹¿æ³›ä½¿ç”¨ï¼Œé¼“åŠ±è¯»è€…åœ¨ç»§ç»­ä¹‹å‰æŸ¥é˜…é™„å½•Aã€‚\n>\n> ä¸»ä½“æ–‡æœ¬åŒ…æ‹¬è®¸å¤šå…³äºæ·±åº¦å­¦ä¹ æ¨¡å‹å’Œç»“æœçš„æ–°æ’å›¾å’Œå¯è§†åŒ–ã€‚æˆ‘åŠªåŠ›æä¾›ç°æœ‰æ€æƒ³çš„æ–°è§£é‡Šï¼Œè€Œä¸ä»…ä»…æ˜¯æ•´ç†ä»–äººçš„å·¥ä½œã€‚æ·±åº¦å­¦ä¹ æ˜¯ä¸€ä¸ªæ–°é¢†åŸŸï¼Œæœ‰æ—¶ç°è±¡å¹¶ä¸å®Œå…¨æ¸…æ¥šã€‚æˆ‘ä¼šæ˜ç¡®æŒ‡å‡ºå“ªäº›åœ°æ–¹æƒ…å†µä¸æ˜ï¼Œä»¥åŠæˆ‘çš„è§£é‡Šåº”è°¨æ…å¯¹å¾…ã€‚\n>\n> å‚è€ƒæ–‡çŒ®ä»…åœ¨ç« èŠ‚ä¸»ä½“ä¸­åŒ…å«ç»“æœè¢«å±•ç¤ºçš„åœ°æ–¹ã€‚ç›¸åï¼Œå‚è€ƒæ–‡çŒ®å¯ä»¥åœ¨ç« èŠ‚æœ«å°¾çš„æ³¨é‡Šéƒ¨åˆ†æ‰¾åˆ°ã€‚æˆ‘é€šå¸¸ä¸åœ¨ä¸»ä½“æ–‡æœ¬ä¸­å°Šé‡å†å²å…ˆä¾‹ï¼›å¦‚æœæŸä¸ªå½“å‰æŠ€æœ¯çš„å‰èº«ä¸å†æœ‰ç”¨ï¼Œæˆ‘å°†ä¸ä¼šæåŠã€‚ç„¶è€Œï¼Œé¢†åŸŸçš„å†å²å‘å±•åœ¨æ³¨é‡Šéƒ¨åˆ†ä¸­è¿›è¡Œäº†æè¿°ï¼Œå¹¶ä¸”å¸Œæœ›èƒ½å…¬å¹³åœ°ç»™äºˆç›¸åº”çš„ä¿¡ç”¨ã€‚\n>\n> æ³¨é‡Šéƒ¨åˆ†æŒ‰æ®µè½ç»„ç»‡ï¼Œæä¾›è¿›ä¸€æ­¥é˜…è¯»çš„æŒ‡å¼•ã€‚å®ƒä»¬åº”å¸®åŠ©è¯»è€…åœ¨å­é¢†åŸŸå†…å®šä½è‡ªå·±ï¼Œå¹¶ç†è§£å…¶ä¸æœºå™¨å­¦ä¹ å…¶ä»–éƒ¨åˆ†çš„å…³ç³»ã€‚ä¸ä¸»ä½“æ–‡æœ¬ç›¸æ¯”ï¼Œæ³¨é‡Šéƒ¨åˆ†çš„è‡ªæˆä½“ç³»ç¨‹åº¦è¾ƒä½ã€‚æ ¹æ®ä½ çš„èƒŒæ™¯çŸ¥è¯†å’Œå…´è¶£æ°´å¹³ï¼Œä½ å¯èƒ½ä¼šå‘ç°è¿™äº›éƒ¨åˆ†çš„ç”¨å¤„æœ‰æ‰€ä¸åŒã€‚\n>\n> æ¯ç« éƒ½æœ‰è‹¥å¹²ç›¸å…³ä¹ é¢˜ã€‚åœ¨ä¸»ä½“æ–‡æœ¬ä¸­ï¼Œå½“åº”è¯¥å°è¯•ä¹ é¢˜æ—¶ï¼Œä¼šåœ¨è¾¹ç¼˜è¿›è¡Œå¼•ç”¨ã€‚æ­£å¦‚ä¹”æ²»Â·æ³¢åˆ©äºšæ‰€è¨€ï¼š\"æ•°å­¦ï¼Œæ‚¨çœ‹ï¼Œä¸æ˜¯ä¸€é¡¹è§‚ä¼—è¿åŠ¨ã€‚\"ä»–æ˜¯å¯¹çš„ï¼Œæˆ‘å¼ºçƒˆå»ºè®®æ‚¨åœ¨é˜…è¯»è¿‡ç¨‹ä¸­å°è¯•ä¹ é¢˜ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒä»¬æä¾›çš„è§è§£å°†å¸®åŠ©æ‚¨ç†è§£ä¸»ä½“æ–‡æœ¬ã€‚å¯¹äºåœ¨ç›¸å…³ç½‘ç«™ï¼ˆhttp://udlbook.comï¼‰ä¸Šæä¾›ç­”æ¡ˆçš„ä¹ é¢˜ï¼Œä¼šç”¨æ˜Ÿå·è¿›è¡Œæ ‡æ³¨ã€‚æ­¤å¤–ï¼Œå¸®åŠ©æ‚¨ç†è§£æœ¬ä¹¦ä¸­æ€æƒ³çš„Pythonç¬”è®°æœ¬ä¹Ÿå¯ä»¥é€šè¿‡è¯¥ç½‘ç«™è·å¾—ï¼Œè¿™äº›ç¬”è®°æœ¬ä¹Ÿåœ¨æ–‡æœ¬çš„è¾¹ç¼˜è¿›è¡Œäº†å¼•ç”¨ã€‚å®é™…ä¸Šï¼Œå¦‚æœæ‚¨è§‰å¾—è‡ªå·±æœ‰äº›ç”Ÿç–ï¼Œç°åœ¨å¯èƒ½å€¼å¾—å…ˆå­¦ä¹ ä¸€ä¸‹å…³äºèƒŒæ™¯æ•°å­¦çš„ç¬”è®°æœ¬ã€‚\n>\n> ä¸å¹¸çš„æ˜¯ï¼Œäººå·¥æ™ºèƒ½ç ”ç©¶çš„å¿«é€Ÿå‘å±•ä½¿å¾—æœ¬ä¹¦ä¸å¯é¿å…åœ°å°†æ˜¯ä¸€é¡¹æŒç»­çš„å·¥ä½œã€‚å¦‚æœæ‚¨å‘ç°æŸäº›éƒ¨åˆ†éš¾ä»¥ç†è§£ã€æ˜æ˜¾çš„é—æ¼æˆ–ä¼¼ä¹å¤šä½™çš„éƒ¨åˆ†ï¼Œè¯·é€šè¿‡ç›¸å…³ç½‘ç«™ä¸æˆ‘ä»¬è”ç³»ã€‚æˆ‘ä»¬å¯ä»¥å…±åŒåŠªåŠ›ä½¿ä¸‹ä¸€ç‰ˆæ›´å¥½ã€‚\n\n## æœ‰ç›‘ç£å­¦ä¹ \n\n> ç›‘ç£å­¦ä¹ æ¨¡å‹æ˜¯ä¸€ä¸ªå‡½æ•° $y = f(x,\\phi)$ï¼Œå®ƒå°†è¾“å…¥ $x$ ä¸è¾“å‡º $y$ å…³è”èµ·æ¥ï¼Œå…·ä½“å…³ç³»ç”±å‚æ•° $\\phi$ å†³å®šã€‚ä¸ºäº†è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒæ•°æ®é›† $\\{x_i, y_i\\}$ ä¸Šå®šä¹‰æŸå¤±å‡½æ•° $L(\\phi)$ï¼Œé‡åŒ–æ¨¡å‹é¢„æµ‹ $f(x_i,\\phi)$ ä¸è§‚å¯Ÿåˆ°çš„è¾“å‡º $y_i$ ä¹‹é—´çš„å·®å¼‚ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å¯»æ‰¾æœ€å°åŒ–æŸå¤±çš„å‚æ•°ï¼Œå¹¶åœ¨ä¸åŒçš„æµ‹è¯•æ•°æ®é›†ä¸Šè¯„ä¼°æ¨¡å‹ï¼Œä»¥æ£€éªŒå…¶å¯¹æ–°è¾“å…¥çš„æ³›åŒ–èƒ½åŠ›ã€‚\n> \n> æ¥ä¸‹æ¥çš„ç« èŠ‚ï¼ˆ3-9ï¼‰æ‰©å±•äº†è¿™äº›æ¦‚å¿µã€‚ç¬¬3ç« è®¨è®ºäº†æµ…å±‚ç¥ç»ç½‘ç»œï¼Œå®ƒæ¯”çº¿æ€§å›å½’ç¨å¤æ‚ï¼Œä½†èƒ½æè¿°æ›´å¹¿æ³›çš„è¾“å…¥/è¾“å‡ºå…³ç³»ã€‚ç¬¬4ç« ä»‹ç»æ·±å±‚ç¥ç»ç½‘ç»œï¼Œèƒ½å¤Ÿç”¨æ›´å°‘çš„å‚æ•°æè¿°å¤æ‚å‡½æ•°ï¼Œå¹¶åœ¨å®è·µä¸­è¡¨ç°æ›´å¥½ã€‚ç¬¬5ç« ç ”ç©¶ä¸åŒä»»åŠ¡çš„æŸå¤±å‡½æ•°ï¼Œå¹¶æ­ç¤ºæœ€å°äºŒä¹˜æŸå¤±çš„ç†è®ºåŸºç¡€ã€‚ç¬¬6å’Œç¬¬7ç« è®¨è®ºè®­ç»ƒè¿‡ç¨‹ï¼Œç¬¬8ç« æ¢è®¨å¦‚ä½•è¡¡é‡æ¨¡å‹æ€§èƒ½ï¼Œç¬¬9ç« è€ƒè™‘æ­£åˆ™åŒ–æŠ€æœ¯ï¼Œä»¥æé«˜æ¨¡å‹æ€§èƒ½ã€‚\n\n","tags":["note","AI"],"categories":["implementation"]},{"title":"å¾…å®Œæˆç³»åˆ—åšæ–‡æ¸…å•","url":"/2025/01/12/å¾…å®Œæˆç³»åˆ—åšæ–‡æ¸…å•/","content":"\n## 20250112 \n\nå¾…å®Œæˆçš„ç³»åˆ—åšæ–‡ä¸»é¢˜ä¸­ï¼Œé™¤éšæœºè¿‡ç¨‹ï¼ˆè¿™ä¸ªå¯èƒ½å’Œæ·±åº¦å­¦ä¹ çš„è¯»ä¹¦ç¬”è®°ä¸€èµ·æ›´æ–°ï¼‰å¤–ï¼Œå…¶ä½™ä¸¤æœ¬ä¹¦çš„é˜…è¯»è®¡åˆ’ç»“åˆç ”ç©¶å®é™…è¿›è¡Œç³»ç»Ÿæ€§å®Œå–„ä¸æ›´æ–°ã€‚é‰´äºè¿‘æœŸç ”ç©¶ä»»åŠ¡ç¹é‡ï¼Œæ‹Ÿå…ˆè¡Œç§¯ç´¯ç›¸å…³ç ”ç©¶ç´ æä¸ç†è®ºæ´è§ï¼Œå¾…æ¡ä»¶æˆç†Ÿæ—¶å†è¡Œæ›´æ–°ã€‚ç¬”è€…è®¤ä¸ºï¼Œå­¦æœ¯é˜…è¯»åº”ä¸å®é™…ç ”ç©¶ç›¸ç»“åˆï¼Œæ–¹èƒ½é¿å…æ€ç»´é™·å…¥è¢«åŠ¨æ¥å—çš„çŠ¶æ€ï¼Œç¡®ä¿å­¦æœ¯æ€æƒ³çš„ç‹¬ç«‹æ€§ä¸åˆ›é€ æ€§ã€‚åŒæ—¶ï¼Œå”¯æœ‰åšå®šå­¦æœ¯ä¿¡å¿µï¼ŒæŒç»­è·µè¡Œç ”ç©¶è§„åˆ’ï¼Œæ–¹èƒ½ç¡®ä¿ç ”ç©¶å·¥ä½œçš„ç³»ç»Ÿæ€§ä¸å®Œæ•´æ€§ã€‚\n\n- [ ] Dobrowçš„éšæœºè¿‡ç¨‹\n- [ ] igraph å­¦ä¹ ç¬”è®°\n- [ ] åŒ»å­¦å…ç–«å­¦\n\nè®¡åˆ’çš„è¯»ä¹¦ç¬”è®°ç³»åˆ—\n- [ ] ã€ŠUnderstanding Deep Learningã€‹\n- [ ] ã€ŠChatGPTè¿›é˜¶ï¼šæç¤ºå·¥ç¨‹å…¥é—¨ã€‹ä¸»è¦ç”¨äºå†™ä»£ç ï¼Œå’Œä¸€äº›ç®€å•ä»»åŠ¡\n- [ ] ã€Šæˆ‘çš„ç§‘ç ”åŠ©ç†ï¼šChatGPTå…¨æ–¹ä½ä½¿ç”¨æŒ‡å—ã€‹ä¸»è¦ç”¨äºå†™ä»£ç ï¼Œå’Œä¸€äº›ç®€å•ä»»åŠ¡","tags":["note"],"categories":["orthers"]},{"title":"cursorä¸cline","url":"/2025/01/12/cursorä¸cline/","content":"\n\n## ç»“è®º\nå°±å¯ç”¨æ€§è€Œè¨€ï¼Œç›®å‰ç”¨cursorè¾ƒä¸ºæ–¹ä¾¿ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„å®ç”¨æ•™ç¨‹æ˜¯ï¼š[AIç¼–ç¨‹ç¥å™¨Cursorã€‘ä¸æ­¢å†™ä»£ç ï¼Œ5ç§ç©æ³•è®©ä½ å…¨é¢ææ•ˆï¼Œå°ç™½å®è—!](https://www.bilibili.com/video/BV1rRCVYREFm/?share_source=copy_web&vd_source=6c7840ca8bc4d5854cde3763fbf77fca)\n\nclineä¸€ä¸ªæç¬‘çš„ä¸æ˜“ç”¨ä¹‹å¤„ï¼Œæ˜¯å…¶éœ€è¦è€—è´¹æ¼«é•¿çš„æ—¶é—´ï¼Œç­‰å¾…å“åº”ï¼Œgithubä¸Šæœ‰äººè¯´[å……é’±å¯ä»¥è§£å†³](https://github.com/cline/cline/issues/1226)ï¼Œä½†æ˜¯æˆ‘è¯•äº†ï¼Œå¥½åƒä¸å¤ªè¡Œã€‚\n\n\n## CSDNä¸Šçš„ä¸€ä¸ªæµ‹è¯„\n\n> 2024å¹´12æœˆï¼Œæˆ‘ä½“éªŒäº†ä¸€ä¸‹AIç¼–ç è¾…åŠ©å·¥å…·ï¼Œæœ¬æ–‡æˆ‘ä»¬å°†å¯¹æ¯”åˆ†æGitHub Copilotã€Cursorå’ŒClineè¿™ä¸‰æ¬¾AIå·¥å…·ï¼Œè¯„ä¼°å®ƒä»¬åœ¨è‡ªåŠ¨ä»£ç ç”Ÿæˆå’ŒAIè¾…åŠ©ç¼–ç æ–¹é¢çš„ä¼˜ç¼ºç‚¹ã€‚\n\n> **GitHub Copilot**\n> æ˜¯ä¸€æ¬¾IDEæ’ä»¶ï¼Œéœ€è¦ç»“åˆJetBrainsæˆ–VS Codeä½¿ç”¨ã€‚\n>\n> **ä¼˜ç‚¹**\n> - é«˜æ•ˆçš„ä»£ç è¡¥å…¨ï¼šGitHub Copilotèƒ½å¤Ÿå®æ—¶åˆ†æä»£ç ä¸Šä¸‹æ–‡å¹¶æä¾›å»ºè®®ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®Œæˆä»£ç å—ã€‚\n> - è·¨è¯­è¨€æ”¯æŒï¼šæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼Œæ»¡è¶³ä¸åŒå¼€å‘è€…çš„éœ€æ±‚ã€‚\n> - å­¦ä¹ ä¸æˆé•¿ï¼šCopiloté€šè¿‡ä¸æ–­å­¦ä¹ å¼€å‘è€…çš„ä»£ç é£æ ¼å’Œä¹ æƒ¯æ¥æé«˜å»ºè®®è´¨é‡ã€‚\n>\n> **ç¼ºç‚¹**\n> - ä¾èµ–æ€§ï¼šè¿‡åº¦ä¾èµ–Copilotå¯èƒ½å¯¼è‡´ç¨‹åºå‘˜å¤±å»è‡ªä¸»æ€è€ƒå’Œæ‰‹åŠ¨ç¼–å†™ä»£ç çš„èƒ½åŠ›ã€‚\n> - éšç§é—®é¢˜ï¼šCopilotéœ€è¦è®¿é—®ä»£ç åº“ä»¥æä¾›å»ºè®®ï¼Œè¿™å¯èƒ½å¼•å‘éšç§æ‹…å¿§ã€‚\n> - æˆæœ¬é—®é¢˜ï¼šä¸€ä¸ªæœˆçš„å…è´¹ä½“éªŒæœŸï¼Œä¹‹åæ¯ä¸ªæœˆ10ç¾é‡‘ï¼Œæˆ–è€…æ¯å¹´100ç¾é‡‘ã€‚\n\n> **Cursor**\n> æ˜¯ä¸€æ¬¾åŸºäºVS Codeå¼€å‘çš„IDEï¼Œå¯å•ç‹¬ä¸‹è½½å®‰è£…ä½¿ç”¨ã€‚\n>\n> **ä¼˜ç‚¹**\n> - æé«˜å¼€å‘æ•ˆç‡ï¼šé€šè¿‡æ™ºèƒ½è¡¥å…¨ã€è‡ªåŠ¨é”™è¯¯ä¿®å¤å’Œä¼˜åŒ–å»ºè®®ï¼Œå¼€å‘è€…å¯ä»¥æ›´å¿«åœ°å®Œæˆä»£ç ç¼–å†™å’Œè°ƒè¯•å·¥ä½œã€‚\n> - é™ä½é”™è¯¯ç‡ï¼šCursorçš„ä»£ç å®¡æŸ¥å’Œè‡ªåŠ¨ä¿®å¤åŠŸèƒ½æœ‰åŠ©äºé¿å…å¸¸è§çš„ç¼–ç¨‹é”™è¯¯ã€‚\n> - å¢å¼ºä»£ç å¯è¯»æ€§ï¼šAIçš„ä¼˜åŒ–å»ºè®®ä¸ä»…æå‡äº†ä»£ç çš„æ€§èƒ½ï¼Œè¿˜èƒ½å¸®åŠ©å¼€å‘è€…ç¼–å†™æ›´åŠ ç®€æ´æ˜“è¯»çš„ä»£ç ã€‚\n> - å®æ—¶åé¦ˆä¸åä½œï¼šé€šè¿‡ä¸AIçš„å®æ—¶å¯¹è¯ï¼Œå¼€å‘è€…å¯ä»¥éšæ—¶è·å¾—å¸®åŠ©ã€‚\n> - ä»·æ ¼ï¼šæœ‰å…è´¹ç‰ˆï¼ŒProç‰ˆæœ¬ç¾æœˆ20ç¾é‡‘ã€‚\n>\n> **ç¼ºç‚¹**\n> - åŸºç¡€åŠŸèƒ½ç¼ºå¤±ï¼šCursorçš„åŸºç¡€åŠŸèƒ½å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼Œä¸èƒ½ç§°ä¹‹ä¸ºä¸€ä¸ªå¯é çš„IDEã€‚\n> - æœåŠ¡ä¸ç¨³å®šï¼šCursorçš„æœåŠ¡å¯èƒ½ä¸å¤Ÿç¨³å®šï¼Œå½±å“ä½¿ç”¨ä½“éªŒã€‚\n\n> **Cline**\n> æ˜¯ä¸€æ¬¾IDEæ’ä»¶ï¼Œéœ€è¦ç»“åˆJetBrainsæˆ–VS Codeä½¿ç”¨ã€‚\n>\n> **ä¼˜ç‚¹**\n> - å…¨é¢çš„é¡¹ç›®æ”¯æŒï¼šClineä¸ä»…æä¾›ä»£ç è¡¥å…¨ï¼Œè¿˜èƒ½æ‰§è¡Œå¤æ‚çš„è½¯ä»¶å¼€å‘ä»»åŠ¡ï¼Œè¦†ç›–å¼€å‘å…¨æµç¨‹ã€‚\n> - çµæ´»çš„æ¨¡å‹é€‰æ‹©ï¼šæ”¯æŒå¤šç§APIæä¾›å•†å’Œæ¨¡å‹ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚å’Œé¢„ç®—é€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹ã€‚\n> - æˆæœ¬æ•ˆç›Šé«˜ï¼šç‰¹åˆ«æ˜¯ä½¿ç”¨DeepSeekç­‰æ¨¡å‹æ—¶ï¼Œæˆæœ¬æ˜¾è‘—é™ä½ã€‚\n> - äººæœºåä½œï¼šæ¯ä¸€æ­¥æ“ä½œéƒ½éœ€è¦ç”¨æˆ·ç¡®è®¤ï¼Œä¿è¯äº†å®‰å…¨æ€§ã€‚\n> - æˆæœ¬ï¼šé¢„ä»˜è´¹æ¨¡å¼ï¼Œéœ€è¦ç»‘å®šé“¶è¡Œå¡æˆ–Paypalï¼Œä½†ä¹‹åé€‰æ‹©Google Geminiæ¨¡å‹çš„è¯ï¼Œå¯ä»¥å…è´¹ä½¿ç”¨ï¼ˆæœ¬æ–‡å†™ä½œæ—¶ä»ç„¶å¯ä»¥ï¼‰ã€‚\n>\n> **ç¼ºç‚¹**\n> - å¼€æºåŠ£åŠ¿ï¼šä½œä¸ºå¼€æºå·¥å…·ï¼ŒClineå¯èƒ½åœ¨æŸäº›é«˜çº§åŠŸèƒ½ä¸Šå—åˆ°é™åˆ¶ã€‚\n> - æˆæœ¬ä¸Šå‡ï¼šç”±äºåŸºäºtokençš„æ¶ˆè€—æ¨¡å¼ï¼Œéšç€ä½¿ç”¨é¢‘ç‡çš„å¢åŠ ï¼Œå¼€å‘æˆæœ¬ä¹Ÿå¯èƒ½è¿…é€Ÿä¸Šå‡ã€‚\n\n> **æ€»ç»“**\n> GitHub Copilotã€Cursorå’ŒClineå„æœ‰å…¶ç‹¬ç‰¹çš„ä¼˜ç¼ºç‚¹ã€‚GitHub Copilotä»¥å…¶é«˜æ•ˆçš„ä»£ç è¡¥å…¨å’Œè·¨è¯­è¨€æ”¯æŒè‘—ç§°ï¼Œä½†éšç§å’Œä¾èµ–æ€§é—®é¢˜ä¸å®¹å¿½è§†ã€‚Cursoré€šè¿‡æ™ºèƒ½è¡¥å…¨å’Œå®æ—¶åä½œæé«˜äº†å¼€å‘æ•ˆç‡ï¼Œä½†å…¶åŸºç¡€åŠŸèƒ½å’Œç¨³å®šæ€§æœ‰å¾…æå‡ã€‚Clineåˆ™ä»¥å…¶å…¨é¢çš„é¡¹ç›®æ”¯æŒå’Œçµæ´»çš„æ¨¡å‹é€‰æ‹©è„±é¢–è€Œå‡ºï¼Œä½†æˆæœ¬å’Œå¼€æºåŠ£åŠ¿ä¹Ÿéœ€è€ƒè™‘ã€‚å¼€å‘è€…åº”æ ¹æ®è‡ªèº«éœ€æ±‚å’Œåå¥½é€‰æ‹©æœ€é€‚åˆçš„å·¥å…·ã€‚\n\n\n\n                            ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºè½¬è½½çš„åšä¸»åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚            \n                            åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/xidianjiapei001/article/details/144374563","tags":["note","AI"],"categories":["implementation"]},{"title":"ä¸¤é¦–ç”±deepseekç”Ÿæˆçš„åŒ—å²›é£æ ¼çš„è¯—","url":"/2025/01/12/ä¸€é¦–åŒ—å²›é£æ ¼çš„è¯—/","content":"ã€Šæ¶ˆè§£ã€‹<br>\næ„ä¹‰åƒæ²™æ¼ä¸­çš„æ²™<br>\nä¸€ç²’ç²’å è½åœ¨è™šæ— çš„æ·±æ¸Š<br>\nè¯´æ•™æ˜¯çº¸åšçš„å‰‘<br>\nåˆºå‘é£çš„èƒ¸è†›<br>\nç¢æˆè‹ç™½çš„è´è¶<br>\nç¡®å®šåœ¨é•œä¸­æ¨¡ç³Šæˆé›¾<br>\næˆ‘ä»¬éƒ½æ˜¯é›¾ä¸­çš„å½±å­<br>\nå¯»æ‰¾å¤±å»çš„å½¢çŠ¶<br>\nåœ¨æ¶ˆè§£çš„ä¸–ç•Œé‡Œ<br>\næˆ‘ä»¬éƒ½æ˜¯è‡ªå·±çš„è°œé¢˜<br>\n<br>\nã€Šä¹ é¢˜ã€‹<br>\nçˆ±æƒ…å’Œå°Šä¸¥<br>\nåŒæ—¶è½¬èº«<br>\nç•™ä¸‹ä¸€ä¸ª<br>\næ°¸è¿œè§£ä¸å¼€çš„æ–¹ç¨‹<br>\næ¸…æ™¨çš„é•œå­<br>\nç…§è§äº†<br>\nä¸€ä¸ªæ•°å­—çš„æ­»äº¡<br>\næœ€åçš„ç®—å¼<br>\næ˜¯æ°´æ³¥å°é˜¶ä¸Šçš„<br>\nè¡€è¿¹<br>\nç°åœ¨æˆ‘ç»ˆäºæ˜ç™½<br>\näººç”Ÿæ²¡æœ‰æ ‡å‡†ç­”æ¡ˆ<br>\nåªæœ‰<br>\næ°¸è¿œè§£ä¸å®Œçš„<br>\nä¹ é¢˜","tags":["art"],"categories":["others"]},{"title":"artin_review","url":"/2025/01/12/artin-review/","content":"2024.03-2025.01\n# ç¼˜èµ·\n\nè§ï¼šèƒ½è¯´ä¸€æœ¬æˆ–å‡ æœ¬åœ¨ä½ åœ¨å­¦æ•°å­¦è·¯ä¸Šå¯¹ä½ å½±å“æœ€å¤§çš„ä¸€æœ¬ä¹¦å—ï¼Ÿ - ä¸‡ç‰©çš†æ•°æ•°æµ·æ‹¾è´çš„å›ç­” - çŸ¥ä¹\nhttps://www.zhihu.com/question/555672024/answer/3418569722\n\nå¦‚ä½•ä»ç¾¤$Z_n^{\\times}$ï¼Œç¯$\\mathbb{Z}_n$ï¼Œåˆ°$\\mathbb{F}_p$ï¼Œå†åˆ°Galoisç†è®ºã€‚ä½ å¯ä»¥å°†è¿™ç¯‡ä¹¦è¯„è§†ä¸ºå…³äºArtinä¸€ä¹¦çš„ä¸€ä¸ªå­¦ä¹ çº²é¢†ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿™ç¯‡ä¹¦è¯„çš„æœ«å°¾ï¼Œæˆ‘ä»¬è¿˜é™„ä¸Šä¸€äº›è¿‘å¹´æ¥å‡ºç°åœ¨å›½å†…å¤–çš„æ•°å­¦è€ƒè¯•ä¸­çš„ä¹ é¢˜ä»¥åŠè§£ç­”ï¼Œè¿™äº›ä¹ é¢˜æ²¡æœ‰è¶…è¿‡Artinä¸€ä¹¦åŒ…å«çš„å†…å®¹ã€‚\n\nArtinçš„ç¼–æ’å¯¹åˆå­¦è€…ä¸æ˜¯ç‰¹åˆ«å‹å¥½ï¼Œæ¯”å¦‚ç¬¬äºŒç‰ˆä¸€å¼€å§‹å°±æ˜¯çº¿æ€§ä»£æ•°ï¼Œæˆ–è®¸ä¼šè®©ä¸€äº›å·²ç»è¢«çº¿æ€§ä»£æ•°äº§ç”Ÿå®¡ç¾ç–²åŠ³çš„è¯»è€…åŠé€€ï¼Œä½†æ˜¯ç­‰ä»”ç»†è€ç€æ€§å­è¯»å®Œä¹‹åï¼Œä½ ä¼šå‘ç°ï¼Œè¿™äº›çº¿æ€§ä»£æ•°çš„çŸ¥è¯†ï¼Œå…¶å®ä¸åé¢çš„æŠ½è±¡ä»£æ•°çš„çŸ¥è¯†å¹¶ä¸æ˜¯å‰²è£‚çš„ã€‚ç¬”è€…åœ¨å°†Artinçš„ä¹¦é€šè¯»äº†ä¸‰éä¹‹åï¼Œå‘ˆç°ç»™ä¸€ä¸ªç¬”è€…è®¤ä¸ºè¾ƒä¸ºå®¹æ˜“ç†è§£çš„ç›®æ¬¡ã€‚ç¬”è€…è§‰å¾—Artinè¿™æœ¬ä¹¦ï¼Œä»…ç®¡ç¼ºç‚¹è¯¸å¤šï¼Œä¸Artiné£æ ¼ç±»ä¼¼çš„ï¼Œå¦‚Dummitï¼Œæˆ‘è§‰å¾—ä¹Ÿå¾ˆå¥½ã€‚ä½†æ˜¯Artinè¿™æœ¬ä¹¦æœ€å¤§çš„ä¼˜ç‚¹ï¼Œæ˜¯å°†çº¿æ€§ä»£æ•°å’ŒæŠ½è±¡ä»£æ•°èåˆä¸ºä¸€ä½“ï¼Œå…·ä½“å°±æ˜¯é€šè¿‡è¡¨ç¤ºè®ºçš„çŸ¥è¯†ç©¿æ’å°†ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œå‡ ä¹æ²¡æœ‰ä¸€æœ¬é¢å‘æœ¬ç§‘çš„æ•™æï¼Œèƒ½å¤Ÿåšçš„è¿™ä¹ˆå¥½ã€‚\n","tags":["note"],"categories":["math"]},{"title":"learn_python_001","url":"/2021/12/04/learn-python-001/","content":"\n\n# Learn_python_001 Top K problem\n\n### &#x1F7E7;&#x2753; The problem\n\nTop K question:\n\nè¾“å…¥æ•´æ•°æ•°ç»„ arr ï¼Œæ‰¾å‡ºå…¶ä¸­æœ€å°çš„ k ä¸ªæ•°ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥4ã€5ã€1ã€6ã€2ã€7ã€3ã€8è¿™8ä¸ªæ•°å­—ï¼Œåˆ™æœ€å°çš„4ä¸ªæ•°å­—æ˜¯1ã€2ã€3ã€4ã€‚\n\nç¤ºä¾‹ 1ï¼š\n\nè¾“å…¥ï¼šarr = [3,2,1], k = 2\nè¾“å‡ºï¼š[1,2] æˆ–è€… [2,1]\nç¤ºä¾‹ 2ï¼š\n\nè¾“å…¥ï¼šarr = [0,1,2,1], k = 1\nè¾“å‡ºï¼š[0]\nÂ \né™åˆ¶ï¼š\n\n0 <= k <= arr.length <= 10000\n0 <= arr[i]Â <= 10000\n\næ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰\né“¾æ¥ï¼šhttps://leetcode-cn.com/problems/zui-xiao-de-kge-shu-lcof\nè‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜\n\n### &#x1F4C4; code\n\næœ‰ä¸‰ç§è§£æ³•ï¼Œè§£æ³•äºŒï¼Œä¸‰ï¼Œæ˜¯ç¬¦åˆé¢˜ç›®è¦æ±‚çš„ä¸¤ç§ï¼ˆå› ä¸ºé¢˜ç›®ä¹Ÿè€ƒå¯Ÿäº†æ’åºç®—æ³•ï¼‰ã€‚è¯¦è§£è§https://leetcode-cn.com/problems/zui-xiao-de-kge-shu-lcof/solution/jian-zhi-offer-40-zui-xiao-de-k-ge-shu-j-9yze/\n\n```python\nclass Solution1:\n    def getLeastNumbers(self, arr: List[int], k: int) -> List[int]:\n        lstStd = arr\n        lstStd.sort()\n        res = lstStd[:k]\n        return res\n### solution2:\n### wirte your own quick sort\n### This was taken from https://leetcode-cn.com/problems/zui-xiao-de-kge-shu-lcof/solution/jian-zhi-offer-40-zui-xiao-de-k-ge-shu-j-9yze/\nclass Solution2:\n    def getLeastNumbers(self, arr: List[int], k: int) -> List[int]:\n        def quick_sort(arr, l, r):\n            if l >= r: return\n            i, j = l, r\n            while i < j:\n                while i < j and arr[j] >= arr[l]: j -= 1\n                while i < j and arr[i] <= arr[l]: i += 1\n                arr[i], arr[j] = arr[j], arr[i]\n            arr[l], arr[i] = arr[i], arr[l]\n            quick_sort(arr, l, i - 1)\n            quick_sort(arr, i + 1, r)\n        quick_sort(arr, 0, len(arr) - 1)\n        return arr[:k]\nclass Solution3:\n    def getLeastNumbers(self, arr: List[int], k: int) -> List[int]:\n        if k >= len(arr): return arr\n        def quick_sort(l, r):\n            i, j = l, r\n            while i < j:\n                while i < j and arr[j] >= arr[l]: j -= 1\n                while i < j and arr[i] <= arr[l]: i += 1\n                arr[i], arr[j] = arr[j], arr[i]\n            arr[l], arr[i] = arr[i], arr[l]\n            if k < i: return quick_sort(l, i - 1) \n            if k > i: return quick_sort(i + 1, r)\n            return arr[:k]     \n        return quick_sort(0, len(arr) - 1)\n```\n### &#x1F4cF; æµ‹è¯•\n\næˆ‘ä»¬ç”¨å¦‚ä¸‹ä»£ç æµ‹è¯•ï¼š\n\n```python\n### import require package\nimport numpy as np\nimport random \nimport matplotlib.pyplot as plt\nimport time\nimport seaborn as sns\nfrom typing import List, Dict, Tuple, Sequence\ndef ProgramTime(N,func):\n    lst = [random.randrange(10**7) for n in range(N)]\n    start = time.perf_counter()\n    func(lst,10)\n    runtime = (time.perf_counter() - start)\n    return runtime\nProgramTimeVec = np.vectorize(ProgramTime)\n\n### define theory function\ndef f1(n, k):\n    return k*n\ndef f2(n, k):\n    return k*n*np.log(n)\n\n### plot test curve\nn = np.arange(1, 2000)\ncolors = sns.color_palette(\"Set1\")\n\nplt.plot(n, f1(n, 1e-7), c=colors[0])\nplt.plot(n, f2(n, 1e-7), c=colors[1])\nplt.plot(n, ProgramTimeVec(n,sol1.getLeastNumbers),c=colors[2])\nplt.plot(n, ProgramTimeVec(n,sol2.getLeastNumbers),c=colors[3])\nplt.plot(n, ProgramTimeVec(n,sol3.getLeastNumbers),c=colors[4])\nplt.xlabel('Size of input (n)', fontsize=16)\nplt.ylabel('Time', fontsize=16)\n#plt.legend(['$\\mathcal{O}(n^2)$', '$\\mathcal{O}(n \\log n)$'], loc='best', fontsize=20)\nplt.legend(['$\\mathcal{O}(n)$', '$\\mathcal{O}(n \\log n)$','sol1', 'sol2','sol3'], loc='best', fontsize=20)\nfig = plt.gcf()\nfig.set_size_inches(8, 6)\nplt.savefig(\"../fig/test.png\",dpi=300)\n```\nç»“æœå¦‚ä¸‹, å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨è§£æ³•ä¸‰ï¼Œä¹Ÿå°±æ˜¯åŸºäºå¿«é€Ÿæ’åºçš„æ•°ç»„åˆ’åˆ†ï¼Œå¯ä»¥å®ç°çº¿æ€§æ—¶é—´ï¼š\n\n![figure](https://s3.bmp.ovh/imgs/2021/12/90470f3f3dcdc66c.png)\n","tags":["note","Python"],"categories":["implementation"]},{"title":"Epigenome_track_plot","url":"/2021/10/27/Epigenome-track-plot/","content":"\n# Epigenome track visulalization by R\n\nRecently, I create a new repo to visulizaiton Epigenome track by `ggplot2()` ecosytem. \n\nDetails can be found at https://github.com/Landau1994/PlotEpiTrackByR","tags":["note"],"categories":["genomics"]},{"title":"reading_note_20201206","url":"/2020/12/06/reading-note-20201206/","content":"\t\n  é¢˜ç›®ï¼š[3D] bioRxiv 2020 3D Genome Contributes to Protein-Protein Interactome\n  - ç”Ÿç‰©é—®é¢˜ï¼š3D åŸºå› ç»„çš„ä¸è›‹ç™½è´¨äº’ä½œæ˜¯å¦å­˜åœ¨å…³ç³»ï¼Ÿ\n\t\n  - å®éªŒè®¾è®¡ï¼š\n    \n    - PPIæ•°æ®ï¼šæ”¶é›†ä¸åŒæ•°æ®åº“è›‹ç™½è´¨äº’ä½œæ•°æ®ï¼Œä½œä¸ºæ­£æ ·æœ¬ï¼›ä»ä¸åŒäºšç»†èƒå®šä½çš„éPPIäº’ä½œè›‹ç™½ä¸­æŠ½æ ·ï¼Œä½œä¸ºè´Ÿæ ·æœ¬ï¼›\n\t\t\n    - HiCæ•°æ®ï¼šä¸åŒç»†èƒç³»çš„HiCæ•°æ®ï¼Œé‡‡ç”¨ç›¸åŒæ–¹æ³•é‡æ–°å¤„ç†ï¼Œä½¿å¾—äº’ä½œçŸ©é˜µåˆ†è¾¨ç‡ç›¸åŒï¼›\n\t\t\n    - ä»3DåŸºå› ç»„ä¿¡æ¯ä¸­ï¼Œé‡å»ºåŸºå› çš„ç©ºé—´ä¿¡æ¯ï¼Œé‡‡ç”¨ä¸åŒçš„æœºå™¨å­¦ä¹ æ–¹æ³•é¢„æµ‹PPIæ•°æ®\n\t\n  - åˆ†ææ€è·¯ï¼š\n  \n    - åˆ†ç»„æ¯”è¾ƒPPI gene counterparts ç»„å’Œ Non-PPIç»„çš„åˆ†å¸ƒå›¾ï¼ŒHiCHeatmapï¼ŒGene-gene pair projections of PPIs overlaid on Hi-C heatmaps.ï¼Œå‘ç°äº†PPI gene counterparts åœ¨ç©ºé—´æ›´ä¸ºé‚»è¿‘ï¼›ï¼ˆFigure2,3,4ï¼‰ï¼›\n\t\t\n    - åˆ†æè‡³å°‘ä¸€ä¸ªè›‹ç™½æœ‰ä¿¡å·è‚½çš„PPIï¼ˆSigPep PPIï¼‰ä¸æ— ä¿¡å·è‚½PPI(Non-SigPep PPI)çš„å…³ç³»ï¼Œå¾—åˆ°ç»“è®ºæ˜¯ï¼šâ€œThis can be explained that for the interacting proteins that are brought together by signal peptides, their gene counterparts can be more freely located on the 3D genome, with larger spatial distancesâ€œ\n\t\t\n    - ç”¨3ç»´åŸºå› ç»„çš„ä¿¡æ¯åœ¨ä¸åŒçš„æ¨¡å‹ä¸­é¢„æµ‹PPIï¼Œå‘ç°å¼•å…¥3ç»´åŸºå› ç»„çš„ä¿¡æ¯ä¹‹åï¼Œâ€\n\t\tthe prediction accuracy in terms of AUC can be significantly improved if 3D genome information is employedâ€œï¼ˆTable1)ï¼Œç”±äºæ˜¯é¢„å°æœ¬ï¼Œç‰¹å¾å·¥ç¨‹çš„é‚£ä¸€éƒ¨åˆ†ä½œè€…å¹¶æ²¡æœ‰è¯¦ç»†å†™ï¼›\n- è¯„è®ºï¼š\n    - ç›®å‰æœ‰å¾ˆå¤šç ”ç©¶ç»„è‡´åŠ›äºè§£æ3DåŸºå› ç»„ç»“æ„å’Œç–¾ç—…çš„å…³ç³»ï¼ŒæŠ¥é“äº†ä¸€äº›3DåŸºå› ç»„ç»“æ„æ”¹å˜ï¼Œå½±å“è½¬å½•ï¼Œä»è€Œå½±å“ç–¾ç—…çš„æ¡ˆä¾‹ï¼›æœ¬æ–‡çš„åˆ†æè™½ç„¶ç®€å•ï¼Œä½†æ˜¯ç»™å‡ºäº†3DåŸºå› ç»„ç»“æ„å¯¹äºæ›´ä¸ºä¸‹æ¸¸çš„è›‹ç™½è´¨äº’ä½œæœ‰å½±å“çš„å¯èƒ½æ€§ã€‚ä½†æ˜¯è¿™ç§å¯èƒ½æ€§ï¼Œè¿˜éœ€è¦æ›´ä¸ºsolidçš„æŠ€æœ¯ï¼Œæ•°æ®å’Œåˆ†ææ–¹æ³•æ¥è¯æ˜ï¼›\n\t\t\n    - alphafoldæ˜¯åŸºäºåºåˆ—ä¿¡æ¯æ¥é¢„æµ‹è›‹ç™½è´¨ç»“æ„ï¼Œç›®å‰å·²ç»å–å¾—é‡å¤§çªç ´ã€‚ç›®å‰ä¹Ÿé™†ç»­æœ‰åŸºäºæœºå™¨å­¦ä¹ çš„æ–¹æ³•ï¼Œæ•´åˆä¸åŒåŸºå› ç»„å­¦çš„æ•°æ®è¿›è¡ŒåŠŸèƒ½åŸºå› ç»„å­¦ç ”ç©¶çš„æŠ¥é“ã€‚å¯èƒ½åœ¨æœªæ¥çš„ç ”ç©¶ä¸­ï¼Œç»“åˆå¤šç»„å­¦æ•°æ®ï¼Œåƒalphafoldè¿™æ ·çš„AIæ¡†æ¶ï¼Œæ‰èƒ½å®ç°æ›´ä¸ºæ·±åˆ»çš„è›‹ç™½åŠ¨æ€åŠŸèƒ½çš„é¢„æµ‹ï¼›\n","tags":["note"],"categories":["reference"]},{"title":"mmet 2020 Age-related loss of gene-to-gene transcriptional coordination among single-cells","url":"/2020/12/06/readnote/","content":"\n  + åœ¨HSCä¸­æ²¡æœ‰è§‚å¯Ÿåˆ°cell-cell variationéšç€è¡°è€çš„æ”¹å˜ï¼›For example, despite observations of genetic and epigenteic damage in ageing haematopoietic stem cells(HSCs); cell to cell transcriptional variability is not observed.\n\t\n  + åŸºå› å…±è¡¨è¾¾æ–¹æ³•çš„ç¼ºé™·ï¼š\n  \n    + First, co-expression networks estimates the direct or indirect correlations between pairs of genes, while an individual gene may be controlled by multiple regulators.\n  \n    + Second, each co-expression measure is designed to capture a specific feature that is not necessarily optimal for depicting all types of gene-to-gene transcriptional interrelations ( PCC, linear relatiosnhips)\n  \n    + Third, large calculated coexpresion matrices contain a considerable amount of noise, which raises an additional difficulty in explporing their differentiation across cohorts\n\t\n  + Gcl æœ¬è´¨ä¸Šæ˜¯å¯¹bcdcorrçš„bootstrap.\n\t\n  + ä¸€ä¸ªé‡è¦çš„è§‚å¯Ÿå’Œå»ºè®¾ï¼š\n\t  As an illustration of the coordination measured by the GCL, consider the expression profiles of cells with N genes, that are represented as points in an N-dimensional space. If the gene expression levels are not independent, the set of points do not fill the N- dimensional space but are rather located near lower-dimensional manifold.\n\t\n  + The GCL measures has two main advantages.\n    + The dependency level is defined with respect to a general dependency form, not specific relations ( such as linear)\n    + It can include high-order dependencies between multiple variables\n","tags":["note"],"categories":["reference"]},{"title":"Learn-igraph-More about igraph","url":"/2020/07/29/Learnigraph-2-MoreOnIgraph/","content":"\n\n#### 0. è¯´æ˜\n\næˆ‘ä»¬æ¥ç€è®²æ›´å¤šå…³äºå¯¹igraphå¯¹è±¡çš„æ“ä½œï¼Œå‚è€ƒ[Statistical Network Analysis with\nigraph](https://sites.fas.harvard.edu/~airoldi/pub/books/BookDraft-CsardiNepuszAiroldi2016.pdf)ç¬¬ä¸€ç« ã€‚\n\n#### 1. åˆ›å»ºigraph å¯¹è±¡\n\nä½¿ç”¨ç®¡é“\n\n``` r\nlibrary(igraph)\nlibrary(igraphdata)\nlibrary(magrittr)\nlibrary(tidyverse)\nlibrary(ggraph)\nlibrary(ggnetwork)\n\n\n# Notable graphs\n# make_graph can create some notable graphs. The name of the graph (case insensitive), a character scalar must be suppliced as the edges argument, and other arguments are ignored. (A warning is given is they are specified.)\n# eg.\n# Cubical\n# The Platonic graph of the cube. A convex regular polyhedron with 8 vertices and 12 edges.\ng <- make_graph(\"Cubical\") %>%\n  set_vertex_attr(\"name\",value = LETTERS[1:4])\n\ng  %>%\n  add_layout_(with_fr()) %>%\n  plot()\n```\n\n<img src=\"/figure/posts/Learnigraph-2-MoreOnIgraph_files/figure-gfm/unnamed-chunk-1-1.png\" style=\"display: block; margin: auto;\" />\n\nè¡¥å……ï¼šæ›´ä¸ºå®é™…çš„æ¡ˆä¾‹ä¸­ï¼Œéœ€è¦ä½¿ç”¨æ•°æ®é›†æ¥åˆ›å»ºå›¾ã€‚**igraph**ä½œè€…æä¾›äº†ä¸€äº›æ ¹æ®æ•°æ®é›†åˆ›å»ºå¥½çš„igraphå¯¹è±¡ï¼š\n\n``` r\nlibrary(igraphdata)\n### data:Loads specified data sets, or list the available data sets.\ndata(package=\"igraphdata\")\n# Data sets in package â€˜igraphdataâ€™:\n# \n# Koenigsberg                 Bridges of Koenigsberg from Euler's times\n# UKfaculty                   Friendship network of a UK university faculty\n# USairports                  US airport network, 2010 December\n# enron                       Enron Email Network\n# foodwebs                    A collection of food webs\n# immuno                      Immunoglobulin interaction network\n# karate                      Zachary's karate club network\n# kite                        Krackhardt's kite\n# macaque                     Visuotactile brain areas and connections\n# rfid                        Hospital encounter network data\n# yeast                       Yeast protein interaction network\n```\n\n#### 2. ä½¿ç”¨iraphå¯¹è±¡æŸ¥çœ‹è¾¹å’Œç‚¹çš„ä¿¡æ¯\n\n``` r\n### already\ndata(\"macaque\")\nmacaque\n```\n\n    ## IGRAPH f7130f3 DN-- 45 463 -- \n    ## + attr: Citation (g/c), Author (g/c), shape (v/c), name (v/c)\n    ## + edges from f7130f3 (vertex names):\n    ##  [1] V1 ->V2     V1 ->V3     V1 ->V3A    V1 ->V4     V1 ->V4t    V1 ->MT    \n    ##  [7] V1 ->PO     V1 ->PIP    V2 ->V1     V2 ->V3     V2 ->V3A    V2 ->V4    \n    ## [13] V2 ->V4t    V2 ->VOT    V2 ->VP     V2 ->MT     V2 ->MSTd/p V2 ->MSTl  \n    ## [19] V2 ->PO     V2 ->PIP    V2 ->VIP    V2 ->FST    V2 ->FEF    V3 ->V1    \n    ## [25] V3 ->V2     V3 ->V3A    V3 ->V4     V3 ->V4t    V3 ->MT     V3 ->MSTd/p\n    ## [31] V3 ->PO     V3 ->LIP    V3 ->PIP    V3 ->VIP    V3 ->FST    V3 ->TF    \n    ## [37] V3 ->FEF    V3A->V1     V3A->V2     V3A->V3     V3A->V4     V3A->VP    \n    ## [43] V3A->MT     V3A->MSTd/p V3A->MSTl   V3A->PO     V3A->LIP    V3A->DP    \n    ## + ... omitted several edges\n\nåŸä½œè€…æ˜¯è¿™ä¹ˆè§£é‡Šçš„ï¼š\n\n``` \n\nThis is the standard way of showing (printing) an igraph graph object on\nthe screen. The top line of the output declares that the object is an igraph\ngraph, and also lists its most important properties. A four-character long\ncode is printed first:\n\nâ€˜D/Uâ€™ The first character is either â€˜Dâ€™ or â€˜Uâ€™ and encodes whether the graph\nis directed or undireted.\nâ€˜Nâ€™ The second letter is â€˜Nâ€™ for named graphs (see Section 1.2.5). A dash\nhere means that the graph is not named.\nâ€˜Wâ€™ The third letter is â€˜Wâ€™ if the graph is weighted (in other words, if the\ngraph is a valued graph, Section 2.4). Unweighted graphs have a dash in\nthis position.\nâ€˜Bâ€™ Finally, the fourth is â€˜Bâ€™ if the graph is bipartite (two-mode, Section ??).\nFor unipartite (one-mode) graphs a dash is printed here.\n\nThis notation might seem quite dense at first, but it is easy to get used to and\nconveys much information in a small space. Then two numbers are printed,\nthese are the number of vertices and the number of edges in the graph, 45\nand 463 in our case. At the end of the line the name of the graph is printed,\nif there is any. The next line(s) list attributes, meta-data that belong to the\nvertices, edges or the graph itself. Finally, the edges of the graph are listed.\nExcept for very small graphs, this list is truncated, so that it fits to the screen.\n```\n\nä¸€äº›åŸºæœ¬é‡çš„å±•ç¤ºï¼Œä¹‹å‰è®²è¿‡ï¼Œæ­¤å¤–ï¼Œè¿˜æœ‰æ›´å¤šå…³äºè¾¹çš„æ“ä½œï¼š\n\n``` r\n###|V|\ngorder(macaque)\n###[1] 45\n###|E|\ngsize(macaque)\n###[1] 463\n\nV(macaque)\n# + 45/45 vertices, named, from f7130f3:\n#  [1] V1     V2     V3     V3A    V4     V4t    VOT    VP     MT     MSTd/p MSTl  \n# [12] PO     LIP    PIP    VIP    DP     7a     FST    PITd   PITv   CITd   CITv  \n# [23] AITd   AITv   STPp   STPa   TF     TH     FEF    46     3a     3b     1     \n# [34] 2      5      Ri     SII    7b     4      6      SMA    Ig     Id     35    \n# [45] 36    \nE(macaque)\n# + 463/463 edges from f7130f3 (vertex names):\n#  [1] V1 ->V2     V1 ->V3     V1 ->V3A    V1 ->V4     V1 ->V4t    V1 ->MT    \n#  [7] V1 ->PO     V1 ->PIP    V2 ->V1     V2 ->V3     V2 ->V3A    V2 ->V4    \n# [13] V2 ->V4t    V2 ->VOT    V2 ->VP     V2 ->MT     V2 ->MSTd/p V2 ->MSTl  \n# [19] V2 ->PO     V2 ->PIP    V2 ->VIP    V2 ->FST    V2 ->FEF    V3 ->V1    \n# [25] V3 ->V2     V3 ->V3A    V3 ->V4     V3 ->V4t    V3 ->MT     V3 ->MSTd/p\n# [31] V3 ->PO     V3 ->LIP    V3 ->PIP    V3 ->VIP    V3 ->FST    V3 ->TF    \n# [37] V3 ->FEF    V3A->V1     V3A->V2     V3A->V3     V3A->V4     V3A->VP    \n# [43] V3A->MT     V3A->MSTd/p V3A->MSTl   V3A->PO     V3A->LIP    V3A->DP    \n# [49] V3A->FST    V3A->FEF    V4 ->V1     V4 ->V2     V4 ->V3     V4 ->V3A   \n# [55] V4 ->V4t    V4 ->VOT    V4 ->VP     V4 ->MT     V4 ->LIP    V4 ->PIP   \n# + ... omitted several edges\n\nmacaque %>% ends(\"V1|V2\")\n# \n#      [,1] [,2]\n# [1,] \"V1\" \"V2\"\n\nmacaque %>% tail_of(\"V1|V2\")\n# + 1/45 vertex, named, from f7130f3:\n# [1] V1\n\nmacaque %>% head_of(\"V1|V2\")\n# + 1/45 vertex, named, from f7130f3:\n# [1] V2\n\nmacaque %>% neighbors(\"V1\",mode = \"out\")\n\n# + 8/45 vertices, named, from f7130f3:\n# [1] V2  V3  V3A V4  V4t MT  PO  PIP\n\nmacaque %>% neighbors(\"V1\",mode = \"in\")\n\n# + 8/45 vertices, named, from f7130f3:\n# [1] V2  V3  V3A V4  V4t MT  PO  PIP\n\nE(macaque)[.from(\"V1\")]\n```\n\n#### 3\\. å­å›¾\n\nåˆ›å»ºå­å›¾\n\n``` r\nV(macaque)[\"V1\",\"V2\",.nei(\"V1\"),.nei(\"V2\")] %>%\n  induced_subgraph(graph = macaque) %>%\n  summary()\n```\n\n    ## IGRAPH cb88d15 DN-- 16 156 -- \n    ## + attr: Citation (g/c), Author (g/c), shape (v/c), name (v/c)\n\nè¿é€š\n\n``` r\nis_connected(macaque,mode = \"weak\")\n```\n\n    ## [1] TRUE\n\n``` r\nis_connected(macaque,mode = \"strong\")\n```\n\n    ## [1] TRUE\n\nè¾¹å’Œç‚¹çš„ç­›é€‰ï¼š\n\n``` r\nV(macaque)[1:4]\n# + 4/45 vertices, named, from f7130f3:\n# [1] V1  V2  V3  V3A\nV(macaque)[c(\"V1\",\"V2\",\"V3\",\"V3A\")]\n# + 4/45 vertices, named, from f7130f3:\n# [1] V1  V2  V3  V3\n```\n\nå»ºç«‹è¾¹æˆ–è€…ç‚¹çš„ç´¢å¼•å‘é‡ï¼š\n\n``` r\nE(macaque)[1:10] %>% as_ids()\n# [1] \"V1|V2\"  \"V1|V3\"  \"V1|V3A\" \"V1|V4\"  \"V1|V4t\" \"V1|MT\"  \"V1|PO\"  \"V1|PIP\"\n#  [9] \"V2|V1\"  \"V2|V3\" \nV(macaque)[1:10] %>% as_ids()\n # [1] \"V1\"     \"V2\"     \"V3\"     \"V3A\"    \"V4\"     \"V4t\"    \"VOT\"    \"VP\"    \n # [9] \"MT\"     \"MSTd/p\"\n```\n\nç±»ä¼¼äºç®—æ•°æ“ä½œï¼Œå…³äºç‚¹çš„æ“ä½œæ±‡æ€»ï¼š\n\n``` r\ndata(\"kite\")\nV(kite)\n# + 10/10 vertices, named, from 6b7ddad:\n#  [1] A B C D E F G H I J\nV(kite)[1:3,7:10]\n# + 7/10 vertices, named, from 6b7ddad:\n# [1] A B C G H I J\nV(kite)[degree(kite) < 2]\n# + 1/10 vertex, named, from 6b7ddad:\n# [1] J\nV(kite)[.nei(\"D\")]\n# + 6/10 vertices, named, from 6b7ddad:\n# [1] A B C E F G\nV(kite)[.innei(\"D\")]\n# + 6/10 vertices, named, from 6b7ddad:\n# [1] A B C E F G\nV(kite)[.outnei(\"D\")]\n# + 6/10 vertices, named, from 6b7ddad:\n# [1] A B C E F G\nV(kite)[.inc(\"A|D\")]\n# + 2/10 vertices, named, from 6b7ddad:\n# [1] A D\nc(V(kite)[\"A\"],V(kite)[\"D\"])\n# + 2/10 vertices, named, from 6b7ddad:\n# [1] A D\nrev(V(kite))\n# + 10/10 vertices, named, from 6b7ddad:\n#  [1] J I H G F E D C B A\nunique(V(kite)[\"A\",\"A\",\"C\",\"C\"])\n# + 2/10 vertices, named, from 6b7ddad:\n# [1] A C\n\n### Set operation\n\nunion(V(kite)[1:5],v(kite)[6:10])\n# + 2/10 vertices, named, from 6b7ddad:\n# [1] A C\nintersection(V(kite)[1:7],V(kite)[5:10])\n# + 3/10 vertices, named, from 6b7ddad:\n# [1] E F G\ndifference(V(kite),V(kite)[1:5])\n# + 5/10 vertices, named, from 6b7ddad:\n# [1] F G H I J\n\n\nE(kite)\n# + 18/18 edges from 6b7ddad (vertex names):\n#  [1] A--B A--C A--D A--F B--D B--E B--G C--D C--F D--E D--F D--G E--G F--G F--H G--H\n# [17] H--I I--J\n\nE(kite,path = c(\"A\",\"D\",\"C\"))\n# + 2/18 edges from 6b7ddad (vertex names):\n# [1] A--D C--D\n\nE(kite)[ V(kite)[1:2] %--%  V(kite)[3:4] ]\n# + 3/18 edges from 6b7ddad (vertex names):\n# [1] A--C A--D B--D\n\nE(kite)[1:3,7:10]\n# + 7/18 edges from 6b7ddad (vertex names):\n# [1] A--B A--C A--D B--G C--D C--F D--E\n\nE(kite)[seq_len(gsize(kite))[seq_len(gsize(kite)) %%2 == 0]]\n# + 9/18 edges from 6b7ddad (vertex names):\n# [1] A--C A--F B--E C--D D--E D--G F--G G--H I--J\n\nE(kite)[seq_len(gsize(kite)) %%2 == 0]\n# + 9/18 edges from 6b7ddad (vertex names):\n# [1] A--C A--F B--E C--D D--E D--G F--G G--H I--J\n\nE(kite)[seq_len(gsize(kite)) %%2]\n\n# + 9/18 edges from 6b7ddad (vertex names):\n# [1] A--B A--B A--B A--B A--B A--B A--B A--B A--B\n\nE(kite)[.inc(\"D\")]\n# + 6/18 edges from 6b7ddad (vertex names):\n# [1] A--D B--D C--D D--E D--F D--G\n\nE(macaque)[.from(\"V1\")]\n# + 8/463 edges from f7130f3 (vertex names):\n# [1] V1->V2  V1->V3  V1->V3A V1->V4  V1->V4t V1->MT  V1->PO  V1->PIP\nE(macaque)[.to(\"V1\")]\n# + 8/463 edges from f7130f3 (vertex names):\n# [1] V2 ->V1 V3 ->V1 V3A->V1 V4 ->V1 V4t->V1 MT ->V1 PO ->V1 PIP->V1\n\n### The remains are same as Vertices operations\n```\n","tags":["Graph","Network"],"categories":["implementation"]},{"title":"LearnSeurat_Intergrate","url":"/2020/05/27/LearnSeurat-Intergrate/","content":"\n\n### 0. è¯´æ˜\n\næ›´ä¸ºè¯¦ç»†çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒSeuratå®˜æ–¹æ•™ç¨‹ï¼Œæˆ–è€…[Seuratè¿›è¡Œå•ç»†èƒRNA-seqæ•°æ®æ•´åˆ](https://blog.mrdoge.cool/index.php/2020/02/28/seurat_integration/)ã€‚\n\n### 1. å¿«é€Ÿè¿›è¡Œ\n\nå®é™…åˆ†æä¸­ï¼Œå¦‚æœç»†èƒæ•°ç›®å¾ˆå¤šçš„è¯ï¼Œè¿›è¡Œæ•´åˆåˆ†æçš„æ—¶å€™å°±ä¼šå¾ˆæ…¢ï¼Œä¸€ç§æ–¹å¼æ˜¯å°†ä»»åŠ¡æäº¤é€šè¿‡å‘½ä»¤è¡Œæäº¤åˆ°æœåŠ¡å™¨æˆ–è€…é›†ç¾¤ä¸Šè¿è¡Œï¼Œå¹¶è¾“å‡ºã€‚\n\nä¼ é€’å‘½ä»¤è¡Œçš„å‚æ•°çš„è„šæœ¬å¯ä»¥è¿™ä¹ˆå†™ï¼š\n\n```R\n    #### reference base Integration\n    .libPaths(\"/home/user/lib/R/library\")\n    library(Seurat)\n    \n    args = commandArgs(trailingOnly=TRUE)\n    # test if there is at least one argument: if not, return an error\n    if (length(args)==0) {\n      stop(\"At least one argument must be supplied (input file).n\", call.=FALSE)\n    } \n    \n    ###args[1] seu.list.rds\n    ###args[2] seu.intergrated.rds\n    ###args[3] UMAPplot.pdf\n    \n    ## program...\n    seu.list <- readRDS(file = args[1])\n    \n    for (i in names(seu.list)) {\n      seu.list[[i]] <- SCTransform(seu.list[[i]], verbose = FALSE)\n    }\n    seu.list.features <- SelectIntegrationFeatures(object.list = seu.list, \n                                                   nfeatures = 3000)\n    seu.list <- PrepSCTIntegration(object.list = seu.list, \n                                   anchor.features = seu.list.features)\n    \n    reference_dataset <- 1\n    names(seu.list)[1]\n    \n    seu.list.anchors <- FindIntegrationAnchors(object.list = seu.list, \n                                               normalization.method = \"SCT\", \n                                               anchor.features = seu.list.features, \n                                               reference = reference_dataset)\n    \n    seu.list.integrated <- IntegrateData(anchorset = seu.list.anchors, \n                                         normalization.method = \"SCT\")\n    \n    seu.list.integrated <- RunPCA(object = seu.list.integrated, verbose = FALSE)\n    seu.list.integrated <- RunUMAP(object = seu.list.integrated, umap.method = \"umap-learn\",\n                                   dims = 1:30)\n    saveRDS(seu.list.integrated,file = args[2])\n    \n    #### show Integrated result\n    plots <- DimPlot(seu.list.integrated, \n                     group.by = c(\"orig.ident\", \"cell.type\"))\n    plots & theme(legend.position = \"top\") & \n      guides(color = guide_legend(nrow = 4, byrow = TRUE, \n                                  override.aes = list(size = 2.5)))\n    ggsave(filename = args[3],width = 12,height = 6)\n```\n\nå°†å…¶å‘½åä¸º`Integrated_ref_based.R`\n\nç„¶ååœ¨ç»ˆç«¯è¾“å…¥`nohup Rscript Integrated_ref_based.R seu.list.rds\nseu.intergrated.rds UMAPplot.pdf > log.txt &`æäº¤å³å¯ï¼›\n\n### 2. è¯„è®º\n\nå½“ç„¶ï¼Œè¿™ä¸ªè„šæœ¬è¯»è€…è¿˜å¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚åŠ ä»¥å®Œå–„ã€‚\n","tags":["R","scRNA-seq"],"categories":["implementation"]},{"title":"å¦‚ä½•å®šä¹‰ç»†èƒç±»å‹","url":"/2020/05/16/å¦‚ä½•å®šä¹‰ç»†èƒç±»å‹/","content":"\nç”Ÿç‰©å­¦å®¶çš„ä¼ ç»Ÿè‰ºèƒ½æ˜¯è¿›è¡Œåˆ†ç±»ï¼Œå³ä½¿åœ¨è¿›å…¥äº†21ä¸–çºªï¼Œç ”ç©¶çš„å°ºåº¦å’Œç ”ç©¶çš„æ‰‹æ®µå’Œæ—å¥ˆå·²ç»æœ‰äº†å¾ˆå¤§çš„ä¸åŒï¼Œä½†æ˜¯åˆ†ç±»è¿™ä¸ªå¤è€çš„é—®é¢˜ä¾ç„¶æ˜¯ä¼—å¤šç”Ÿç‰©ç ”ç©¶é¢†åŸŸçš„åŸºç¡€ã€‚ä½œä¸ºåˆ†ç±»è¿™ä¸ªå¤§é—®é¢˜ä¸­çš„å­é—®é¢˜ï¼Œç»†èƒç±»å‹çš„é‰´å®šæ˜¯å½“å‰ç»†èƒç”Ÿç‰©å­¦ç ”ç©¶çš„ä¸€ä¸ªåŸºç¡€é—®é¢˜å’Œå‰æ²¿é—®é¢˜ã€‚\n\næ¯”å¦‚å‘è‚²ç”Ÿç‰©å­¦å’Œå¹²ç»†èƒç”Ÿç‰©å­¦çš„ç ”ç©¶ï¼Œç¡®å®šç»†èƒçš„è°±ç³»æ˜¯ç ”ç©¶ç»†èƒå‘½è¿å†³å®šå› ç´ ç­‰åŸºç¡€ç ”ç©¶ä»¥åŠç›¸å…³ä¸´åºŠè½¬åŒ–çš„åŸºç¡€ã€‚è¿™ä¸ªåŸºç¡€æœ‰å¤šé‡è¦çš„å‘¢ï¼Œå‡å¦‚æŸä¸ªå¤§ç‰›å£°ç§°è‡ªå·±å‘ç°äº†æŸç§ç¥å¥‡çš„ç»†èƒï¼Œè¿™ä¸ªç»†èƒå¯ä»¥å¸¦æ¥åŒ»å­¦é©å‘½ï¼Œç„¶è€Œè¿™ç§ç±»å‹çš„ç»†èƒå¾ˆå¯èƒ½å°±ä¸å­˜åœ¨ï¼Œæ‰€ä¸ºçš„å¸¦æ¥é©å‘½çš„å®£ä¼ éƒ½æ˜¯å¿½æ‚ å’Œéª—å±€,åŸºäºè¿™ç§ç±»å‹çš„ç»†èƒçš„ç ”ç©¶éƒ½æ˜¯å»ºåœ¨æ²™å­ä¸Šçš„é«˜æ¥¼å¤§å¦ã€‚ä»¥ä¸Šä¸æ˜¯æˆ‘ä»¬çš„æƒ³è±¡ï¼Œè€Œæ˜¯ç¡®å®å‘ç”Ÿçš„ç°å®æ¡ˆä¾‹[å“ˆä½›å¤§å­¦ç”±äºå¿ƒè‚Œå¹²ç»†èƒä¸å­˜åœ¨è€Œå¤§é‡æ’¤ç¨¿ï¼Œå›½å†…æ‰€æœ‰é˜³æ€§æŒ‡æ ‡è®ºæ–‡æ˜¯å¦éƒ½æ¶‰å«Œé€ å‡ï¼Ÿ](https://www.zhihu.com/question/298711327)\n\næœ€è¿‘ï¼ŒCell Stem Cellæ‚å¿—ä¸Šå‘è¡¨äº†ä¸€ç¯‡[ç»¼è¿°](https://linkinghub.elsevier.com/retrieve/pii/S1934-5909(20)30137-5)ï¼Œé˜è¿°äº†ç»†èƒèº«ä»½(Cellular Identity)ç ”ç©¶çš„ç›®çš„ï¼Œä»¥åŠåŸºäºé«˜é€šé‡æµ‹åºï¼ˆç‰¹åˆ«æ˜¯å•ç»†èƒæµ‹åºï¼‰ï¼Œæˆåƒä»¥åŠé—ä¼ å­¦ç­‰æ–°æ–¹æ³•æ¥ç¡®å®šç»†èƒèº«ä»½çš„æ–¹æ³•ã€‚\n\nåœ¨ä½œè€…çœ‹æ¥ï¼Œç»†èƒç±»å‹é‰´å®šç ”ç©¶çš„ç›®çš„åˆ†ä¸ºä¸‰æ¡ï¼šï¼ˆå›¾ç‰‡å’Œå¼•ç”¨çš„è¯å‡æ¥è‡ªäºæ–‡çŒ®ï¼‰\n\n> (1) Detecting features assoicated with a cell type from a pre-defined list of candidates;\n> \n> (2) Identifying new features and cell types through unbiased approaches;\n> \n> (3) Defining Cellular Relationships\n\nä»åŸç†ä¸Šï¼Œé‰´å®šç»†èƒèº«ä»½çš„ä¸åŒfeatureå¯ä»¥æ¦‚æ‹¬å¦‚ä¸‹ï¼š\n\n![Figure 1. Defining Cell Types](https://imgkr.cn-bj.ufileos.com/38ef9067-49cf-4781-bcf9-9d413ce0d476.png)\n\næŸä¸ªç»†èƒç±»å‹çš„featureå¯ä»¥å¦‚ä½•ç ”ç©¶å‘¢ï¼Œè§ä¸‹ï¼š\n\n![Figure 2. Strategies to Detect Molecular Features Associated with a Cell Type](https://imgkr.cn-bj.ufileos.com/b4350e21-1b8f-44d1-bb4f-7484f6b65a0a.png)\n\nä¸åŒç±»å‹ä¹‹é—´çš„ç»†èƒä¹‹é—´çš„å…³ç³»çš„ç ”ç©¶è§ä¸‹ï¼š\n\n![Figure 3. Strategies to Define Cellular Relationships](https://imgkr.cn-bj.ufileos.com/d01f185b-b288-46b1-b860-348dbd91e01e.png)\n\nå½“ç„¶åŒä¸€ç±»å‹çš„ç»†èƒåœ¨ä¸åŒç»„ç»‡æˆ–è€…ç”Ÿç†æ¡ä»¶ä¸‹ä¼šå‘ˆç°ä¸åŒçš„åŠŸèƒ½ã€‚\n\n![Figure 4. Cellular Functions Vary with Context](https://imgkr.cn-bj.ufileos.com/a7c9ab59-a271-4686-8738-db98cea163ec.png)\n\nè®¨è®ºéƒ¨åˆ†æœ€å–œæ¬¢çš„ä¸€æ®µè¯æ˜¯ï¼š\n> Together, our rapidly expanding capability to detect features and functions are revealing that \"cell type\" that were percevied as monolithic and stable in fact represent composites of multiple cells with distinguishable molecular signatures and have teh capability to adopt new features and functions in new contexts\n\næ›´å¤šå†…å®¹è¯·é˜…è¯»åŸæ–‡ã€‚","tags":["note","scRNA-seq","sc-seq","cell biology"],"categories":["reference"]},{"title":"Learn-SciBet","url":"/2020/05/15/Learn-scibet/","content":"\n\n### 1. èƒŒæ™¯ä»‹ç»\n\nç»†èƒç±»å‹æ³¨é‡Šæ˜¯scRNA-seqé‡Œéå¸¸åŸºç¡€çš„ä¸€æ­¥ï¼Œå¸¸è§çš„ç­–ç•¥æ˜¯å°†åŸºäºæ— ç›‘ç£åˆ†ç¾¤ç»“æœçš„åŸºå› å·®å¼‚è¡¨è¾¾åˆ†æç»“æœä½œä¸ºmarker,ç»“åˆå…ˆéªŒçŸ¥è¯†ï¼Œåˆ¤æ–­è¯¥åˆ†ç¾¤ä¸ºä½•ç§ç±»å‹ã€‚\n\nè¿‘å¹´æ¥ï¼Œéšç€scRNA-seqçš„æ•°æ®é›†çš„é€æ¸ç§¯ç´¯ï¼Œä¹Ÿæœ‰å¾ˆå¤šç ”ç©¶ç»„æå‡ºäº†ä¸€äº›åŸºäºå·²æœ‰åˆ†ç¾¤ç»“æœè¿›è¡Œæœ‰ç›‘ç£çš„ç»†èƒç±»å‹æ³¨é‡Šçš„æ–¹æ³•ï¼Œæ¯”å¦‚`scmap`ï¼Œæˆ–è€…Seuraté‡Œçš„`TransferData`ã€‚æ­¤å¤–ï¼Œä¹Ÿæœ‰[è¯„ä¼°ç›¸å…³æ–¹æ³•çš„benchmarkç ”ç©¶](https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1795-z)ï¼š\n\n![](https://media.springernature.com/full/springer-static/image/art%3A10.1186%2Fs13059-019-1795-z/MediaObjects/13059_2019_1795_Fig1_HTML.png)\n\n[SciBet](http://scibet.cancer-pku.cn/)æ˜¯å¼ æ³½æ°‘è€å¸ˆç»„æœ€è¿‘æ–°å‘è¡¨çš„ä¸€ä¸ªå¿«æ·ï¼ˆå®æµ‹çœŸçš„æ¯”Seuratçš„`TransferData`å¿«ï¼Œè€Œä¸”æ•ˆæœç¡®å®å·®ä¸å¤šï¼‰ï¼Œæ–¹ä¾¿çš„è¿›è¡Œæœ‰ç›‘ç£çš„ç»†èƒç±»å‹æ³¨é‡Šçš„æ–¹æ³•ã€‚è®ºæ–‡è§[SciBet as a portable and fast single cell type identifier](https://www.nature.com/articles/s41467-020-15523-2)ï¼Œç›¸å…³æŠ¥é“è§[Nature Communications | å¼ æ³½æ°‘è¯¾é¢˜ç»„å‘è¡¨å•ç»†èƒè½¬å½•ç»„æ•°æ®å¿«é€Ÿæ³¨é‡Šæ–°æ–¹æ³•](https://mp.weixin.qq.com/s/5Nmvzyk3_t9-eOawHZ-uGQ)\n\n### 2. æ–¹æ³•åŸç†ç®€ä»‹\n\nå¦‚æœè¯»è€…åªå¯¹è½¯ä»¶ä½¿ç”¨æ„Ÿå…´è¶£çš„æœ¬èŠ‚å¯ä»¥ç•¥è¿‡ã€‚\n\næ ¹æ®ä¸Šé¢æåˆ°çš„é‚£ç¯‡[æŠ¥é“](https://mp.weixin.qq.com/s/5Nmvzyk3_t9-eOawHZ-uGQ)ï¼Œå¦‚æœç”¨ä¸€å¥è¯æ¦‚æ‹¬SciBetçš„åŸç†ï¼Œåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š\n\n> å¼ æ³½æ°‘å®éªŒå®¤çš„åšå£«ç”Ÿæè¾°å¨ã€åˆ˜å®ç³è”åˆä»»ä»™æ–‡å‰¯ç ”ç©¶å‘˜å¼€å‘çš„SciBetåˆ™æœ‰æ•ˆåœ°è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼šä»–ä»¬ä»â€œåŒä¸€ç±»å‹çš„å•ç»†èƒè¡¨è¾¾è°±æœä»åŒä¸€å¤šé¡¹åˆ†å¸ƒâ€è¿™ä¸€åŸºæœ¬å‡è®¾å‡ºå‘ï¼Œå¯¹è®­ç»ƒé›†æ•°æ®ä¸­ä¸åŒç»†èƒç±»å‹åˆ†åˆ«è¿›è¡Œå»ºæ¨¡ï¼Œè¿›è€Œé€šè¿‡æå¤§ä¼¼ç„¶ä¼°è®¡æ¥å¯¹æµ‹è¯•é›†ç»†èƒè¿›è¡Œæœ‰ç›‘ç£æ³¨é‡Šã€‚\n\næ¥ä¸‹æ¥æˆ‘ä»¬æ ¹æ®ä½œè€…è®ºæ–‡çš„æ–¹æ³•éƒ¨åˆ†å’Œè¡¥å……ææ–™ï¼Œå­¦ä¹ ä¸€ä¸‹è¿™ä¸ªå·§å¦™åœ°æ€è·¯ã€‚åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š\n\n+ é¢„å¤‡çŸ¥è¯†\n+ å•ç»†èƒè¡¨è¾¾è°±çš„ç»Ÿè®¡æ¨¡å‹\n+ æ ¹æ®è¡¨è¾¾è°±è®¡ç®—ä¿¡æ¯ç†µ\n+ E-test\n+ æ„å»ºæœ‰ç›‘ç£çš„ç»†èƒç±»å‹åˆ†ç±»æ¨¡å‹\n\næˆ‘ä»¬å‡å®šè¯»è€…å·²ç»ä¿®è¿‡æ¦‚ç‡è®ºç­‰ç›¸å…³è¯¾ç¨‹ã€‚\n\n#### 2.1 é¢„å¤‡çŸ¥è¯†\n\n\né¢„å¤‡çŸ¥è¯†1ï¼š\n\næˆ‘ä»¬éœ€è¦å‘è¯»è€…å›é¡¾å…³äºè´ŸäºŒé¡¹åˆ†å¸ƒçš„çŸ¥è¯†ï¼Œå¦‚æœä¸€ä¸ªç¦»æ•£éšæœºå˜é‡$Y$çš„pmf(probability mass function)ä¸º:\n\n$$ P(Y=y) = {y+r-1 \\choose y}p^r(1-p)^{y},y=0,1,\\dots,r=1,2,\\dots$$\n\né‚£ä¹ˆæˆ‘ä»¬ç§°å…¶æœä»è´ŸäºŒé¡¹åˆ†å¸ƒã€‚è®°ä¸º$Y \\sim NB(r,p)$ã€‚\n\né¢„å¤‡çŸ¥è¯†2ï¼š\n\nå¯¹äºä¸¤ä¸ªéšæœºå˜é‡$X$å’Œ$Y$ï¼Œåœ¨ç»™å®š$X=x$ä¸‹ï¼ŒYçš„æ¡ä»¶pmfä¸ºï¼š\n\n$$P(Y=y|X=x)=\\frac{P(X=x,Y=y)}{P(X=x)}$$\n\né¢„å¤‡çŸ¥è¯†3ï¼š\n\nå…³äºè´ŸäºŒé¡¹åˆ†å¸ƒï¼Œæœ‰å¦‚ä¸‹ç»“è®ºï¼š\n\n> å¯¹äºéšæœºå˜é‡$Y,\\Lambda$ï¼Œè‹¥$Y|\\Lambda \\sim Poisson(\\Lambda), \\Lambda \\sim Gamma(\\alpha,\\beta)$, åˆ™ $Y \\sim NB(r=\\alpha,p=\\frac{\\beta}{1+\\beta})$\nå…¶ä¸­\n> $$ Poisson(Y=y;\\Lambda=\\lambda) = \\frac{e^{-\\lambda}\\lambda^y}{y!},y \\ge 0,  y\\in N $$\n> $$ Gamma(\\Lambda=\\lambda;a,b)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}e^{-\\beta\\lambda},\\lambda>0,\\alpha >0,\\beta >0 $$\n> $$ \\int_{0}^{\\infty}\\lambda^{\\alpha-1}e^{-\\beta\\lambda}d\\lambda=\\frac{\\Gamma(\\alpha)}{\\beta^{\\alpha}} $$\n\nè¯æ˜ï¼š\n\nå› ä¸ºï¼š\n\n$$\\begin{aligned}\n  P(Y=y) \n  &=\\int_{0}^{\\infty}P(Y=y,\\Lambda=\\lambda)d\\lambda \\\\\n  &=\\int_{0}^{\\infty}P(Y=y|\\Lambda=\\lambda)P(\\Lambda=\\lambda)d\\lambda \\\\\n  &=\\int_{0}^{\\infty}\\frac{e^{-\\lambda}\\lambda^y}{y!}\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}e^{-\\beta\\lambda}d\\lambda \\\\\n  &=\\frac{\\beta^{\\alpha}}{y!\\Gamma(\\alpha)}\\int_{0}^{\\infty}\\lambda^{(y+\\alpha)-1}e^{-(1+\\beta)\\lambda}d\\lambda \\\\\n  &= \\frac{\\beta^{\\alpha}}{y!\\Gamma(\\alpha)}\\frac{\\Gamma(y+\\alpha)}{(1+\\beta)^{y+\\alpha}}\\\\\n  &={y+\\alpha-1 \\choose y}(\\frac{\\beta}{1+\\beta})^{\\alpha}(\\frac{1}{1+\\beta})^{y}\n\\end{aligned}\n$$\næ‰€ä»¥ $Y \\sim NB(r=\\alpha,p=\\frac{\\beta}{1+\\beta})$\n\næ ¹æ®é¢„å¤‡çŸ¥è¯†3ï¼Œæˆ‘ä»¬æœ‰ï¼š\n\né¢„å¤‡çŸ¥è¯†4ï¼š\n\n> è´ŸäºŒé¡¹åˆ†å¸ƒæ˜¯æ³Šæ¾åˆ†å¸ƒå’Œä¼½é©¬åˆ†å¸ƒçš„æ··åˆåˆ†å¸ƒã€‚\n\né¢„å¤‡çŸ¥è¯†5(è¯¥ç»“è®ºä¸ºæ¦‚ç‡è®ºå’Œæ•°ç†ç»Ÿè®¡çš„å¸¸è¯†)ï¼š\n\n> å¯¹äºéšæœºå˜é‡çš„pdfä¸º$f_X(x)$ï¼Œåšå˜æ¢$Y=g(X)$,å…¶ä¸­$g$ä¸ºå•è°ƒå‡½æ•°ï¼ŒXå’ŒYå„è‡ªæ ·æœ¬ç©ºé—´çš„$\\mathcal{X}$å’Œ$\\mathcal{Y}$åˆ†åˆ«æ»¡è¶³ï¼š\n> $$\\mathcal{X}=\\{x|f_X(x)>0\\},\\mathcal{Y}=\\{y|y=g(x),x\\in\\mathcal{X} \\}$$\n> è‹¥$f_X(x)$åœ¨$\\mathcal{X}$ä¸­è¿ç»­ä¸”é€†å˜æ¢$g^{-1}(x)$åœ¨$\\mathcal{Y}$ä¸­è¿ç»­å¯å¾®ï¼Œåˆ™æ–°çš„éšæœºå˜é‡$Y$çš„pdfä¸ºï¼š\n> $$ f_Y(y) =\\begin{cases} f_X(g^{-1}(y))|\\frac{d}{dy}g^{-1}(y)|,y\\in\\mathcal{Y} \\\\ 0, otherwise \\end{cases} $$ \n\nè¯¥ç»“è®ºä¸ºStatistical Inference(Casella Bergerè‘—)ä¸­çš„å®šç†2.1.5ï¼Œè¯æ˜è§è¯¥ä¹¦ã€‚\n\né¢„å¤‡çŸ¥è¯†6ï¼ˆåªæœ‰è¿™ä¸ªç»“è®ºä½œè€…åœ¨è¡¥å……ææ–™é‡Œç»™äº†è¯æ˜ï¼‰ï¼š\n\n> **The scaling property of the Gamma distribution**\n> \n> è‹¥ $X \\sim Gamma(\\alpha,\\beta)$, åˆ™$Y=kX \\sim Gamma(\\alpha,\\frac{\\beta}{k}),k>0$\n\nè¯æ˜: ç”±é¢˜è®¾ï¼š\n\n$$ f_X(x;\\alpha,\\beta)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}x^{\\alpha-1}e^{-\\beta x},\\alpha >0,\\beta >0 , x>0$$\n\næ ¹æ®é¢˜è®¾ï¼Œç”±é¢„å¤‡çŸ¥è¯†5,æœ‰ï¼š\n\n$$ \\begin{aligned}f_Y(y) &= f_X(g^{-1}(y))|\\frac{d}{dy}g^{-1}(y)| \\\\ &= f_X(y/k)|\\frac{d}{dy}(y/k)| \\\\ &=\\frac{1}{\\Gamma(\\alpha)\\beta^{\\alpha}}(\\frac{y}{k})^{\\alpha-1}e^{-\\frac{\\beta}{k}y}\\frac{1}{k} \\\\ &= \\frac{1}{\\Gamma(\\alpha)(k\\beta)^{\\alpha}}x^{\\alpha-1}e^{-\\frac{\\beta}{k}y} \\end{aligned} $$\n\næ•…$Y \\sim  Gamma(\\alpha,\\frac{\\beta}{k})$\n\né¢„å¤‡çŸ¥è¯†6ï¼š\n\n> è‹¥ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬$X_1,\\dots,X_n$æœä»$X_i \\sim Poisson(\\lambda)$, ä¸”è§‚æµ‹å€¼åˆ†åˆ«ä¸º$x_1,\\dots,x_n$ï¼Œåˆ™å‚æ•°$\\lambda$çš„çŸ©ä¼°è®¡é‡å’Œæå¤§ä¼¼ç„¶ä¼°è®¡é‡ç›¸ç­‰ï¼Œå‡ä¸º$\\bar{x}=\\frac{1}{n}\\sum_{i=1}^nx_i$\n\nè¯æ˜å¾ˆç®€å•ï¼Œåœ¨å¾ˆå¤šæ•™æä¹Ÿèƒ½æ‰¾åˆ°ï¼Œæ•…ä»ç•¥ã€‚\n\né¢„å¤‡çŸ¥è¯†7ï¼š\n\n> è‹¥ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬$X_1,\\dots,X_n$æœä»$X_i \\sim Gamma(\\alpha,\\beta)$, ä¸”è§‚æµ‹å€¼åˆ†åˆ«ä¸º$x_1,\\dots,x_n$ï¼Œåˆ™å‚æ•°$\\alpha,\\beta$çš„æå¤§ä¼¼ç„¶ä¼°è®¡æ»¡è¶³ï¼š\n> $$ \\hat{\\beta}=\\frac{\\hat{\\alpha}}{\\bar{x}},\\bar{x}=\\frac{1}{n}\\sum_{i=1}^nx_i $$\n\n\n\nè¯æ˜ï¼š\n\nç”±é¢˜è®¾ï¼š\n\n$$f_{X_i}(x_i;\\alpha,\\beta)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}x_{i}^{\\alpha-1}e^{-\\beta x_i}$$\n\næ•…å–å¯¹æ•°åæå¤§ä¼¼ç„¶å‡½æ•°ä¸ºï¼š\n\n$$ \\begin{aligned}l(\\alpha,\\beta) &=\\ln L(\\alpha,\\beta) \\\\ &= \\ln \\prod_{i=1}^{n} \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}x_{i}^{\\alpha-1}e^{-\\beta x_i} \\\\ &=n(\\alpha\\ln\\beta-\\ln\\Gamma(\\alpha))+(\\alpha-1)\\sum_{i=1}^{n}\\ln x_i - \\beta\\sum_{i=1}^{n}x_i \\end{aligned}$$\n\nç”± \n$$ \\frac{\\partial}{\\partial\\beta}l(\\hat{\\alpha},\\beta) = 0$$\n\nè§£å¾— $\\hat{\\beta}=\\frac{\\hat{\\alpha}}{\\bar{x}}$\n\né¢„å¤‡çŸ¥è¯†8ï¼š\n\n> è‹¥éšæœºå˜é‡$X$çš„pdfä¸º$f_X(x)$,æ ·æœ¬ç©ºé—´ä¸º$\\mathcal{X}$, å®šä¹‰`information generating function`:\n> $$ T(u)=\\int_{\\mathcal{X}}f_{X}^{u}(x)dx $$\n> åˆ™ï¼š\n> $$H(X)=-T^\\prime(1)$$\n\nè¯æ˜ï¼š(ä¸¥æ ¼è¯æ˜çš„è¯ï¼Œå¾—è¦è€ƒè™‘å‡½æ•°$f_X(x)$å’Œ$\\mathcal{X}$æœ¬èº«çš„æ€§è´¨ï¼Œæˆ‘ä»¬è¿™é‡Œå‡å®šå®ƒä»¬å¯ä»¥æ»¡è¶³ç§¯åˆ†å·ä¸‹æ±‚å¯¼ï¼Œå¦‚æœè¦ä¸¥æ ¼çš„è¯ï¼Œè¯·å‚è€ƒæµ‹åº¦è®ºç›¸å…³æ•™æ)\n\n$$ \\begin{aligned}\\frac{d}{du}T(u &)=\\frac{d}{du}\\int_{\\mathcal{X}}f_{X}^{u}(x)dx \\\\ &=\\int_{\\mathcal{X}}\\frac{d}{du}e^{u\\ln f_X(x) }dx \\\\ &=\\int_{\\mathcal{X}}f_{X}^{u}(x)\\ln f_{X}(x)dx  \\end{aligned}$$\n\nè€Œéšæœºå˜é‡$X$çš„ä¿¡æ¯ç†µçš„å®šä¹‰ä¸ºï¼š\n\n$$ H(X)=-\\int_{\\mathcal{X}} f_{X}(x)\\ln f_{X}(x)dx$$\n\næ•…$H(X)=-T^\\prime(1)$\n\né¢„å¤‡çŸ¥è¯†9ï¼š\n\n> è‹¥$X\\sim Gamma(\\alpha,\\beta)$ï¼Œåˆ™å…¶ä¿¡æ¯ç†µ$S$ä¸º\n> \n> $S=\\alpha-\\ln\\beta+\\ln\\Gamma(\\alpha)+(1-\\alpha)\\psi(\\alpha),\\psi=\\frac{\\Gamma^{\\prime}(a)}{\\Gamma(a)}$\n\nç”±é¢„å¤‡çŸ¥è¯†8ç»è¿‡è®¡ç®—å³å¯è¯æ˜ï¼Œä»ç•¥ã€‚\n\né¢„å¤‡çŸ¥è¯†10ï¼š\n\n> [å¤šé¡¹åˆ†å¸ƒ](https://zhuanlan.zhihu.com/p/52481385)\n\n\n\næ³¨ï¼šæ›´å¤šå…³äºä¼½é©¬åˆ†å¸ƒçš„çŸ¥è¯†å¯è§ï¼š[ç†è§£Gammaåˆ†å¸ƒã€Betaåˆ†å¸ƒä¸Dirichletåˆ†å¸ƒ](https://zhuanlan.zhihu.com/p/37976562)\n\n\n#### 2.2 å•ç»†èƒè¡¨è¾¾è°±çš„ç»Ÿè®¡æ¨¡å‹\n\nç»è¿‡å¤§é‡çš„ç»Ÿè®¡åˆ†æå’Œåç»­çš„å®éªŒéªŒè¯ï¼ˆç›¸å…³è¯æ®å¯å‚è€ƒè¿™ç¯‡[æ–‡çŒ®](https://www.nature.com/articles/nmeth.2930)ï¼‰æœ‰è¿™æ ·ä¸€ä¸ªç»éªŒæ€§çš„ç»“è®ºï¼š\n\n**è§‚å¯Ÿåˆ°å•ç»†èƒåŸºå› è¡¨è¾¾çš„count(æ¯”å¦‚UMI count)çš„åˆ†å¸ƒå¯ä»¥ç”¨è´ŸäºŒé¡¹åˆ†å¸ƒå¾ˆå¥½çš„æ‹Ÿåˆ,ä¸”ç›¸åŒç»†èƒç±»å‹çš„å•ç»†èƒè¡¨è¾¾è°±æœä»åŒä¸€ä¸ªåˆ†å¸ƒã€‚**\n\nç»“åˆ2.1ä¸­çš„é¢„å¤‡çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥å°†å•ç»†èƒåŸºå› è¡¨è¾¾çš„countè¡¨ç¤ºä¸ºæ³Šæ¾åˆ†å¸ƒçš„ä¼½é©¬åˆ†å¸ƒçš„æ··åˆåˆ†å¸ƒã€‚æ‰€ä»¥ä½œè€…å‚è€ƒäº†[SAVER](https://www.nature.com/articles/s41592-018-0033-z)å¯ä»¥è¿›è¡Œå¦‚ä¸‹å»ºæ¨¡ï¼š\n\nå‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰$C$ä¸ªç»†èƒï¼Œ$m$ä¸ªåŸºå› çš„åŸå§‹è¡¨è¾¾è°±æ•°æ®ï¼Œé‡Œé¢çš„æ•°å€¼ä¸ºreads countæˆ–è€…æ˜¯UMI countã€‚å¦‚æœæˆ‘ä»¬è®°è§‚å¯Ÿå¾—åˆ°ç»†èƒcçš„æŸä¸ªåŸºå› içš„UMI countä¸º$Z_{ic},i=1,\\dots,m,c=1,\\dots,C$ï¼Œé‚£ä¹ˆå¯¹äºåŒä¸€ç±»å‹çš„ç»†èƒè€Œè¨€ï¼Œæœ‰ï¼š\n\n$$ Z_{ic} \\sim Poisson(\\lambda_is_c), \\lambda_i \\sim Gamma(\\alpha_i,\\beta_i) $$\n\nå…¶ä¸­$\\lambda_i$è¡¨ç¤ºåŸºå› $i$åœ¨ç»†èƒ$c$ä¸­çš„çœŸå®è¡¨è¾¾é‡ï¼Œ$s_c=\\sum_{c}Z_{ic}$è¡¨ç¤ºè¿™ä¸ªç»†èƒä¸­çš„UMIæ€»æ•°ï¼Œä¸æµ‹åºæ·±åº¦æœ‰å…³ã€‚è€Œ$\\alpha_i,\\beta_i$åˆ™æ˜¯ä¸¤ä¸ªå‚æ•°è¡¨å¾æŸä¸ªç»†èƒç±»å‹ä¸­çš„åŸºå› çš„çœŸå®è¡¨è¾¾åˆ†å¸ƒçš„å‚æ•°ã€‚\n\næ¥ä¸‹æ¥çš„å¯ä»¥æ ¹æ®é¢„å¤‡çŸ¥è¯†é‡Œçš„ç»“è®ºè¿›è¡Œå‚æ•°ä¼°è®¡ï¼š\n\nç”±é¢„å¤‡çŸ¥è¯†6ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¾—åˆ°$\\lambda_{ic}=\\frac{Z_ic}{s_c}$è¿™ä¹Ÿä¸ºæˆ‘ä»¬å¸¸ç”¨çš„è¿›è¡Œnormalizedçš„ç­–ç•¥æä¾›äº†ä¸€ç§ä¾æ®ã€‚è€Œç”±é¢„å¤‡çŸ¥è¯†7ï¼Œæœ‰$\\hat{\\beta_i}=\\frac{\\alpha_i}{E(\\lambda_i)},E(\\lambda_i)=\\frac{1}{C}\\sum_{c}\\lambda_{ic}$ã€‚\n\n\n#### 2.3 æ ¹æ®è¡¨è¾¾æ•°æ®è®¡ç®—ä¿¡æ¯ç†µ\n\nä¸æ˜¯æ‰€æœ‰çš„åŸºå› éƒ½æ˜¯å¯¹åç»­çš„ç»Ÿè®¡å­¦ä¹ æœ‰ç”¨çš„ï¼Œéœ€è¦è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‘é€‰å‡ºé‚£äº›èƒ½è¡¨ç¤ºä¸åŒç¾¤ç»†èƒä¹‹é—´è¡¨è¾¾å·®å¼‚çš„åŸºå› ã€‚æœ¬æ–‡çš„æ–°æ„æ˜¯åŸºäºä¿¡æ¯ç†µ(ä¹Ÿå°±æ˜¯é¦™å†œç†µ)çš„æ¦‚å¿µå¼•å…¥äº†æ–°çš„è¿›è¡Œç‰¹å¾é€‰æ‹©çš„æ–¹æ³•ï¼šE-testã€‚åœ¨è®²E-testä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çœ‹çœ‹ä½œè€…æ˜¯å¦‚ä½•å®ç°ä»è¡¨è¾¾é‡ä¸­è®¡ç®—ä¿¡æ¯ç†µçš„ã€‚\n\næ ¹æ®2.2æˆ‘ä»¬çŸ¥é“å¯ä»¥å°†è§‚æµ‹å¾—åˆ°å•ç»†èƒè¡¨è¾¾gene count$Z_{ic}$è¡¨ç¤ºæˆ$Z_{ic}$ä¸çœŸå®è¡¨è¾¾é‡$\\lambda_{ic}$çš„æ··åˆåˆ†å¸ƒï¼ŒçœŸæ­£èƒ½åæ˜ ä¸åŒç»†èƒä¹‹é—´è¡¨è¾¾å·®å¼‚çš„æ˜¯$\\lambda_{ic}$çš„åˆ†å¸ƒã€‚æ‰€ä»¥æ¥ä¸‹æ¥è¦è®¡ç®—$\\lambda_{ic}$çš„åˆ†å¸ƒçš„ä¿¡æ¯ç†µã€‚\n\nå¯¹äºç›¸åŒç±»å‹çš„ç»†èƒè€Œè¨€ï¼Œæ ¹æ®2.1ä¸­çš„ç»“è®º9ï¼ŒçœŸå®è¡¨è¾¾é‡$\\lambda_i$çš„ä¿¡æ¯ç†µä¸ºï¼š\n\n$$ S_i = \\alpha_i - \\ln\\beta_i + \\ln\\Gamma(\\alpha_i)+(1-\\alpha_i)\\psi(\\alpha_i) \\tag{1}$$\n\nç”¨$\\hat{\\beta_i}=\\frac{\\alpha_i}{E(\\lambda_i)}$ä»£å…¥ï¼ˆ1ï¼‰å¯å¾—ï¼š\n\n$$ S_i = \\alpha_i - \\ln \\alpha_i + \\ln E(\\lambda_i) + \\ln\\Gamma(\\alpha_i)+(1-\\alpha_i)\\psi(\\alpha_i) \\tag{2} $$\n\nè®°ï¼š\n$$ h_i(\\alpha_i) = \\alpha_i - \\ln \\alpha_i  + \\ln\\Gamma(\\alpha_i)+(1-\\alpha_i)\\psi(\\alpha_i) \\tag{3} $$\n\n\nå¹¶ä¸”è®°$C$ä¸ªç»†èƒçš„å¹³å‡normalizedè¡¨è¾¾é‡ä¸º$X_i$, æ˜¾ç„¶æœ‰$X_i=E(\\lambda_i)=\\frac{1}{C}\\sum_{c}\\lambda_{ic}$\n\næ ¹æ®ä¸Šè¿°è®°å·ï¼Œï¼ˆ1ï¼‰æœ€ç»ˆåŒ–ç®€ä¸ºï¼š\n\n$$ S_i = \\ln E(\\lambda_i)+h_i = \\ln X_i + h_i \\tag{4} $$\n\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è€ƒè™‘é“ä¸åŒçš„ç»†èƒç±»å‹ã€‚è‹¥ç»†èƒ$c,c=1,\\dots,C_j$å±äºç»†èƒç±»å‹$j$ï¼Œå®šä¹‰æ‰€æœ‰å±äº$j$çš„ç»†èƒçš„å¹³å‡æ ‡å‡†åŒ–çš„è¡¨è¾¾é‡ä¸º$X_{ij}=\\frac{1}{C_j}\\sum_{c\\in j}\\lambda_{ic}$ï¼Œæ ¹æ®ä¸Šé¢çš„ç»“è®ºï¼Œå¯å¾—ï¼š\n\n$$ S_{ij} = \\ln X_{ij} + h_{ij} \\tag{5}$$\n\nå…¶ä¸­\n\n$$ h_{ij}=\\alpha_{ij}-\\ln\\alpha_{ij}+\\ln\\Gamma(\\alpha_{ij})+(1-\\alpha_{ij})\\psi(\\alpha_{ij}) \\tag{6} $$\n\n$X_{ij}$æ˜¯ç›´æ¥å¯ä»¥é€šè¿‡å®éªŒæ•°æ®è®¡ç®—çš„ï¼Œè€Œ$h_{ij}$åˆ™éœ€è¦ä¼°è®¡ã€‚ä½œè€…å‡è®¾$h_{ij}$æ˜¯åªæ˜¯åŸºå› ç‰¹å¼‚çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯$h_{ij}=h_i$ã€‚ç†ç”±å¦‚ä¸‹ï¼š\n\nè‹¥$\\lambda_{i,c \\in j}$ä¸ºéšæœºå˜é‡$\\lambda_{ij}\\sim\\Gamma(\\alpha_{ij},\\beta_{ij})$çš„è§‚æµ‹å€¼ï¼Œå¦‚æœæˆ‘ä»¬è®°åŸºå› $i$ä»ç»†èƒç±»å‹$j$åˆ°ç»†èƒç±»å‹$j^\\prime$çš„è¡¨è¾¾é‡çš„fold changeä¸º$F_{i,j\\rightarrow j^{\\prime}}$, å¹¶ä¸”å‡è®¾$\\lambda_{ij^{\\prime}}=F_{i,j\\rightarrow j^{\\prime}}\\lambda_{ij}$ï¼Œé‚£ä¹ˆç”±2.1ä¸­çš„é¢„å¤‡çŸ¥è¯†6ï¼Œå¯çŸ¥ $\\lambda_{ij^{\\prime}}\\sim\\Gamma(\\alpha_{ij},\\frac{\\beta_{ij}}{F_{i,j\\rightarrow j^{\\prime}}})$ã€‚\næ•…$\\alpha_{ij}=\\alpha_i$, ç»“åˆï¼ˆ6ï¼‰ï¼Œ$h_{ij}=h_i$\n\næœ€ç»ˆï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°\n\n $$ S_{ij}=\\ln X_{ij}+h_{i} \\tag{7} $$\n\n#### 2.4 E-test\n\né¦–å…ˆï¼Œé›¶å‡è®¾ä¸ºæ‰€æœ‰ä¸åŒç±»å‹ç»†èƒéƒ½æ˜¯ä»åŒä¸€ä¸ªç»†èƒç±»å‹ï¼ˆè®°ä¸º group 0ï¼‰ä¸­å‡åŒ€éšæœºé‡‡æ ·ï¼Œé‚£ä¹ˆåŸºå› çš„å¹³å‡è¡¨è¾¾é‡ä¸º$X_{i0}=\\frac{1}{n}\\sum_{j=1}^nX_{ij}= AM_i$, åˆ™group 0 çš„ä¿¡æ¯ç†µå¯ä»¥è®¡ç®—ä¸ºï¼š\n\n$$ S_{i0} = \\ln X_{i0}+h_i  \\tag{8}$$\n\næ¥ç€è®¡ç®—åŸºå› $i$åœ¨æ‰€æœ‰ç»†èƒç±»å‹$j$ä¸­ä¸group 0 çš„ä¿¡æ¯ç†µçš„å·®ä¹‹å’Œï¼š\n\n(8)-(7)å¹¶æ±‚å’Œï¼Œå¾—ï¼š\n\n$$ \\begin{aligned}\n  \\Delta S_i &= \\sum_{j=1}^{n}(S_{i0}-S_{ij}) \\\\\n  & = \\sum_{j=1}^n(\\ln X_{i0}-\\ln X_{ij}) \\\\\n  & = n(\\ln X_{i0}-\\frac{1}{n}\\ln \\prod_{j=n}^nX_{ij}) \\\\\n  & = n\\ln\\frac{AM_i}{GM_i}\n\\end{aligned} $$\n\nå…¶ä¸­$GM_i=(\\prod_{j=n}^nX_{ij})^{\\frac{1}{n}}$\n\nåˆ©ç”¨Jesenä¸ç­‰å¼å¯ä»¥è¯æ˜$GM_i\\le AM_i$ï¼Œæ•…$\\Delta S \\ge 0$\n\nè‹¥è¦è¿›è¡Œå‡è®¾æ£€éªŒï¼Œè¿˜éœ€è¦è®¡ç®—$\\Delta S$çš„æ˜¾è‘—æ€§ï¼Œä½œè€…çš„ç­–ç•¥æ˜¯åŸºäºç½®æ¢æ£€éªŒçš„ï¼š\n\nè‹¥æ‰€æœ‰é¢„å…ˆå®šä¹‰åˆ†ç¾¤çš„ç»†èƒç±»å‹çš„ç»†èƒå‡æ¥è‡ªåŒä¸€ä¸ªæ ·æœ¬ï¼Œåˆ™å¯¹ä»»æ„çš„æ ‡ç­¾ä¸ºç»†èƒç±»å‹$j$çš„ç»†èƒçš„size-factor normalizedçš„è¡¨è¾¾é‡$X_{ij}=\\frac{1}{C_j}\\sum_{c\\in j}\\lambda_{ic}$ï¼Œæ ¹æ®ä¸­å¿ƒæé™å®šç†ï¼Œå•ç»†èƒæ•°ç›®è¶³å¤Ÿå¤šçš„æ—¶å€™ï¼Œ$X_{ij} \\sim N(\\mu_i,\\sigma_i)$ï¼Œå¾ˆå®¹æ˜“å¾—åˆ°å‚æ•°çš„æ— åä¼°è®¡$\\hat{\\mu_i}=X_{i0},\\hat{\\sigma}_i=\\frac{1}{n-1}\\sum_{j=1}^n(X_{ij}-\\hat{\\mu_i})^2$ï¼Œæ‰€ä»¥ç½®æ¢è¢«ç®€åŒ–æˆäº†æ¯æ¬¡ä»åˆ†å¸ƒ$N(\\hat{\\mu_i},\\hat{\\sigma_i})$nä¸ªä¸åŒçš„éšæœºæ•°$X_{i}$ã€‚æ¥ä¸‹æ¥å°±æ˜¯è¿™ä¹ˆç”Ÿæˆä¸€ä¸ª$\\Delta S$çš„åˆ†å¸ƒï¼Œç„¶åè®¡ç®—è¿™ä¸ªåˆ†å¸ƒä¸­å¤§äºä»çœŸå®æ•°æ®ä¸­æµ‹å¾—çš„$\\Delta S$æ¯”ä¾‹ï¼Œä½œä¸ºæ˜¾è‘—æ€§ã€‚\n\né»˜è®¤çš„Featureä¸º500ä¸ªåŸºå› ã€‚\n\n#### 2.5 æ„å»ºæœ‰ç›‘ç£å­¦ä¹ çš„æ¨¡å‹\n\næ ¹æ®2.4ï¼Œåœ¨è®­ç»ƒé›†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œç‰¹å¾é€‰æ‹©é€‰å‡ºä¸€äº›â€œinformative geneâ€è¿›è¡Œæ¨¡å‹è®­ç»ƒã€‚\n\nä½œè€…å‡è®¾ä»ç›¸åŒçš„è½¬å½•å‡ºçš„mRNAæ˜¯ä¸å¯åŒºåˆ†çš„ï¼Œè€Œä¸”æ¯ä¸ªmRNAçš„äº§ç”Ÿæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè®°å½•å¯¹äºç»†èƒç±»å‹ä¸º$j$çš„ç»†èƒï¼ŒåŸºå› $i$äº§ç”Ÿä¸€ä¸ªmRNAçš„æ¦‚ç‡ä¸º$p_{ij}$,è‹¥æœ‰$m$ä¸ªinformative gene åˆ™å¯¹ç»†èƒç±»å‹$j$,æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªéšæœºå‘é‡$\\boldsymbol{p}_j= (p_{1j},\\cdots,p_{mj} )$å…¶ä¸­$\\sum_{i}p_{ij}=1$ä¸”å…¶æœä»å¤šé¡¹å¼åˆ†å¸ƒ,åˆ™ å¯¹äºå±äºç»†èƒç±»å‹$j$çš„ç»†èƒ$y$ï¼Œå…¶åéªŒè¡¨è¾¾è°±$y=(y_1,\\dots,y_n)$å¯ä»¥è®¡ç®—ä¸ºï¼š\n\n$$ P(y|j)=\\frac{(\\sum_{i}y_i)!}{\\prod_{i}(y_i!)}\\prod_i(p_{ij}^{y_i}) $$\n\nå…¶ä¸­æ¦‚ç‡$p_{ij}$å¯ä¼°è®¡ä¸º$\\hat{p_{ij}}=\\frac{1+X_{ij}}{\\sum_{i}(1+X_{ij})}$\n\nåŒæ ·çš„ï¼Œåœ¨æµ‹è¯•é›†ä¸­ï¼ŒæœªçŸ¥ç»†èƒç±»å‹çš„ç»†èƒ$y$å±äºç»†èƒç±»å‹$j$çš„æ¦‚ç‡ä¹Ÿä¸º\n\n$$ P(y|j)=\\frac{(\\sum_{i}y_i)!}{\\prod_{i}(y_i!)}\\prod_i(p_{ij}^{y_i}) $$\n\nå…¶ä¸­$p_{ij}$æ˜¯è®­ç»ƒé›†ä¸­å­¦ä¹ åˆ°çš„å‚æ•°ã€‚\n\nå¦‚æœï¼Œæˆ‘ä»¬å¼•å…¥$q_i=\\frac{y_i}{\\sum_i y_i}$,ç”±æå¤§ä¼¼ç„¶çš„åŸåˆ™å¯çŸ¥ï¼Œç»†èƒ$y$æœ€æœ‰å¯èƒ½çš„ç»†èƒç±»å‹$\\hat{j}$ä¸º\n\n$$ \\begin{aligned}\\hat{j} &= \\argmax_{j}(P(y|j)) \\\\ &= \\argmax_{j}(\\frac{(\\sum_{i}y_i)!}{\\prod_{i}(y_i!)}\\prod_{i}(p_{ij}^{y_i})) \\\\\n&=\\argmax_{j}(\\prod_{i}(p_{ij}^{y_i}) \\\\\n&=\\argmax_{j}(y_i\\ln p_{ij}) \\\\\n&=\\argmax_{j}(\\frac{y_i}{\\sum_{i}y_i}\\ln p_{ij}-q_i\\ln q_i) \\\\\n&=\\argmax_{j}(p_i\\ln p_{ij}-q_i\\ln q_i) \\\\\n&=\\argmax_{j}D_{KL}(q||p_j) \\end{aligned}$$\n\n#### 2.6 æ–¹æ³•æ€»ç»“\n\nå¯ä»¥ç”¨åŸæ–‡çŒ®ä¸­çš„æµå›¾å¯¹SciBetè¿›è¡Œæ€»ç»“ï¼š\n\n![](https://imgkr.cn-bj.ufileos.com/6c7712b3-9058-4a8d-a4ed-f32414601e4b.png)\n\n\n\n### 3. è½¯ä»¶ä½¿ç”¨\n\n#### 3.1 åœ¨çº¿ç‰ˆ\n\nåœ¨çº¿ç‰ˆä½¿ç”¨è¯·æŒ‰ç…§[å®˜ç½‘](http://scibet.cancer-pku.cn/)çš„[Online classification](http://scibet.cancer-pku.cn/download_references.html)æ•™ç¨‹ã€‚\n\nå€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½œè€…æä¾›äº†å¾ˆä»ä¸åŒç»„ç»‡ï¼Œä¸åŒå®éªŒæ¡ä»¶çš„å•ç»†èƒæµ‹åºæ•°æ®ä¸­è®­ç»ƒå¥½çš„Signatureï¼š\n\n![](https://imgkr.cn-bj.ufileos.com/bf56b36c-df96-49bb-af81-2e9118331e96.png)\n\nè¿™äº›ä¸åŒçš„signatureå¯ä»¥ä¾›ä¸åŒç ”ç©¶è€…ç»“åˆè‡ªå·±çš„å…´è¶£ä½¿ç”¨ã€‚\n\n#### 3.2 æœ¬åœ°ç‰ˆ\n\n##### 3.2.1 å®‰è£…\n\n```R\nif (!requireNamespace(\"devtools\", quietly = TRUE)) install.packages(\"devtools\")\ndevtools::install_github(\"PaulingLiu/scibet\")\n```\nå¦‚æœå‡ºç°é”™è¯¯ï¼Œè¯·çœ‹ç›¸å…³[issue](https://github.com/PaulingLiu/scibet/issues/1)\n\n##### 3.2.2 ä½œè€…æä¾›çš„æµ‹è¯•æ•°æ®\n\næŒ‰ç…§å®˜ç½‘çš„æ•™ç¨‹[E-test and SciBet](http://scibet.cancer-pku.cn/document.html)ï¼›ä¸‹è½½æ‰€éœ€çš„æ•°æ®ï¼›ç„¶ååæŒ‰ç…§å…¶è¯´æ˜æ–‡æ¡£è¿›è¡Œå³å¯ã€‚\n\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹å¦‚ä½•ç”¨ä½¿ç”¨SciBetç»“åˆSeuratè¿›è¡Œå•ç»†èƒåˆ†æã€‚\n\n##### 3.2.3 SciBetç»“åˆSeurat\n\nä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œæˆ‘ä»¬é€‰æ‹©Seuratè‡ªå¸¦çš„pbmcscaæ•°æ®é›†, è¯¥æ•°æ®é›†å·²ç»æä¾›äº†é¢„å…ˆå®šä¹‰å¥½çš„ç»†èƒæ ‡ç­¾ï¼Œä»£ç å¦‚ä¸‹ï¼š\n\n\n```r\nlibrary(Seurat)\nlibrary(pbmcsca.SeuratData)\nlibrary(ggplot2)\nlibrary(scibet)\nlibrary(tidyverse)\nlibrary(viridis)\n\n####0.---define utilized function--------\n####---Export expr data from 10x to tibble----\n#' @param seuv3 a seuv3 object \n#' \nmyGetExpr <- function(seuv3,...){\n\texpr <- GetAssayData(object = seuv3, slot = \"data\")\n\texpr <- as_tibble(t(as.matrix(expr)),rownames = NA)\n\treturn(expr)\n}\n\n###1.load data and preprocessing\ndata(\"pbmcsca\")\n###---avoid warning-----\npbmcsca <- UpdateSeuratObject(pbmcsca)\n###---show predifined cell type------\ntable(pbmcsca$CellType)\n```\n\n```\n# B cell              CD14+ monocyte \n# 5020                        5550 \n# CD16+ monocyte                 CD4+ T cell \n# 804                        7391 \n# Cytotoxic T cell              Dendritic cell \n# 9071                         433 \n# Megakaryocyte         Natural killer cell \n# 977                        1565 \n# Plasmacytoid dendritic cell                  Unassigned \n# 164                          46 \n```\n\n\n```r\n###---split data-----\npbmc.list <- SplitObject(pbmcsca, split.by = \"Method\")\n###---normalize-------\nfor (i in names(pbmc.list)) {\n\tpbmc.list[[i]] <- NormalizeData(pbmc.list[[i]], verbose = FALSE)\n}\nnames(pbmc.list)\n```\n\n```\n[1] \"Smart-seq2\"          \"CEL-Seq2\"            \"10x Chromium (v2) A\"\n[4] \"10x Chromium (v2) B\" \"10x Chromium (v3)\"   \"Drop-seq\"           \n[7] \"Seq-Well\"            \"inDrops\"             \"10x Chromium (v2)\"  \n```\næµ‹è¯• reference baseæ¨¡å¼çš„æ•ˆæœ\n\n```r\n###----2. test scibet----\n###----define reference and query-----\nreference <- pbmc.list[[1]]\nquery <- pbmc.list[[2]]\n\n\n###----test query reference mode----\nreference.expr <- myGetExpr(reference)\nquery.expr <- myGetExpr(query)\n\n\nreference.label <- as.character(reference$CellType)\ntest.label <- as.character(query$CellType)\n\nreference.expr <- cbind(reference.expr,label=reference.label)\n\nprd.label <- SciBet(train = reference.expr, test = query.expr)\nConfusion_heatmap(test.label, prd.label)\nggsave(filename = \"res/fig/learn_scibet_confusionheatmap_refmode.pdf\",\n\t   width = 6,height = 6)\n```\n\n![](https://imgkr.cn-bj.ufileos.com/a81d21b1-edf6-46a9-b46b-26afc649fc11.png)\n\nå‡†ç¡®ç‡ä¸º\n\n```r\nnum1 <- length(test.label)\nnum2 <- tibble(\n\tori = test.label,\n\tprd = prd.label\n) %>%\n\tdplyr::filter(ori == prd) %>%\n\tnrow(.)\n\nnum2/num1\n```\n\n```\n0.851711\n```\n\næµ‹è¯•ç”¨ä½œè€…æä¾›çš„è®­ç»ƒå¥½çš„æ¨¡å‹\n\n```r\n###----test load_model mode-----\n\n###using 30 major cell types signature----\n\nmodel <- readr::read_csv(file = \"http://scibet.cancer-pku.cn/major_human_cell_types.csv\")\nmodel <- pro.core(model)\n\nprd <- LoadModel(model)\nprd.label <- prd(query.expr)\n\nConfusion_heatmap(test.label,prd.label)\nggsave(filename = \"res/fig/learn_scibet_confusionheatmap_signaturemode.pdf\",\n\t   width = 6,height = 6)\n\n```\n\n![](https://imgkr.cn-bj.ufileos.com/ff705079-0b71-4114-8e2e-c8508fc02adb.png)","tags":["note","scRNA-seq"],"categories":["genomics"]},{"title":"LearnSeurat_PBMC3k","url":"/2020/05/10/LearnSeurat-PBMC3k/","content":"\n\næœ¬ç³»åˆ—å‡å®šè¯»è€…å¯¹äºå•ç»†èƒæµ‹åºçš„æ•°æ®åˆ†æå’ŒSeuratçš„å®˜æ–¹æ•™ç¨‹æœ‰æ‰€äº†è§£ã€‚\n\næœ¬ç¯‡ç ”ç©¶æœ€åŸºç¡€çš„PBMC3kã€‚å…¶å®è¿™é‡Œåªæœ‰2700ä¸ªå¤–å‘¨è¡€çš„ç»†èƒã€‚æ³¨æ„åˆ°ï¼Œç”±äºå–æ ·æ˜¯å¤–å‘¨è¡€ï¼Œæ²¡æœ‰å¹²ç»†èƒçš„å­˜åœ¨ï¼Œæ‰€ä»¥å¯ä»¥è®¤ä¸ºæ ·å“å¤„äºç¨³æ€ã€‚è¿™ä¸ªæ•™ç¨‹å°±æ˜¯è®²ç¨³æ€ä¸‹çš„å•ç»†èƒæµ‹åºåˆ†ææ˜¯å¦‚ä½•è¿›è¡Œçš„ã€‚Seuratçš„å®˜æ–¹æ•™ç¨‹çš„ç¼ºç‚¹ä¹‹ä¸€å°±æ˜¯æ²¡æœ‰æ¶‰åŠåŠ¨æ€è¿‡ç¨‹çš„å•ç»†èƒåˆ†æå¦‚ä½•è¿›è¡Œã€‚\n\nå¦‚æ— ç‰¹æ®Šè¯´æ˜ï¼Œæœ¬ç³»åˆ—çš„ä»£ç å‡å¯ä»¥åœ¨è‡ªå·±çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šè¿è¡Œï¼›\n\n### 1. æ„å»ºSeurat object\n\nä½¿ç”¨ä½œè€…å·²ç»æ„å»ºå¥½çš„æ•°æ®è¿›è¡Œæ„å»ºã€‚å…³äºSeuratæ›´è¯¦ç»†çš„æ–‡æ¡£å¯è§[satijalabçš„wiki](https://github.com/satijalab/seurat/wiki)\n\n``` r\nlibrary(Seurat)\nlibrary(SeuratData)\nlibrary(ggplot2)\nlibrary(igraph)\nlibrary(tidyverse)\nlibrary(patchwork)\n### AvailableData() check avaliable data: we choose cbmc\n### InstallData('pbmc3k')\nlibrary(pbmc3k.SeuratData)\n\n### how this dataset generate?\n# ## Not run: \n# if (requireNamespace(Seurat, quietly = TRUE)) {\n#   url <- 'http://cf.10xgenomics.com/samples/cell-exp/1.1.0/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz'\n#   curl::curl_download(url = url, destfile = basename(path = url))\n#   untar(tarfile = basename(path = url))\n#   pbmc.data <- Seurat::Read10X(data.dir = 'filtered_gene_bc_matrices/hg19/')\n#   pbmc3k <- Seurat::CreateSeuratObject(counts = pbmc.data, project = 'pbmc3k', min.cells = 3, min.features = 200)\n#   # Annotations come from Seurat's PBMC3k Guided Clustering Tutorial\n#   # https://satijalab.org/seurat/v3.0/pbmc3k_tutorial.html\n#   annotations <- readRDS(file = system.file('extdata/annotations/annotations.Rds', package = 'pbmc3k.SeuratData'))\n#   pbmc3k <- Seurat::AddMetaData(object = pbmc3k, metadata = annotations)\n#   # Clean up downloaded files\n#   file.remove(basename(path = url))\n#   unlink(x = 'filtered_gene_bc_matrices/', recursive = TRUE)\n# }\n# \n# ## End(Not run)\n\n### how Create Seurat object work?\n### by run `Seurat::CreateSeuratObject` you can get the source function\n# ## Not run:\n# Seurat::CreateSeuratObject\n# function (counts, project = \"SeuratProject\", assay = \"RNA\", \n#     min.cells = 0, min.features = 0, names.field = 1, names.delim = \"_\", \n#     meta.data = NULL) \n# {\n#     if (!is.null(x = meta.data)) {\n#         if (is.null(x = rownames(x = meta.data))) {\n#             stop(\"Row names not set in metadata. Please ensure that rownames of metadata match column names of data matrix\")\n#         }\n#         if (length(x = setdiff(x = rownames(x = meta.data), y = colnames(x = counts)))) {\n#             warning(\"Some cells in meta.data not present in provided counts matrix.\")\n#             meta.data <- meta.data[intersect(x = rownames(x = meta.data), \n#                 y = colnames(x = counts)), ]\n#         }\n#         if (is.data.frame(x = meta.data)) {\n#             new.meta.data <- data.frame(row.names = colnames(x = counts))\n#             for (ii in 1:ncol(x = meta.data)) {\n#                 new.meta.data[rownames(x = meta.data), colnames(x = meta.data)[ii]] <- meta.data[, \n#                   ii, drop = FALSE]\n#             }\n#             meta.data <- new.meta.data\n#         }\n#     }\n#     assay.data <- CreateAssayObject(counts = counts, min.cells = min.cells, \n#         min.features = min.features)\n#     Key(object = assay.data) <- paste0(tolower(x = assay), \"_\")\n#     assay.list <- list(assay.data)\n#     names(x = assay.list) <- assay\n#     init.meta.data <- data.frame(row.names = colnames(x = assay.list[[assay]]))\n#     idents <- factor(x = unlist(x = lapply(X = colnames(x = assay.data), \n#         FUN = ExtractField, field = names.field, delim = names.delim)))\n#     if (any(is.na(x = idents))) {\n#         warning(\"Input parameters result in NA values for initial cell identities. Setting all initial idents to the project name\")\n#     }\n#     ident.levels <- length(x = unique(x = idents))\n#     if (ident.levels > 100 || ident.levels == 0 || ident.levels == \n#         length(x = idents)) {\n#         idents <- rep.int(x = factor(x = project), times = ncol(x = assay.data))\n#     }\n#     names(x = idents) <- colnames(x = assay.data)\n#     object <- new(Class = \"Seurat\", assays = assay.list, \n#         meta.data = init.meta.data, active.assay = assay, active.ident = idents, \n#         project.name = project, version = packageVersion(pkg = \"Seurat\"))\n#     object[[\"orig.ident\"]] <- idents\n#     n.calc <- CalcN(object = assay.data)\n#     if (!is.null(x = n.calc)) {\n#         names(x = n.calc) <- paste(names(x = n.calc), assay, \n#             sep = \"_\")\n#         object[[names(x = n.calc)]] <- n.calc\n#     }\n#     if (!is.null(x = meta.data)) {\n#         object <- AddMetaData(object = object, metadata = meta.data)\n#     }\n#     return(object)\n# }\n# \n# Seurat:: CreateAssayObject\n# function (counts, data, min.cells = 0, min.features = 0) \n# {\n#     if (missing(x = counts) && missing(x = data)) {\n#         stop(\"Must provide either 'counts' or 'data'\")\n#     }\n#     else if (!missing(x = counts) && !missing(x = data)) {\n#         stop(\"Either 'counts' or 'data' must be missing; both cannot be provided\")\n#     }\n#     else if (!missing(x = counts)) {\n#         if (anyDuplicated(rownames(x = counts))) {\n#             warning(\"Non-unique features (rownames) present in the input matrix, making unique\", \n#                 call. = FALSE, immediate. = TRUE)\n#             rownames(x = counts) <- make.unique(names = rownames(x = counts))\n#         }\n#         if (anyDuplicated(colnames(x = counts))) {\n#             warning(\"Non-unique cell names (colnames) present in the input matrix, making unique\", \n#                 call. = FALSE, immediate. = TRUE)\n#             colnames(x = counts) <- make.unique(names = colnames(x = counts))\n#         }\n#         if (is.null(x = colnames(x = counts))) {\n#             stop(\"No cell names (colnames) names present in the input matrix\")\n#         }\n#         if (any(rownames(x = counts) == \"\")) {\n#             stop(\"Feature names of counts matrix cannot be empty\", \n#                 call. = FALSE)\n#         }\n#         if (nrow(x = counts) > 0 && is.null(x = rownames(x = counts))) {\n#             stop(\"No feature names (rownames) names present in the input matrix\")\n#         }\n#         if (!inherits(x = counts, what = \"dgCMatrix\")) {\n#             counts <- as(object = as.matrix(x = counts), Class = \"dgCMatrix\")\n#         }\n#         if (min.features > 0) {\n#             nfeatures <- Matrix::colSums(x = counts > 0)\n#             counts <- counts[, which(x = nfeatures >= min.features)]\n#         }\n#         if (min.cells > 0) {\n#             num.cells <- Matrix::rowSums(x = counts > 0)\n#             counts <- counts[which(x = num.cells >= min.cells), \n#                 ]\n#         }\n#         data <- counts\n#     }\n#     else if (!missing(x = data)) {\n#         if (anyDuplicated(rownames(x = data))) {\n#             warning(\"Non-unique features (rownames) present in the input matrix, making unique\", \n#                 call. = FALSE, immediate. = TRUE)\n#             rownames(x = data) <- make.unique(names = rownames(x = data))\n#         }\n#         if (anyDuplicated(colnames(x = data))) {\n#             warning(\"Non-unique cell names (colnames) present in the input matrix, making unique\", \n#                 call. = FALSE, immediate. = TRUE)\n#             colnames(x = data) <- make.unique(names = colnames(x = data))\n#         }\n#         if (is.null(x = colnames(x = data))) {\n#             stop(\"No cell names (colnames) names present in the input matrix\")\n#         }\n#         if (any(rownames(x = data) == \"\")) {\n#             stop(\"Feature names of data matrix cannot be empty\", \n#                 call. = FALSE)\n#         }\n#         if (nrow(x = data) > 0 && is.null(x = rownames(x = data))) {\n#             stop(\"No feature names (rownames) names present in the input matrix\")\n#         }\n#         if (min.cells != 0 | min.features != 0) {\n#             warning(\"No filtering performed if passing to data rather than counts\", \n#                 call. = FALSE, immediate. = TRUE)\n#         }\n#         counts <- new(Class = \"matrix\")\n#     }\n#     if (!is.vector(x = rownames(x = counts))) {\n#         rownames(x = counts) <- as.vector(x = rownames(x = counts))\n#     }\n#     if (!is.vector(x = colnames(x = counts))) {\n#         colnames(x = counts) <- as.vector(x = colnames(x = counts))\n#     }\n#     if (!is.vector(x = rownames(x = data))) {\n#         rownames(x = data) <- as.vector(x = rownames(x = data))\n#     }\n#     if (!is.vector(x = colnames(x = data))) {\n#         colnames(x = data) <- as.vector(x = colnames(x = data))\n#     }\n#     if (any(grepl(pattern = \"_\", x = rownames(x = counts))) || \n#         any(grepl(pattern = \"_\", x = rownames(x = data)))) {\n#         warning(\"Feature names cannot have underscores ('_'), replacing with dashes ('-')\", \n#             call. = FALSE, immediate. = TRUE)\n#         rownames(x = counts) <- gsub(pattern = \"_\", replacement = \"-\", \n#             x = rownames(x = counts))\n#         rownames(x = data) <- gsub(pattern = \"_\", replacement = \"-\", \n#             x = rownames(x = data))\n#     }\n#     if (any(grepl(pattern = \"|\", x = rownames(x = counts), \n#         fixed = TRUE)) || any(grepl(pattern = \"|\", x = rownames(x = data), \n#         fixed = TRUE))) {\n#         warning(\"Feature names cannot have pipe characters ('|'), replacing with dashes ('-')\", \n#             call. = FALSE, immediate. = TRUE)\n#         rownames(x = counts) <- gsub(pattern = \"|\", replacement = \"-\", \n#             x = rownames(x = counts), fixed = TRUE)\n#         rownames(x = data) <- gsub(pattern = \"|\", replacement = \"-\", \n#             x = rownames(x = data), fixed = TRUE)\n#     }\n#     init.meta.features <- data.frame(row.names = rownames(x = data))\n#     assay <- new(Class = \"Assay\", counts = counts, data = data, \n#         scale.data = new(Class = \"matrix\"), meta.features = init.meta.features)\n#     return(assay)\n# }\n\n###update object to avoid warning.\ndata(\"pbmc3k\")\npbmc <- UpdateSeuratObject(pbmc3k)\nrm(pbmc3k)\npbmc\n```\n\n    ## An object of class Seurat \n    ## 13714 features across 2700 samples within 1 assay \n    ## Active assay: RNA (13714 features)\n\n### 2. åŸºæœ¬é¢„å¤„ç†\n\nä½œè€…åœ¨åŸæ•™ç¨‹è¯´ï¼š \n\n> The steps below encompass the standard pre-processing\nworkflow for scRNA-seq data in Seurat. These represent the selection and\nfiltration of cells based on QC metrics, data normalization and scaling,\nand the detection of highly variable features.\n\n#### 2.1 ç»†èƒè´¨æ§\n\nä¸‰ç§åŸºæœ¬çš„QC metrics\n\n> 1.  The number of unique genes detected in each cell.\n>       - Low-quality cells or empty droplets will often have very few\n>         genes\n>       - Cell doublets or multiplets may exhibit an aberrantly high\n>         gene count\n> 2.  Similarly, the total number of molecules detected within a cell\n>     (correlates strongly with unique genes)\n> 3.  The percentage of reads that map to the mitochondrial genome\n>       - Low-quality / dying cells often exhibit extensive\n>         mitochondrial contamination\n>       - We calculate mitochondrial QC metrics with the\n>         `PercentageFeatureSet` function, which calculates the\n>         percentage of counts originating from a set of features\n>       - We use the set of all genes starting with `MT-` as a set of\n>         mitochondrial genes\n\næ³¨æ„ï¼Œäººçš„çº¿ç²’ä½“åŸºå› æ˜¯â€œMT-â€å¼€å¤´ï¼Œè€Œå°é¼ çš„çº¿ç²’ä½“åŸºå› æ˜¯â€œmt-â€å¼€å¤´\n\n``` r\n# The [[ operator can add columns to object metadata. This is a great place to stash QC stats\n\n### how does PercentageFeatureSet work\n# PercentageFeatureSet\n# function (object, pattern = NULL, features = NULL, col.name = NULL, \n#     assay = NULL) \n# {\n#     assay <- assay %||% DefaultAssay(object = object)\n#     if (!is.null(x = features) && !is.null(x = pattern)) {\n#         warning(\"Both pattern and features provided. Pattern is being ignored.\")\n#     }\n#     features <- features %||% grep(pattern = pattern, x = rownames(x = object[[assay]]), \n#         value = TRUE)\n#     percent.featureset <- colSums(x = GetAssayData(object = object, \n#         assay = assay, slot = \"counts\")[features, , drop = FALSE])/object[[paste0(\"nCount_\", \n#         assay)]] * 100\n#     if (!is.null(x = col.name)) {\n#         object <- AddMetaData(object = object, metadata = percent.featureset, \n#             col.name = col.name)\n#         return(object)\n#     }\n#     return(percent.featureset)\n# }\n\npbmc[[\"percent.mt\"]] <- PercentageFeatureSet(pbmc, pattern = \"^MT-\")\n# Show QC metrics for the first 5 cells\nhead(pbmc@meta.data, 5)\n```\n\n    ##                orig.ident nCount_RNA nFeature_RNA seurat_annotations percent.mt\n    ## AAACATACAACCAC     pbmc3k       2419          779       Memory CD4 T  3.0177759\n    ## AAACATTGAGCTAC     pbmc3k       4903         1352                  B  3.7935958\n    ## AAACATTGATCAGC     pbmc3k       3147         1129       Memory CD4 T  0.8897363\n    ## AAACCGTGCTTCCG     pbmc3k       2639          960         CD14+ Mono  1.7430845\n    ## AAACCGTGTATGCG     pbmc3k        980          521                 NK  1.2244898\n\nç”±äºæˆ‘ä»¬ç”¨çš„æ˜¯ä½œè€…ç»™äº†metadataçš„æ•°æ®ï¼Œé‡Œé¢å·²ç»å‡ºç°äº†ç»†èƒç±»å‹çš„æ³¨é‡Šï¼Œè§`seurat_annotation`è¿™ä¸€é¡¹ï¼›\n\nQC metricçš„å¯è§†åŒ–ï¼š\n\n``` r\n# Visualize QC metrics as a violin plot\nVlnPlot(pbmc, features = c(\"nFeature_RNA\", \"nCount_RNA\", \"percent.mt\"), ncol = 3)\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-3-1.png\" style=\"display: block; margin: auto;\" />\n\n``` r\n# FeatureScatter is typically used to visualize feature-feature relationships, but can be used\n# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.\n\nplot1 <- FeatureScatter(pbmc, feature1 = \"nCount_RNA\", feature2 = \"percent.mt\")\nplot2 <- FeatureScatter(pbmc, feature1 = \"nCount_RNA\", feature2 = \"nFeature_RNA\")\nplot1 + plot2\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-4-1.png\" style=\"display: block; margin: auto;\" />\n\næœ€ç»ˆé€‰æ‹©çš„è´¨æ§æ ‡å‡†ä¸ºï¼š\n\n>   - We filter cells that have unique feature counts over 2,500 or less\n>     than 200\n>   - We filter cells that have \\>5% mitochondrial counts\n\n``` r\npbmc <- subset(pbmc, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5)\n```\n\n#### 2.2 æ ‡å‡†åŒ–\n\n> After removing unwanted cells from the dataset, the next step is to\n> normalize the data. By default, we employ a global-scaling\n> normalization method â€œLogNormalizeâ€ that normalizes the feature\n> expression measurements for each cell by the total expression,\n> multiplies this by a scale factor (10,000 by default), and\n> log-transforms the result. Normalized values are stored in\n> pbmc\\[\\[â€œRNAâ€\\]\\]@data.\n\n``` r\npbmc <- NormalizeData(pbmc, normalization.method = \"LogNormalize\", scale.factor = 10000)\n```\n\n#### 2.3 ç‰¹å¾é€‰æ‹©\n\nå“ªäº›åŸºå› èƒ½ååº”ä¸åŒç»†èƒä¹‹é—´çš„å¼‚è´¨æ€§ï¼Ÿæ˜¯é‚£äº›è¡¨è¾¾å·®å¼‚å¤§çš„åŸºå› ï¼›\n\næ³¨æ„`FindVariableFeatures`æ˜¯S3 genericï¼Œæ³›å‹å‡½æ•°ã€‚\nå¦‚ä½•æŸ¥çœ‹ä¸€ä¸ªæ³›å‹å‡½æ•°çš„æºä»£ç å‘¢ï¼Œæˆ‘ä»¬å…ˆç”¨`methods`å‡½æ•°åŒ¹é…è¯¥èŒƒå‹å‡½æ•°çš„åå­—ï¼š\n\n``` r\nmethods(FindVariableFeatures)\n```\n\n    ## [1] FindVariableFeatures.Assay*   FindVariableFeatures.default*\n    ## [3] FindVariableFeatures.Seurat* \n    ## see '?methods' for accessing help and source code\n\næ˜Ÿå·è¡¨æ˜æˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡è¿è¡Œå‡½æ•°åå­—æ¥æŸ¥çœ‹å…¶æºä»£ç ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œ **getAnywhere**å‡½æ•°æ¥è·å–è¿™ä¸ªå‡½æ•°ï¼Œ\n\n``` r\ngetAnywhere(FindVariableFeatures.Seurat)\n```\n\n    ## A single object matching 'FindVariableFeatures.Seurat' was found\n    ## It was found in the following places\n    ##   registered S3 method for FindVariableFeatures from namespace Seurat\n    ##   namespace:Seurat\n    ## with value\n    ## \n    ## function (object, assay = NULL, selection.method = \"vst\", loess.span = 0.3, \n    ##     clip.max = \"auto\", mean.function = FastExpMean, dispersion.function = FastLogVMR, \n    ##     num.bin = 20, binning.method = \"equal_width\", nfeatures = 2000, \n    ##     mean.cutoff = c(0.1, 8), dispersion.cutoff = c(1, Inf), verbose = TRUE, \n    ##     ...) \n    ## {\n    ##     assay <- assay %||% DefaultAssay(object = object)\n    ##     assay.data <- GetAssay(object = object, assay = assay)\n    ##     assay.data <- FindVariableFeatures(object = assay.data, selection.method = selection.method, \n    ##         loess.span = loess.span, clip.max = clip.max, mean.function = mean.function, \n    ##         dispersion.function = dispersion.function, num.bin = num.bin, \n    ##         binning.method = binning.method, nfeatures = nfeatures, \n    ##         mean.cutoff = mean.cutoff, dispersion.cutoff = dispersion.cutoff, \n    ##         verbose = verbose, ...)\n    ##     object[[assay]] <- assay.data\n    ##     object <- LogSeuratCommand(object = object)\n    ##     return(object)\n    ## }\n    ## <bytecode: 0x0000000022fa2410>\n    ## <environment: namespace:Seurat>\n\næˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œé»˜è®¤çš„**FindVariableFeatures.Seurat**methodè°ƒç”¨äº†**FindVariableFeatures.Assay**ï¼š\n\n``` r\ngetAnywhere(FindVariableFeatures.Assay)\n```\n\n    ## A single object matching 'FindVariableFeatures.Assay' was found\n    ## It was found in the following places\n    ##   registered S3 method for FindVariableFeatures from namespace Seurat\n    ##   namespace:Seurat\n    ## with value\n    ## \n    ## function (object, selection.method = \"vst\", loess.span = 0.3, \n    ##     clip.max = \"auto\", mean.function = FastExpMean, dispersion.function = FastLogVMR, \n    ##     num.bin = 20, binning.method = \"equal_width\", nfeatures = 2000, \n    ##     mean.cutoff = c(0.1, 8), dispersion.cutoff = c(1, Inf), verbose = TRUE, \n    ##     ...) \n    ## {\n    ##     if (length(x = mean.cutoff) != 2 || length(x = dispersion.cutoff) != \n    ##         2) {\n    ##         stop(\"Both 'mean.cutoff' and 'dispersion.cutoff' must be two numbers\")\n    ##     }\n    ##     if (selection.method == \"vst\") {\n    ##         data <- GetAssayData(object = object, slot = \"counts\")\n    ##         if (IsMatrixEmpty(x = data)) {\n    ##             warning(\"selection.method set to 'vst' but count slot is empty; will use data slot instead\")\n    ##             data <- GetAssayData(object = object, slot = \"data\")\n    ##         }\n    ##     }\n    ##     else {\n    ##         data <- GetAssayData(object = object, slot = \"data\")\n    ##     }\n    ##     hvf.info <- FindVariableFeatures(object = data, selection.method = selection.method, \n    ##         loess.span = loess.span, clip.max = clip.max, mean.function = mean.function, \n    ##         dispersion.function = dispersion.function, num.bin = num.bin, \n    ##         binning.method = binning.method, verbose = verbose, ...)\n    ##     object[[names(x = hvf.info)]] <- hvf.info\n    ##     hvf.info <- hvf.info[which(x = hvf.info[, 1, drop = TRUE] != \n    ##         0), ]\n    ##     if (selection.method == \"vst\") {\n    ##         hvf.info <- hvf.info[order(hvf.info$vst.variance.standardized, \n    ##             decreasing = TRUE), , drop = FALSE]\n    ##     }\n    ##     else {\n    ##         hvf.info <- hvf.info[order(hvf.info$mvp.dispersion, decreasing = TRUE), \n    ##             , drop = FALSE]\n    ##     }\n    ##     selection.method <- switch(EXPR = selection.method, mvp = \"mean.var.plot\", \n    ##         disp = \"dispersion\", selection.method)\n    ##     top.features <- switch(EXPR = selection.method, mean.var.plot = {\n    ##         means.use <- (hvf.info[, 1] > mean.cutoff[1]) & (hvf.info[, \n    ##             1] < mean.cutoff[2])\n    ##         dispersions.use <- (hvf.info[, 3] > dispersion.cutoff[1]) & \n    ##             (hvf.info[, 3] < dispersion.cutoff[2])\n    ##         rownames(x = hvf.info)[which(x = means.use & dispersions.use)]\n    ##     }, dispersion = head(x = rownames(x = hvf.info), n = nfeatures), \n    ##         vst = head(x = rownames(x = hvf.info), n = nfeatures), \n    ##         stop(\"Unkown selection method: \", selection.method))\n    ##     VariableFeatures(object = object) <- top.features\n    ##     vf.name <- ifelse(test = selection.method == \"vst\", yes = \"vst\", \n    ##         no = \"mvp\")\n    ##     vf.name <- paste0(vf.name, \".variable\")\n    ##     object[[vf.name]] <- rownames(x = object[[]]) %in% top.features\n    ##     return(object)\n    ## }\n    ## <bytecode: 0x000000002dc5d050>\n    ## <environment: namespace:Seurat>\n\nåƒå±‚é¥¼çš„æœ€åä¸€å±‚ï¼›\n\n``` r\ngetAnywhere(FindVariableFeatures.default)\n```\n\n    ## A single object matching 'FindVariableFeatures.default' was found\n    ## It was found in the following places\n    ##   registered S3 method for FindVariableFeatures from namespace Seurat\n    ##   namespace:Seurat\n    ## with value\n    ## \n    ## function (object, selection.method = \"vst\", loess.span = 0.3, \n    ##     clip.max = \"auto\", mean.function = FastExpMean, dispersion.function = FastLogVMR, \n    ##     num.bin = 20, binning.method = \"equal_width\", verbose = TRUE, \n    ##     ...) \n    ## {\n    ##     CheckDots(...)\n    ##     if (!inherits(x = object, \"Matrix\")) {\n    ##         object <- as(object = as.matrix(x = object), Class = \"Matrix\")\n    ##     }\n    ##     if (!inherits(x = object, what = \"dgCMatrix\")) {\n    ##         object <- as(object = object, Class = \"dgCMatrix\")\n    ##     }\n    ##     if (selection.method == \"vst\") {\n    ##         if (clip.max == \"auto\") {\n    ##             clip.max <- sqrt(x = ncol(x = object))\n    ##         }\n    ##         hvf.info <- data.frame(mean = rowMeans(x = object))\n    ##         hvf.info$variance <- SparseRowVar2(mat = object, mu = hvf.info$mean, \n    ##             display_progress = verbose)\n    ##         hvf.info$variance.expected <- 0\n    ##         hvf.info$variance.standardized <- 0\n    ##         not.const <- hvf.info$variance > 0\n    ##         fit <- loess(formula = log10(x = variance) ~ log10(x = mean), \n    ##             data = hvf.info[not.const, ], span = loess.span)\n    ##         hvf.info$variance.expected[not.const] <- 10^fit$fitted\n    ##         hvf.info$variance.standardized <- SparseRowVarStd(mat = object, \n    ##             mu = hvf.info$mean, sd = sqrt(hvf.info$variance.expected), \n    ##             vmax = clip.max, display_progress = verbose)\n    ##         colnames(x = hvf.info) <- paste0(\"vst.\", colnames(x = hvf.info))\n    ##     }\n    ##     else {\n    ##         if (!inherits(x = mean.function, what = \"function\")) {\n    ##             stop(\"'mean.function' must be a function\")\n    ##         }\n    ##         if (!inherits(x = dispersion.function, what = \"function\")) {\n    ##             stop(\"'dispersion.function' must be a function\")\n    ##         }\n    ##         feature.mean <- mean.function(object, verbose)\n    ##         feature.dispersion <- dispersion.function(object, verbose)\n    ##         names(x = feature.mean) <- names(x = feature.dispersion) <- rownames(x = object)\n    ##         feature.dispersion[is.na(x = feature.dispersion)] <- 0\n    ##         feature.mean[is.na(x = feature.mean)] <- 0\n    ##         data.x.breaks <- switch(EXPR = binning.method, equal_width = num.bin, \n    ##             equal_frequency = c(-1, quantile(x = feature.mean[feature.mean > \n    ##                 0], probs = seq.int(from = 0, to = 1, length.out = num.bin))), \n    ##             stop(\"Unknown binning method: \", binning.method))\n    ##         data.x.bin <- cut(x = feature.mean, breaks = data.x.breaks)\n    ##         names(x = data.x.bin) <- names(x = feature.mean)\n    ##         mean.y <- tapply(X = feature.dispersion, INDEX = data.x.bin, \n    ##             FUN = mean)\n    ##         sd.y <- tapply(X = feature.dispersion, INDEX = data.x.bin, \n    ##             FUN = sd)\n    ##         feature.dispersion.scaled <- (feature.dispersion - mean.y[as.numeric(x = data.x.bin)])/sd.y[as.numeric(x = data.x.bin)]\n    ##         names(x = feature.dispersion.scaled) <- names(x = feature.mean)\n    ##         hvf.info <- data.frame(feature.mean, feature.dispersion, \n    ##             feature.dispersion.scaled)\n    ##         rownames(x = hvf.info) <- rownames(x = object)\n    ##         colnames(x = hvf.info) <- paste0(\"mvp.\", c(\"mean\", \"dispersion\", \n    ##             \"dispersion.scaled\"))\n    ##     }\n    ##     return(hvf.info)\n    ## }\n    ## <bytecode: 0x0000000023f13fd0>\n    ## <environment: namespace:Seurat>\n\nå¿½ç•¥è¿™äº›æŠ€æœ¯ç»†èŠ‚ï¼Œè¿›è¡Œç‰¹å¾é€‰æ‹©ï¼›\n\n``` r\npbmc <- FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000)\n\n# Identify the 10 most highly variable genes\ntop10 <- head(VariableFeatures(pbmc), 10)\n\n# plot variable features with and without labels\nplot1 <- VariableFeaturePlot(pbmc)\nplot2 <- LabelPoints(plot = plot1, points = top10, repel = TRUE)\nplot1 + plot2\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-11-1.png\" style=\"display: block; margin: auto;\" />\n\n#### 2.4 Scaling the data\n\nè¿™æ­¥çš„ç›®çš„æ˜¯ä¸ºäº†åç»­çš„PCAï¼š\n\n> Next, we apply a linear transformation (â€˜scalingâ€™) that is a standard\n> pre-processing step prior to dimensional reduction techniques like\n> PCA. The **ScaleData** function: + Shifts the expression of each gene,\n> so that the mean expression across cells is 0 + Scales the expression\n> of each gene, so that the variance across cells is 1 + This step gives\n> equal weight in downstream analyses, so that highly-expressed genes do\n> not dominate + The results of this are stored in\n> **pbmc\\[\\[â€œRNAâ€\\]\\]@scale.data**\n\nå›å½’æ‰percent.mtå¯¹äºPCAçš„å½±å“ã€‚è¿™æ­¥æ˜¯ä¸€æ­¥é™é€Ÿæ­¥éª¤ï¼›\n\n``` r\nall.genes <- rownames(pbmc)\npbmc <- ScaleData(pbmc, features = all.genes,vars.to.regress = \"percent.mt\")\n```\n\næœ‰ä¸€ä¸ªé—®é¢˜åé¢çš„markeråŸºå› ä¸€å®šæ˜¯HVGå—ï¼Ÿ\n\n#### 2.5 çº¿æ€§é™ç»´(PCA)\n\n> Next we perform PCA on the scaled data. By default, only the\n> previously determined variable features are used as input, but can be\n> defined using features argument if you wish to choose a different\n> subset.\n\n``` r\npbmc <- RunPCA(pbmc, features = VariableFeatures(object = pbmc))\n# Examine and visualize PCA results a few different ways\nprint(pbmc[[\"pca\"]], dims = 1:5, nfeatures = 5)\n```\n\n    ## PC_ 1 \n    ## Positive:  CST3, TYROBP, LST1, AIF1, FTL \n    ## Negative:  MALAT1, LTB, IL32, IL7R, CD2 \n    ## PC_ 2 \n    ## Positive:  CD79A, MS4A1, TCL1A, HLA-DQA1, HLA-DQB1 \n    ## Negative:  NKG7, PRF1, CST7, GZMA, GZMB \n    ## PC_ 3 \n    ## Positive:  HLA-DQA1, CD79A, CD79B, HLA-DQB1, HLA-DPA1 \n    ## Negative:  PPBP, PF4, SDPR, SPARC, GNG11 \n    ## PC_ 4 \n    ## Positive:  HLA-DQA1, CD79B, CD79A, MS4A1, HLA-DQB1 \n    ## Negative:  VIM, IL7R, S100A6, S100A8, IL32 \n    ## PC_ 5 \n    ## Positive:  GZMB, FGFBP2, S100A8, NKG7, GNLY \n    ## Negative:  LTB, IL7R, CKB, MS4A7, RP11-290F20.3\n\n``` r\nVizDimLoadings(pbmc, dims = 1:2, reduction = \"pca\")\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-14-1.png\" style=\"display: block; margin: auto;\" />\n\n``` r\nDimPlot(pbmc, reduction = \"pca\")\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-15-1.png\" style=\"display: block; margin: auto;\" />\n\n> In particular **DimHeatmap** allows for easy exploration of the\n> primary sources of heterogeneity in a dataset, and can be useful when\n> trying to decide which PCs to include for further downstream analyses.\n> Both cells and features are ordered according to their PCA scores.\n> Setting cells to a number plots the â€˜extremeâ€™ cells on both ends of\n> the spectrum, which dramatically speeds plotting for large datasets.\n> Though clearly a supervised analysis, we find this to be a valuable\n> tool for exploring correlated feature sets.\n\n``` r\n###     Plot an equal number of genes with both + and - scores.\nmypal <- rev(colorRampPalette(RColorBrewer::brewer.pal(11,\"RdBu\"))(256))\nDimHeatmap(pbmc, dims = 1, cells = 500, balanced = TRUE,fast = F)+scale_fill_gradientn(colors  = mypal)\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-16-1.png\" style=\"display: block; margin: auto;\" />\n\n``` r\nDimHeatmap(pbmc, dims = 1:15, cells = 500, balanced = TRUE)\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-17-1.png\" style=\"display: block; margin: auto;\" />\n\n#### 2.6 Determine the â€˜dimensionalityâ€™ of the dataset\n\n> To overcome the extensive technical noise in any single feature for\n> scRNA-seq data, Seurat clusters cells based on their PCA scores, with\n> each PC essentially representing a â€˜metafeatureâ€™ that combines\n> information across a correlated feature set. The top principal\n> components therefore represent a robust compression of the dataset.\n> However, how many componenets should we choose to include? 10? 20?\n> 100?\n\nä¸¤ç§ç»Ÿè®¡æ–¹æ³•ï¼Œ`JackStraw`å’Œ`ElbowPlot`ï¼Œå‰è€…æ¯”è¾ƒè€—æ—¶ï¼Œä¸å†å±•ç¤ºäº†ï¼Œç”¨åè€…\n\n``` r\nElbowPlot(pbmc)\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-18-1.png\" style=\"display: block; margin: auto;\" />\n\nä½œè€…ç»™å‡ºäº†æ›´è¿›ä¸€æ­¥çš„è§£é‡Š\n\n> Identifying the true dimensionality of a dataset â€“ can be\n> challenging/uncertain for the user. We therefore suggest these three\n> approaches to consider. The first is more supervised, exploring PCs to\n> determine relevant sources of heterogeneity, and could be used in\n> conjunction with GSEA for example. The second implements a statistical\n> test based on a random null model, but is time-consuming for large\n> datasets, and may not return a clear PC cutoff. The third is a\n> heuristic that is commonly used, and can be calculated instantly. In\n> this example, all three approaches yielded similar results, but we\n> might have been justified in choosing anything between PC 7-12 as a\n> cutoff.\n\n> We chose 10 here, but encourage users to consider the following:\n\n>   - Dendritic cell and NK aficionados may recognize that genes\n>     strongly associated with PCs 12 and 13 define rare immune subsets\n>     (i.e.Â MZB1 is a marker for plasmacytoid DCs). However, these\n>     groups are so rare, they are difficult to distinguish from\n>     background noise for a dataset of this size without prior\n>     knowledge.\n>   - We encourage users to repeat downstream analyses with a different\n>     number of PCs (10, 15, or even 50\\!). As you will observe, the\n>     results often do not differ dramatically.\n>   - We advise users to err on the higher side when choosing this\n>     parameter. For example, performing downstream analyses with only 5\n>     PCs does signifcanltly and adversely affect results.\n\n### 3. åç»­åˆ†æ\n\n#### 3.1 èšç±»\n\n**FindNeighbors**æ„å»ºæ„å»ºSNN-graph, è€Œ**FindClusters**ç”¨æ¥å®ç°Louvain\nalgorithmï¼Œè¿›è¡Œå›¾èšç±»ï¼›\n\n``` r\nmethods(FindNeighbors)\n```\n\n    ## [1] FindNeighbors.Assay*   FindNeighbors.default* FindNeighbors.dist*   \n    ## [4] FindNeighbors.Seurat* \n    ## see '?methods' for accessing help and source code\n\n``` r\ngetAnywhere(FindNeighbors.Seurat)\n```\n\n    ## A single object matching 'FindNeighbors.Seurat' was found\n    ## It was found in the following places\n    ##   registered S3 method for FindNeighbors from namespace Seurat\n    ##   namespace:Seurat\n    ## with value\n    ## \n    ## function (object, reduction = \"pca\", dims = 1:10, assay = NULL, \n    ##     features = NULL, k.param = 20, compute.SNN = TRUE, prune.SNN = 1/15, \n    ##     nn.method = \"rann\", annoy.metric = \"euclidean\", nn.eps = 0, \n    ##     verbose = TRUE, force.recalc = FALSE, do.plot = FALSE, graph.name = NULL, \n    ##     ...) \n    ## {\n    ##     CheckDots(...)\n    ##     if (!is.null(x = dims)) {\n    ##         assay <- DefaultAssay(object = object[[reduction]])\n    ##         data.use <- Embeddings(object = object[[reduction]])\n    ##         if (max(dims) > ncol(x = data.use)) {\n    ##             stop(\"More dimensions specified in dims than have been computed\")\n    ##         }\n    ##         data.use <- data.use[, dims]\n    ##         neighbor.graphs <- FindNeighbors(object = data.use, k.param = k.param, \n    ##             compute.SNN = compute.SNN, prune.SNN = prune.SNN, \n    ##             nn.method = nn.method, annoy.metric = annoy.metric, \n    ##             nn.eps = nn.eps, verbose = verbose, force.recalc = force.recalc, \n    ##             ...)\n    ##     }\n    ##     else {\n    ##         assay <- assay %||% DefaultAssay(object = object)\n    ##         data.use <- GetAssay(object = object, assay = assay)\n    ##         neighbor.graphs <- FindNeighbors(object = data.use, features = features, \n    ##             k.param = k.param, compute.SNN = compute.SNN, prune.SNN = prune.SNN, \n    ##             nn.method = nn.method, annoy.metric = annoy.metric, \n    ##             nn.eps = nn.eps, verbose = verbose, force.recalc = force.recalc, \n    ##             ...)\n    ##     }\n    ##     graph.name <- graph.name %||% paste0(assay, \"_\", names(x = neighbor.graphs))\n    ##     for (ii in 1:length(x = graph.name)) {\n    ##         DefaultAssay(object = neighbor.graphs[[ii]]) <- assay\n    ##         object[[graph.name[[ii]]]] <- neighbor.graphs[[ii]]\n    ##     }\n    ##     if (do.plot) {\n    ##         if (!\"tsne\" %in% names(x = object@reductions)) {\n    ##             warning(\"Please compute a tSNE for SNN visualization. See RunTSNE().\")\n    ##         }\n    ##         else {\n    ##             if (nrow(x = Embeddings(object = object[[\"tsne\"]])) != \n    ##                 ncol(x = object)) {\n    ##                 warning(\"Please compute a tSNE for SNN visualization. See RunTSNE().\")\n    ##             }\n    ##             else {\n    ##                 net <- graph.adjacency(adjmatrix = as.matrix(x = neighbor.graphs[[2]]), \n    ##                   mode = \"undirected\", weighted = TRUE, diag = FALSE)\n    ##                 plot.igraph(x = net, layout = as.matrix(x = Embeddings(object = object[[\"tsne\"]])), \n    ##                   edge.width = E(graph = net)$weight, vertex.label = NA, \n    ##                   vertex.size = 0)\n    ##             }\n    ##         }\n    ##     }\n    ##     object <- LogSeuratCommand(object = object)\n    ##     return(object)\n    ## }\n    ## <bytecode: 0x000000001e49f8e0>\n    ## <environment: namespace:Seurat>\n\n``` r\npbmc <- FindNeighbors(pbmc, dims = 1:10)\npbmc <- FindClusters(pbmc, resolution = 0.5)\n```\n\n    ## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n    ## \n    ## Number of nodes: 2638\n    ## Number of edges: 95930\n    ## \n    ## Running Louvain algorithm...\n    ## Maximum modularity in 10 random starts: 0.8737\n    ## Number of communities: 9\n    ## Elapsed time: 0 seconds\n\n#### 3.2 Run UMAP/tsne\n\nrun tsne\n\n``` r\npbmc <- RunTSNE(pbmc,dims = 1:10)\nDimPlot(pbmc,label = T, reduction = \"tsne\")\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-22-1.png\" style=\"display: block; margin: auto;\" />\n\ndraw snn graph on tsne-embeding\n\n``` r\ntest <- pbmc[[\"RNA_snn\"]]\n\n\nnet <- graph.adjacency(adjmatrix = as.matrix(x = test), \n                  mode = \"undirected\", weighted = TRUE, \n                  diag = FALSE)\nplot.igraph(x = net, \n            layout = as.matrix(x = Embeddings(object = pbmc[[\"tsne\"]])),\n            edge.width = E(graph = net)$weight, vertex.label = NA, \n                  vertex.size = 0)\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-23-1.png\" style=\"display: block; margin: auto;\" />\n\nrun umap\n\n``` r\n# If you haven't installed UMAP, you can do so via reticulate::py_install(packages =\n# 'umap-learn')\npbmc <- RunUMAP(pbmc,umap.method = \"umap-learn\", dims = 1:10)\n# note that you can set `label = TRUE` or use the LabelClusters function to help label\n# individual clusters\nDimPlot(pbmc,label = T, reduction = \"umap\")\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-24-1.png\" style=\"display: block; margin: auto;\" />\n\n``` r\ntest <- pbmc[[\"RNA_snn\"]]\n\nnet <- graph.adjacency(adjmatrix = as.matrix(x = test), \n                  mode = \"undirected\", weighted = TRUE, \n                  diag = FALSE)\nplot.igraph(x = net, \n            layout = as.matrix(x = Embeddings(object = pbmc[[\"umap\"]])),\n            edge.width = E(graph = net)$weight, vertex.label = NA, \n                  vertex.size = 0)\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-25-1.png\" style=\"display: block; margin: auto;\" />\n\n#### 3.3 Finding differentially expressed features (cluster biomarkers)\n\nä¹‹å‰åˆ†ç¾¤ç»“æœåšå·®å¼‚è¡¨è¾¾ï¼›\n\n> Seurat can help you find markers that define clusters via differential\n> expression. By default, it identifes positive and negative markers of\n> a single cluster (specified in **ident.1**), compared to all other\n> cells. **FindAllMarkers** automates this process for all clusters, but\n> you can also test groups of clusters vs.Â each other, or against all\n> cells.\n\n> The **min.pct** argument requires a feature to be detected at a\n> minimum percentage in either of the two groups of cells, and the\n> thresh.test argument requires a feature to be differentially expressed\n> (on average) by some amount between the two groups. You can set both\n> of these to 0, but with a dramatic increase in time - since this will\n> test a large number of features that are unlikely to be highly\n> discriminatory. As another option to speed up these computations,\n> **max.cells.per.ident** can be set. This will downsample each identity\n> class to have no more cells than whatever this is set to. While there\n> is generally going to be a loss in power, the speed increases can be\n> significiant and the most highly differentially expressed features\n> will likely still rise to the top.\n\n``` r\n# find markers for every cluster compared to all remaining cells, report only the positive ones\npbmc.markers <- FindAllMarkers(pbmc, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)\npbmc.markers %>% group_by(cluster) %>% top_n(n = 2, wt = avg_logFC)\n```\n\n    ## # A tibble: 18 x 7\n    ## # Groups:   cluster [9]\n    ##        p_val avg_logFC pct.1 pct.2 p_val_adj cluster gene    \n    ##        <dbl>     <dbl> <dbl> <dbl>     <dbl> <fct>   <chr>   \n    ##  1 1.88e-117     0.748 0.913 0.588 2.57e-113 0       LDHB    \n    ##  2 5.01e- 85     0.931 0.437 0.108 6.88e- 81 0       CCR7    \n    ##  3 0.            3.86  0.996 0.215 0.        1       S100A9  \n    ##  4 0.            3.80  0.975 0.121 0.        1       S100A8  \n    ##  5 2.61e- 81     0.886 0.981 0.65  3.58e- 77 2       LTB     \n    ##  6 1.22e- 59     0.886 0.669 0.25  1.68e- 55 2       CD2     \n    ##  7 0.            2.99  0.939 0.042 0.        3       CD79A   \n    ##  8 1.06e-269     2.49  0.623 0.022 1.45e-265 3       TCL1A   \n    ##  9 5.98e-221     2.23  0.987 0.226 8.20e-217 4       CCL5    \n    ## 10 1.42e-173     2.08  0.572 0.051 1.94e-169 4       GZMK    \n    ## 11 3.51e-184     2.30  0.975 0.134 4.82e-180 5       FCGR3A  \n    ## 12 2.03e-125     2.14  1     0.315 2.78e-121 5       LST1    \n    ## 13 3.17e-267     3.35  0.961 0.068 4.35e-263 6       GZMB    \n    ## 14 1.04e-189     3.66  0.961 0.132 1.43e-185 6       GNLY    \n    ## 15 1.48e-220     2.68  0.812 0.011 2.03e-216 7       FCER1A  \n    ## 16 1.67e- 21     1.99  1     0.513 2.28e- 17 7       HLA-DPB1\n    ## 17 7.73e-200     5.02  1     0.01  1.06e-195 8       PF4     \n    ## 18 3.68e-110     5.94  1     0.024 5.05e-106 8       PPBP\n\nå¯è§†åŒ–ï¼š\n\n``` r\nVlnPlot(pbmc, features = c(\"MS4A1\", \"CD79A\"))\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-27-1.png\" style=\"display: block; margin: auto;\" />\n\n``` r\n# you can plot raw counts as well\nVlnPlot(pbmc, features = c(\"MS4A1\", \"CD79A\"), slot = \"counts\", log = TRUE)\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-28-1.png\" style=\"display: block; margin: auto;\" />\n\nä½¿ç”¨**FeatureScatter**è·å¾—å’Œæµå¼å›¾ä¸€æ ·çš„æ•ˆæœï¼›\n\n``` r\nFeatureScatter(object = pbmc,\n               feature1 = \"MS4A1\",\n               feature2 = \"CD79A\")+\n  ggtitle(label = NULL)\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-29-1.png\" style=\"display: block; margin: auto;\" />\n\nç”¨**FeaturePlot**åœ¨Embedingä¸Šå±•ç¤ºè¡¨è¾¾é‡ï¼›\n\n``` r\nFeaturePlot(pbmc, features = c(\"MS4A1\", \"GNLY\", \"CD3E\", \"CD14\", \"FCER1A\", \"FCGR3A\", \"LYZ\", \"PPBP\", \n    \"CD8A\"))\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-30-1.png\" style=\"display: block; margin: auto;\" />\n\næ°”æ³¡å›¾**DotPlot**\n\n``` r\nDotPlot(object = pbmc,\n        features = c(\"MS4A1\", \"GNLY\", \"CD3E\", \"CD14\", \"FCER1A\", \"FCGR3A\", \"LYZ\", \"PPBP\",  \"CD8A\"))+\n  coord_flip()\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-31-1.png\" style=\"display: block; margin: auto;\" />\n\n**RidgePlot**\n\n``` r\nRidgePlot(object = pbmc,\n          features = c(\"MS4A1\", \"GNLY\", \"CD3E\", \"CD14\", \"FCER1A\", \"FCGR3A\", \"LYZ\", \"PPBP\",  \"CD8A\"))\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-32-1.png\" style=\"display: block; margin: auto;\" />\n\nçƒ­å›¾**DoHeatmap**\n\n``` r\ntop10 <- pbmc.markers %>% \n  group_by(cluster) %>% top_n(n = 10, wt = avg_logFC)\n\nDoHeatmap(pbmc, features = top10$gene) + \n  scale_fill_gradientn(colors  = mypal)\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-33-1.png\" style=\"display: block; margin: auto;\" />\n\n#### 3.4 Assigning cell type identity to clusters\n\n``` r\nnew.cluster.ids <- c(\"Naive CD4 T\",\"CD14+ Mono\", \"Memory CD4 T\",  \"B\", \"CD8 T\", \"FCGR3A+ Mono\", \"NK\", \"DC\", \"Platelet\")\nnames(new.cluster.ids) <- levels(pbmc)\npbmc <- RenameIdents(pbmc, new.cluster.ids)\nDimPlot(pbmc, reduction = \"umap\", label = TRUE, pt.size = 0.5) + NoLegend()\n```\n\n<img src=\"/figure/posts/LearnSeurat_PBMC3k_files/figure-gfm/unnamed-chunk-34-1.png\" style=\"display: block; margin: auto;\" />\n\n### 4. Seurat object è¯¦è§£\n\nè¿™ä¸€éƒ¨åˆ†æ¥è‡ªwiki\n\n#### 4.1 The Seurat object\n\nä¸€ä¸ªSeuratå¯¹è±¡æœ‰å¦‚ä¸‹çš„`slots`:\n\n| Slot           | Function                                                                        |\n| -------------- | ------------------------------------------------------------------------------- |\n| `assays`       | A list of assays within this object                                             |\n| `meta.data`    | Cell-level meta data                                                            |\n| `active.assay` | Name of active, or default, assay                                               |\n| `active.ident` | Identity classes for the current object                                         |\n| `graphs`       | A list of nearest neighbor graphs                                               |\n| `reductions`   | A list of DimReduc objects                                                      |\n| `project.name` | User-defined project name (optional)                                            |\n| `tools`        | Empty list. Tool developers can store any internal data from their methods here |\n| `misc`         | Empty slot. User can store additional information here                          |\n| `version`      | Seurat version used when creating the object                                    |\n\nè¿™ä¸ªå¯¹è±¡æŠŠå•ç»†èƒæ•°æ®çš„æ‰€æœ‰çš„åŸºæœ¬ä¿¡æ¯éƒ½åŒ…å«è¿›å»äº†ï¼Œå¯ä»¥ç”¨åŸºæœ¬çš„ä¸€äº›å‡½æ•°å»è·å–è¿™äº›ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦çŸ¥é“è¿™ä¸ªæ•°æ®å¯¹åº”å¤šå°‘ç»†èƒï¼Œå¤šå°‘åŸºå› ï¼Œå¯ä»¥ç”¨`dim`;`ncol`;`nrow`;ç»†èƒæˆ–è€…featureçš„åå­—ï¼Œå¯ä»¥ç”¨`rownames`;`colnames`;\næˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡`names`çŸ¥é“é‡Œé¢å­˜å‚¨çš„å¦‚åŸå§‹è¡¨è¾¾çŸ©é˜µï¼Œæˆ–è€…é™ç»´åå¯¹è±¡çš„åå­—ã€‚\n\n``` r\nnames(x = pbmc)\n```\n\n    ## [1] \"RNA\"     \"RNA_nn\"  \"RNA_snn\" \"pca\"     \"tsne\"    \"umap\"\n\n``` r\nrna <- pbmc[['RNA']]\n```\n\nå¯¹äºSeuratå¯¹è±¡ï¼Œæœ‰ä¸€ç³»åˆ—çš„å‡½æ•°å¯ä»¥å¯¹å…¶è¿›è¡Œæ“ä½œã€‚è¿™äº›å‡½æ•°å¯ä»¥ç§°ä¸ºå…¶æ‰€å±çš„**methods**ã€‚å¤šè¯´ä¸€å¥ï¼ŒSeuraté‡‡å–çš„æ˜¯S3å¯¹è±¡çš„é¢å‘å¯¹è±¡çš„æ•°æ®ç»“æ„ã€‚\n\nå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®¿é—®ä¸Seuratå¯¹è±¡ç›¸å…³çš„æ“ä½œã€‚\n\n``` r\nutils::methods(class = 'Seurat')\n```\n\n    ##  [1] $                       $<-                     [                      \n    ##  [4] [[                      [[<-                    AddMetaData            \n    ##  [7] as.CellDataSet          as.loom                 as.SingleCellExperiment\n    ## [10] Command                 DefaultAssay            DefaultAssay<-         \n    ## [13] dim                     dimnames                droplevels             \n    ## [16] Embeddings              FindClusters            FindMarkers            \n    ## [19] FindNeighbors           FindVariableFeatures    GetAssay               \n    ## [22] GetAssayData            HVFInfo                 Idents                 \n    ## [25] Idents<-                Key                     levels                 \n    ## [28] levels<-                Loadings                merge                  \n    ## [31] Misc                    Misc<-                  names                  \n    ## [34] NormalizeData           OldWhichCells           Project                \n    ## [37] Project<-               RenameCells             RenameIdents           \n    ## [40] ReorderIdent            RunALRA                 RunCCA                 \n    ## [43] RunICA                  RunLSI                  RunPCA                 \n    ## [46] RunTSNE                 RunUMAP                 ScaleData              \n    ## [49] ScoreJackStraw          SetAssayData            SetIdent               \n    ## [52] show                    StashIdent              Stdev                  \n    ## [55] subset                  SubsetData              Tool                   \n    ## [58] Tool<-                  VariableFeatures        VariableFeatures<-     \n    ## [61] WhichCells             \n    ## see '?methods' for accessing help and source code\n\n#### 4.2 Assay\n\n> The `Assay` class stores single cell data.\n\n> For typical scRNA-seq experiments, a Seurat object will have a single\n> Assay (â€œRNAâ€). This assay will also store multiple â€˜transformationsâ€™\n> of the data, including raw counts (@counts slot), normalized data\n> (@data slot), and scaled data for dimensional reduction (@scale.data\n> slot).\n\n> For more complex experiments, an object could contain multiple assays.\n> These could include multi-modal data types (CITE-seq antibody-derived\n> tags, ADTs), or imputed/batch-corrected measurements. Each of those\n> assays has the option to store the same data transformations as well.\n\nä¸€ä¸ª**Assay** æ‰€å«æœ‰çš„Slots\n\n| Slot            | Function                                                                     |\n| --------------- | ---------------------------------------------------------------------------- |\n| `counts`        | Stores unnormalized data such as raw counts or TPMs                          |\n| `data`          | Normalized data matrix                                                       |\n| `scale.data`    | Scaled data matrix                                                           |\n| `key`           | A character string to facilitate looking up features from a specific `Assay` |\n| `var.features`  | A vector of features identified as variable                                  |\n| `meta.features` | Feature-level meta data                                                      |\n\n**Assay**å¯¹è±¡ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•\n\nSummary information about `Assay` objects can be had quickly and easily\nusing standard R functions. Object shape/dimensions can be found using\nthe `dim`, `ncol`, and `nrow` functions; cell and feature names can be\nfound using the `colnames` and `rownames` functions, respectively, or\nthe `dimnames` function.\n\næ›´å¤šçš„æ–¹æ³•è§\n\n``` r\nutils::methods(class = 'Assay')\n```\n\n    ##  [1] [                    [[                   [[<-                \n    ##  [4] AddMetaData          DefaultAssay         DefaultAssay<-      \n    ##  [7] dim                  dimnames             FindNeighbors       \n    ## [10] FindVariableFeatures GetAssayData         HVFInfo             \n    ## [13] Key                  Key<-                merge               \n    ## [16] Misc                 Misc<-               NormalizeData       \n    ## [19] OldWhichCells        RenameCells          RunICA              \n    ## [22] RunLSI               RunPCA               ScaleData           \n    ## [25] SetAssayData         show                 subset              \n    ## [28] SubsetData           VariableFeatures     VariableFeatures<-  \n    ## [31] WhichCells          \n    ## see '?methods' for accessing help and source code\n\nData Access\n\n``` r\n# GetAssayData allows pulling from a specific slot rather than just data\nGetAssayData(object = rna, slot = 'scale.data')[1:3, 1:3]\n```\n\n    ##               AAACATACAACCAC AAACATTGAGCTAC AAACATTGATCAGC\n    ## AL627309.1       -0.06433822    -0.06968772    -0.04966479\n    ## AP006222.2       -0.02663018    -0.02065038    -0.04303249\n    ## RP11-206L10.2    -0.03015459    -0.02024084    -0.05734758\n\n``` r\nhead(x = HVFInfo(object = rna,selection.method = \"vst\"))\n```\n\n    ##                      mean    variance variance.standardized\n    ## AL627309.1    0.003411676 0.003401325             0.9330441\n    ## AP006222.2    0.001137225 0.001136363             0.9924937\n    ## RP11-206L10.2 0.001895375 0.001892500             0.9627290\n    ## RP11-206L10.9 0.001137225 0.001136363             0.9924937\n    ## LINC00115     0.006823351 0.006779363             0.9062135\n    ## NOC2L         0.107278241 0.159514698             0.7849309\n\nThe key\n\n``` r\n# Key both accesses and sets the key slot for an Assay object\n> Key(object = rna)\n\"rna_\"\n> Key(object = rna) <- 'myRNA_'\n> Key(object = rna)\n\"myRNA_\"\n# Pull a feature from the RNA assay on the Seurat level\n> head(x = FetchData(object = pbmc, vars.fetch = 'rna_MS4A1'))\n               rna_MS4A1\nAAACATACAACCAC  0.000000\nAAACATTGAGCTAC  2.583047\nAAACATTGATCAGC  0.000000\nAAACCGTGCTTCCG  0.000000\nAAACCGTGTATGCG  0.000000\nAAACGCACTGGTAC  0.000000\n```\n\nThe `DimReduc` object represents a dimensional reduction taken upon the\nSeurat object.\n\n#### 4.3 The `DimReduc` object\n\nThe `DimReduc` object represents a dimensional reduction taken upon the\nSeurat object.\n\n| Slot                         | Function                                                                        |\n| ---------------------------- | ------------------------------------------------------------------------------- |\n| `cell.embeddings`            | A matrix with cell embeddings                                                   |\n| `feature.loadings`           | A matrix with feature loadings                                                  |\n| `feature.loadings.projected` | A matrix with projected feature loadings                                        |\n| `assay.used`                 | Assay used to calculate this dimensional reduction                              |\n| `stdev`                      | Standard deviation for the dimensional reduction                                |\n| `key`                        | A character string to facilitate looking up features from a specific `DimReduc` |\n| `jackstraw`                  | Results from the `JackStraw` function                                           |\n| `misc`                       | â€¦                                                                               |\n\nå’Œä¹‹å‰çš„å¾ˆç±»ä¼¼\n\n``` r\npca <- pbmc[[\"pca\"]]\n# The following examples use the PCA dimensional reduction from the PBMC 3k dataset\n> pca\nA dimensional reduction object with key PC\n Number of dimensions: 20\n Projected dimensional reduction calculated: FALSE\n Jackstraw run: FALSE\n# nrow and ncol provide the number of features and cells, respectively\n# dim provides both nrow and ncol at the same time\n> dim(x = pca)\n[1] 1838 2638\n# length provides the number of dimensions calculated\n> length(x = pca)\n[1] 20\n# In addtion to rownames and colnames, one can use dimnames\n# which provides a two-length list with both rownames and colnames\n> head(x = rownames(x = rna))\n[1] \"TNFRSF4\"  \"CPSF3L\"   \"ATAD3C\"   \"C1orf86\"  \"RER1\"     \"TNFRSF25\"\n> head(x = colnames(x = rna))\n[1] \"AAACATACAACCAC\" \"AAACATTGAGCTAC\" \"AAACATTGATCAGC\" \"AAACCGTGCTTCCG\"\n[5] \"AAACCGTGTATGCG\" \"AAACGCACTGGTAC\"\n```\n\nAccess data\n\n``` r\n# The key can be used to pull cell embeddings for specific dimensions from the Seurat level\n> Key(object = pca)\n\"PC\"\n> head(x = FetchData(object = pbmc, vars.fetch = 'PC1'))\n                      PC1\nAAACATACAACCAC   5.569384\nAAACATTGAGCTAC   7.216456\nAAACATTGATCAGC   2.706629\nAAACCGTGCTTCCG -10.134042\nAAACCGTGTATGCG  -1.099311\nAAACGCACTGGTAC   1.455335\n# DefaultAssay gets the name of the Assay object used to calculate the DimReduc\n> DefaultAssay(object = pca)\n[1] \"RNA\"\n# Stdev gets the vector of standard deviations for each dimension embedded.\nStdev(object = pca)\n [1] 5.666584 4.326466 3.952192 3.638124 2.191529 1.996551 1.877891 1.798251\n [9] 1.766873 1.753684 1.731568 1.720525 1.718079 1.715879 1.707009 1.702660\n[17] 1.697318 1.692549 1.686149 1.683967\n```\n\nåœ¨å…¶ä¸Šå¯ä»¥æ‰§è¡Œçš„**method**æœ‰\n\n``` r\nutils::methods(class = \"DimReduc\")\n```\n\n    ##  [1] [              [[             Cells          DefaultAssay   DefaultAssay<-\n    ##  [6] dim            dimnames       Embeddings     IsGlobal       JS            \n    ## [11] JS<-           Key            Key<-          length         Loadings      \n    ## [16] Loadings<-     names          print          RenameCells    RunTSNE       \n    ## [21] ScoreJackStraw show           Stdev          subset        \n    ## see '?methods' for accessing help and source code\n\n#### 4.4 Ré¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ›´å¤šç»†èŠ‚ï¼›\n\nå…³äºé¢å‘å¯¹è±¡ï¼Œä»¥åŠS3å¯¹è±¡çš„æ•™ç¨‹ï¼Œæ›´å¤šå¯è§ï¼š\n\n1.  [Ræ·±å…¥|é¢å‘å¯¹è±¡â€”â€”æ³›å‹å‡½æ•°](https://zhuanlan.zhihu.com/p/31160374)\n2.  [OO field guide](http://adv-r.had.co.nz/OO-essentials.html)\n3.  [Rè¯­è¨€é¢å‘å¯¹è±¡ç¼–ç¨‹](https://dataxujing.github.io/R_oop/)\n","tags":["R","scRNA-seq"],"categories":["implementation"]},{"title":"Dobrow-chap3","url":"/2020/05/06/Dobrow-chap3/","content":"\n\nThis is a note of the textbook `Introduction to stochastic processes with R`\n\n> There exists everywhere a medium in things, determined by equilibrium.\n>                                                  â€”Dmitri Mendeleev\n\næ‰¿æ¥ä¸Šç« æœ€åçš„æ•°å€¼æ¡ˆä¾‹ï¼Œæœ¬ç« ä¸»è¦è®²è½¬ç§»æ­¥æ•°è¶‹äºæ— ç©·æ—¶é©¬å°”å¯å¤«é“¾çš„æ€§è´¨ã€‚\n\n### 3.1 Limiting Distribution\n\n#### 3.1.1 å®šä¹‰\n\nä½œè€…ç»™äº†æœ‰ä¸€ä¸ªå®šä¹‰å’Œä¸‰ä¸ªç­‰ä»·å®šä¹‰ã€‚è¿™ä¸ªå«ä¹‰æœ€æ¸…æ¥šï¼š\n\n> A limiting distribution\nfor the Markov chain is a probability distribution ğ€ with the property that, for any initial distribution $\\boldsymbol{\\alpha}$:\n> $$\\lim_{n\\rightarrow\\infty}\\boldsymbol{\\alpha}P^n=\\boldsymbol{\\lambda}$$\n\nè¿™ä¸ªå®šä¹‰ä¸åŸå®šä¹‰çš„ç­‰ä»·æ€§ä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼š\n\nè‹¥å¯¹æŸä¸€é©¬å°”å¯å¤«é“¾çš„çŠ¶æ€è½¬ç§»çŸ©é˜µæœ‰ï¼š\n$$\\lim_{n\\rightarrow\\infty}P^n_{ij}=\\lambda_j$$\nå¹¶ä¸”è®¾åˆå§‹åˆ†å¸ƒ$\\boldsymbol{\\alpha}=(\\alpha_1,\\dots,\\alpha_n)$,çŠ¶æ€æ€»æ•°ä¸º$m$\nåˆ™æœ‰ï¼š\n\n$$\n\\begin{aligned}\n  \\lim_{n\\rightarrow\\infty}\\boldsymbol{\\alpha}\\boldsymbol{P}^n &=(\\alpha_1,\\dots,\\alpha_n)\\begin{pmatrix}\n   \\lambda_1 & \\lambda_2 & \\cdots &  \\lambda_m \\\\\n   \\lambda_1 & \\lambda_2 & \\cdots &  \\lambda_m \\\\\n   \\vdots & \\vdots & \\ddots &  \\lambda_m \\\\\n   \\lambda_1 & \\lambda_2 & \\cdots &  \\lambda_m\n  \\end{pmatrix} \\\\ \n  & = \\begin{pmatrix}\n    \\lambda_1\\sum_{i=1}^n\\alpha_i \\\\\n    \\lambda_2\\sum_{i=1}^n\\alpha_i \\\\\n    \\cdots \\\\\n    \\lambda_m\\sum_{i=1}^n\\alpha_i\n  \\end{pmatrix} \\\\\n  & = \\begin{pmatrix}\n    \\lambda_1 \\\\\n    \\lambda_2 \\\\\n    \\cdots \\\\\n    \\lambda_m\n  \\end{pmatrix} \\\\\n  & = \\boldsymbol{\\lambda}\n\\end{aligned}\n$$\n\n\nEx3.1 Two state Markov Chain\nè®¡ç®—æ¡ˆä¾‹ï¼›\n\n#### 3.1.2 Proportion of Time in Each State\n\nåˆ©ç”¨è®¡ç®—æ¡ä»¶æœŸæœ›çš„æŠ€æœ¯ï¼Œæ¥ä»çŠ¶æ€åœ¨è¿‡ç¨‹ä¸­æ‰€å çš„æ¯”ä¾‹æ¥ç†è§£Limit distribution\n\n\n\nEx3.2\n\n```r\n###### Simulate discrete-time Markov chain ########################\n# Simulates n steps of a Markov chain \n# markov(init,mat,n,states)\n# Generates X0, ..., Xn for a Markov chain with initiial\n#  distribution init and transition matrix mat\n# Labels can be a character vector of states; default is 1, .... k\n\nmarkov <- function(init,mat,n,labels) { \n\tif (missing(labels)) labels <- 1:length(init)\nsimlist <- numeric(n+1)\nstates <- 1:length(init)\nsimlist[1] <- sample(states,1,prob=init)\nfor (i in 2:(n+1)) \n\t{ simlist[i] <- sample(states,1,prob=mat[simlist[i-1],]) }\nlabels[simlist]\n}\n####################################################\nP <- matrix(c(0.1,0.2,0.4,0.3,0.4,0,0.4,0.2,0.3,0.3,0,0.4,0.2,0.1,0.4,0.3),\n  nrow=4, byrow=TRUE)\nlab <- c(\"Aerobics\",\"Massage\",\"Weights\",\"Yoga\")\nrownames(P) <- lab\ncolnames(P) <- lab\nP\ninit <- c(1/4,1/4,1/4,1/4) # initial distribution\nstates <- c(\"a\",\"m\",\"w\",\"y\")\n# simulate chain for 100 steps\nsimlist <- markov(init,P,100,states)\nsimlist\ntable(simlist)/100\nsteps <- 1000000\nsimlist <- markov(init,P,steps,states)\ntable(simlist)/steps\n```\n\n### 3.2 Stationary Distribution\n\n#### 3.2.1 å®šä¹‰\næ³¨æ„Stationary Distributionçš„å®šä¹‰æ²¡æœ‰å‡ºç°æé™ã€‚\n\n> If the initial distributino is a stationary distribution, Then $X_0,X_1,\\cdots,X_n$ is a sequence of identically distributed random variables. But it doesn't mean that the random variables are independent.\n\n> Lemma 3.1: Limiting Distributions are stationary Distribution\n\nThe reverse is false, åä¾‹ï¼š\n\n$$\n  P = \\begin{pmatrix}\n    0 & 1 \\\\\n    1 & 0\n  \\end{pmatrix}\n  ï¼Œ\\pi=(\\frac{1}{2},\\frac{1}{2}) \n$$\n\nä»¥åŠ\n\n$$\n   P = \\begin{pmatrix}\n    1 & 0 \\\\\n    0 & 1\n  \\end{pmatrix}\n$$\n\n#### 3.2.2 Regular Matrices\n\nä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•æ˜¯é—®ï¼Œä»€ä¹ˆæ ·çš„æ¡ä»¶ä¸‹ï¼Œä¸€ä¸ªé©¬å°”å¯å¤«é“¾æœ‰æé™åˆ†å¸ƒï¼Œè€Œä¸”æé™åˆ†å¸ƒå°±æ˜¯å¹³ç¨³åˆ†å¸ƒå‘¢ã€‚\n\næ»¡è¶³å¦‚ä¸‹æ€§è´¨çš„é©¬å°”å¯å¤«é“¾æ˜¯ç¬¦åˆè¿™ä¸ªè¦æ±‚çš„\n\n> Regular Transition Matrix\n> A transition matrix $\\boldsymbol{P}$ is said to be regular if some power of $\\boldsymbol{P}$ is positive. That is $\\boldsymbol{P}^n > 0 $, for some $n\\ge 1$\n\næœ‰å®šç†ï¼š\n\n> Theorem 3.2: A markov chain whose transition matrix $\\boldsymbol{P}$ is regular has a limiting distribution, which is teh unique, positive, stationary distribution of the chanin.\n\nEx 3.3-3.4 å…·ä½“ç®—ä¾‹ï¼Œ\n\n#### 3.2.3 Finding the stationary distribution\n\næœ¬è´¨ä¸Šè¿™æ˜¯ä¸€ä¸ªç‰¹å¾å€¼é—®é¢˜ã€‚\n\n```r\n### Stationary distribution of discrete-time Markov chain\n###  (uses eigenvectors)\n###\nstationary <- function(mat) {\nx = eigen(t(mat))$vectors[,1]\nas.double(x/sum(x))\n}\n```\n\nEx 3.5-3.6; è®¡ç®—æŠ€å·§ï¼Œä»¤$x_1=1$\n\nEx 3.7 The Ehrenfest dog-flea model\n\nEx 3.8 Random walk on a graph;\n\nOn weighted graph\n\n> Stationiary Distribution for Random walk on a weighted graph\n> \n> Let $G=(V,E)$ be  a weighted graph with edge weight function $w(i,j)$. For random walk on G, the stationary distribution $pi$ is proportion to the sum of teh edge weights incident to each vertex. That is.\n> $$ \\pi = \\frac{w(v)}{\\sum_{z}w(z)},\\forall v\\in V$$ \n> where\n> $$ w(v) = \\sum_{z \\sim v }w(v,z) $$\n\nOn simple graph\n\n> Stationary Distribution for simple Random Walk on a graph\n> \n> For simple random walk on a weighted graph, set $w(i,j)=1,\\forall i,j \\in V $, then, $w(v)=deg(v)$,which gives\n> $$ \\pi_{v}=\\frac{\\deg(v)}{\\sum_z \\deg(z)}=\\frac{\\deg(v)}{2e} $$\n\nEx 3.9-3.10 å¦‚ä½•è®¡ç®—çš„æ¡ˆä¾‹ï¼›\n\n#### 3.2.4 The Eigenvalue Connection\n\nè½¬ç½®ï¼Œçœ‹å‡ºä¸ç‰¹å¾å€¼çš„å…³è”ã€‚\n\nEx 3.10 ç†è®ºæ¡ˆä¾‹ï¼š random walk in regular graph.ã€‚\n\n### 3.3 Can you find the way to state $a$\n\n#### 3.3.1 çŠ¶æ€å¯åˆ°è¾¾ä¸çŠ¶æ€äº’é€š\n\n> Say that state $j$ is accessible from state i, if $P_{ij}^n > 0$. That is,there is positive probability of reaching $j$ from $i$ in a finite number of steps. State $i$ and $j$ communicate if $i$ is accessible from $j$ and $j$ is accessible from $i$\n\neg 3.11 æœ¬ä¾‹è®²è¿°äº†ç”¨ Transition graphs å±•ç¤º Communication classes\n\n#### 3.3.2 ä¸å¯çº¦\n\n> Irreducibility\n> A Markov chain is called irreducible if it has exactly one cmmunication class. That is, all states communicate with each other\n\nEx 3.12 ä¸€ä¸ªä¸å¯çº¦é“¾çš„ä¾‹å­ï¼›\n\n#### 3.3.3 Recurrence and Transience\n\n> Given a Markov chain $X_0,X_1,\\dots$, let $T_j=\\min\\{n>0:X_n=j\\}$be the first passage time to state $j$. If $X_n\\ne j,\\forall n>0$, see$T_j=\\infty$. Let\n> $$ f_j = P(T_j < \\infty | X_0=j)$$\n> be the probability started in $j$ eventually returns to $j$.\n> \n> State $j$ is said to be recurrent if the Markov chain started in $j$ eventually revists $j$. That is $f_j=1$\n> \n> State $j$ is said to be transient if there is positive probability that the Markov chain started in j never returns to $j$. That is $f_j < 1$\n\nå¦‚ä½•æ ¹æ®çŠ¶æ€è½¬ç§»çŸ©é˜µåˆ¤å®šï¼ŒæŸä¸€ä¸ªçŠ¶æ€æ˜¯Recurrentæˆ–Transient Statesã€‚ç”¨ç¤ºæ€§å‡½æ•°ï¼Œ\n\n$E(\\sum_{n=0}^{\\infty}I_n)=\\sum_{n=0}^{\\infty}E(I_n)=\\sum_{n=0}^{\\infty}P(X_n=j|X_0=i)=\\sum_{n=0}^{\\infty}P_{ij}^{n}$\n\nç”±æ­¤å¯ä»¥æ¨å‡ºå¦å¤–ä¸€ä¸ªåˆ¤å®šæ¡ä»¶ï¼›\n\n> Recurrence, Transience\n> \n> (i) State $j$ is recurrent if and only if\n> $$ \\sum_{n=0}^{\\infty}P_{ij}^n=\\infty $$\n> \n> (ii) State j is transient if and only if\n> \n> $$\\sum_{n=0}^{\\infty}P_{ij}^n<\\infty$$\n\n> Recuurence and Transience are Class Properties\n> \n> Theorem 3.3 The states of a communication class are either all recurrent or all transient.\n> Corollary 3.4 For a finite irreducible Markov chain, all states are recuurent.\n\nEx 3.13 æ¥ä¸‹æ¥çš„ä¾‹å­æ˜¯ç®€å•çš„ä¸€ç»´éšæœºæ¸¸èµ°ï¼›è¿™ä¸ªä¾‹å­å¯ä»¥æ¨å¹¿åˆ°é«˜ç»´ã€‚\n\n#### 3.3.4 Canonical Decomposition\n\nClosed Communication Class\n\n> Lemma 3.5 A communication class is closed if it consists of all recurrent states. A finite communication class is closed only if it consits of all recurrent states.\n\nåè¯æ³•å³å¯è¯å¾—ï¼›æœ€åä¾¿å¯ä»¥å¾—åˆ°ï¼Œæˆ‘ä»¬æƒ³å®šä¹‰çš„ï¼›\n\n> The state space S of a finite Markov chain can be partitioned into transient and reccurent states as $S=T \\cup R_1 \\cup \\cdots R_m$, where T is the set of all transient states and $R_i$ are closed communiction classes of recurrent states. This is called the canonical decomposition.\n\næ³¨ï¼šç”±ç­‰ä»·ç±»çš„å®šä¹‰å¯ä»¥ä¿éšœè¿™ä¹ˆé‡æ’çŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œæ˜¯ä¸åŸçŸ©é˜µç­‰ä»·çš„ã€‚\n\n> Given a canonical decomposition, the state space can be reordered so that the Markov transition matrix has the block matrix form\n\n$$\n\t\\boldsymbol{P}=\n\t\\left(\n\t\\begin{array}{c|c}\n\t\\boldsymbol{Q} & \\ast & \\ast & \\cdots & \\ast \\\\ \\hline \n\t\\boldsymbol{O} & \\boldsymbol{P_1} & \\boldsymbol{O} &\\cdots & \\boldsymbol{O}\\\\\n  \\boldsymbol{O} & \\boldsymbol{O} & \\boldsymbol{P_2} &\\cdots & \\boldsymbol{O} \\\\\n  \\vdots & \\vdots & \\vdots &\\ddots & \\vdots \\\\\n  \\boldsymbol{O} & \\boldsymbol{O} & \\boldsymbol{O} &\\cdots & \\boldsymbol{P_m}\n\t\\end{array}\n\t\\right)\n$$\n\nå…¶ä¸­$\\boldsymbol{O}=(p_{ij}=0),\\boldsymbol{Q}=(p_{ij})_{i,j \\in T},\\boldsymbol{P_l}=(p_{ij})_{i,j \\in R_l},l=1,2,\\cdots,m$\n\nEx3.14 å…·ä½“ case;\n\næ›´è¿›ä¸€æ­¥æœ‰ï¼š\n\n$$\n\t\\lim_{n\\rightarrow\\infty} \\boldsymbol{P}^n=\n\t\\left(\n\t\\begin{array}{c|c}\n\t\\boldsymbol{O} & \\ast & \\ast & \\cdots & \\ast \\\\ \\hline \n\t\\boldsymbol{O} & \\lim_{n\\rightarrow\\infty}\\boldsymbol{P_1}^n & \\boldsymbol{O} &\\cdots & \\boldsymbol{O}\\\\\n  \\boldsymbol{O} & \\boldsymbol{O} & \\lim_{n\\rightarrow\\infty}\\boldsymbol{P_2}^n &\\cdots & \\boldsymbol{O} \\\\\n  \\vdots & \\vdots & \\vdots &\\ddots & \\vdots \\\\\n  \\boldsymbol{O} & \\boldsymbol{O} & \\boldsymbol{O} &\\cdots & \\lim_{n\\rightarrow\\infty}\\boldsymbol{P_m}^n\n\t\\end{array}\n\t\\right)\n$$\n\n---\nedit: 2020-05-05\n\n### 3.4 Irreducible Markov Chains\n\n#### 3.4.1 å®šç†\n\nå‡è®¾åœ°éœ‡å°é€šè¿‡ç»Ÿè®¡æ•°æ®å¾—åˆ°äº†ä¸€ä¸ªä¸åŒçº§åˆ«çš„åœ°éœ‡çš„çŠ¶æ€æ¦‚ç‡çŸ©é˜µï¼Œæ”¿åºœå’Œå¤§ä¼—å…³å¿ƒçš„é—®é¢˜æ˜¯ï¼Œä»ä¸Šä¸€æ¬¡åœ°éœ‡åˆ°å³å°†å‘ç”Ÿçš„ä¸‹ä¸€æ¬¡åœ°éœ‡ï¼Œå¤§æ¦‚éœ€è¦å¤šå°‘å¹´ï¼Ÿ\n\nä¸€ä¸ªæ˜¾ç„¶çš„ç›´è§‰ä¸Šçš„æ„Ÿè§‰æ˜¯ï¼Œæ ¹æ®åœ°éœ‡çš„å¼ºåº¦è€Œå®šã€‚ä¸åŒå¼ºåº¦ä¸åŒã€‚\n\nå¯ä»¥ç”¨é©¬å°”å¯å¤«é“¾ä½œä¸ºä¸Šè¿°é—®é¢˜çš„æ•°å­¦æ¨¡å‹ã€‚\n\nå›é¡¾åœæ—¶çš„å®šä¹‰$T_j = \\min\\{n>0:X_n=j\\}$ï¼Œæœ‰å¦‚ä¸‹å®šç†ï¼š\n\n> **Theorem 3.6 Limit Theorem for Finite Irreducible Markov Chains**. Assume that $X_0,X_1,\\dots$, is a finite irreducible Markov Chain. For each state $j$. let $\\mu_j=E(T_j|X_0=j)$ be the expected return time to $j$. Then, $\\mu_j$ is finite, and there exisits a unique, positve stationary distribution $\\boldsymbol{\\pi}$ such that \n> $$ \\pi_j =\\frac{1}{\\mu_j} , \\forall j$$\n> Furthermore, $\\forall i$\n> $$ \\pi_j = \\lim_{n\\rightarrow\\infty}\\frac{1}{n}\\sum_{m=0}^{n-1}P^m_{ij} $$\n\n\nEx 3.15 åœ°éœ‡çš„ recurrenceçš„ä¾‹å­ï¼›\n\nEx 3.16 Frog jumping ç®—ä¾‹ï¼›\n\n#### 3.4.2 First-Step Analysis\n\nEx 3.17 ä¸€ä¸ªè®¡ç®—Expected return timeçš„ä¾‹å­ï¼›\n\n### 3.5 Periodicity\n\nå¦‚æœè¯¥é©¬å°”å¯å¤«é“¾æ²¡æœ‰å¹³ç¨³åˆ†å¸ƒï¼Œè¯¥å¦‚ä½•ç ”ç©¶ï¼Ÿ\n\nå…·ä½“çš„æ¡ˆä¾‹å¯ä»¥çœ‹ç¬¬ä¸€ç« æœ€åçš„é‚£å‡ ä¸ªç®—ä¾‹ã€‚\n\nç­”æ¡ˆæ˜¯å¼•å…¥å‘¨æœŸçš„æ¦‚å¿µã€‚\n\n> **Lemma 3.7** The states of a communication class all have the same period\n\næ ¹æ®è¿™æ¡å¼•ç†ï¼Œæœ‰\n\n> A Markov chain is called perioidic if is irreducible and all states have period greater than 1. A Markov chain is called aperiodic if it is irreducible and all states have period equal 1.\n\n### 3.6 Ergoidc Markov Chains \n\nA Markov chain is called ergodic if it is irreducible, aperiodic, and all states have finite expected return times.\n\n> **Fundamental Limit Theorem for Ergodic Markov Chains**\n> **Therem 3.8** Let $X_0,X_1,\\cdots$ be an ergodic Markov chain. There exists a unique, positive, stationary distribution $\\boldsymbol{\\pi}$,which is the limiting distribution of the chain. That is, \n> $$\\pi_j = \\lim_{n\\rightarrow\\infty}P^n_{ij},\\forall i,j$$\n\nEx 3.19ï¼ˆModified Ehrenfrest Modelï¼‰; \n\nEx 3.20 ç®—ä¾‹;\n\nEx 3.21 PageRank; (damping factor,p=0.85)\n\n---\nedit: 2020-05-06\n\n### 3.7 Time reversibility\n\n#### 3.7.1 Definition\n\nThe property of time reversibility can be explained intuitively as follows. If you were to take a movie of Markov chain moving forward in time and then run the movie backwards, you could not tell the difference between the two.\n\næ¢æˆæ•°å­¦ä¸Šçš„è¯­è¨€å°±æ˜¯ï¼Œå¦‚æœå‡è®¾é©¬å°”å¯å¤«é“¾å¤„äºç¨³æ€ï¼Œè¿™æ—¶å­˜åœ¨ï¼š\n\n$$ P(X_0=i,X_1=j)=P(X_0=j,X_1=i) $$\n\nç”±å…¨æ¦‚ç‡å…¬å¼å¯çŸ¥ï¼›\n\n> **Time Reversibility**\n> \n> An irreducible Markov chain with transition matrix P and stationary distribution $\\boldsymbol{\\pi}$, if\n> $$ \\pi_iP_{ij}=\\pi_jP_{ji},\\forall i,j $$\n\n\nEx 3.23; \n\nEx 3.24ï¼›Simple random walk on a graph is time \n\n\n\n#### 3.7.2 Reversible Markov Chains and Radom walk\n\nEvery reversible Markov chain can be considered as a random walk on a weighted graph\n\nEx 3.25 ç®—ä¾‹ï¼›\n\n#### 3.7.3 The key benifit of reversibility\n\n> **Proposition 3.9** Let $\\boldsymbol{P}$ be the transition matrix of a Markov chain. If $\\boldsymbol{x}$ is a probability distribution which satisfies\n> $$ x_iP_{ij}=x_jP_{ji},\\forall i,j $$\n> then $\\boldsymbol{x}$ is the stationary distribution, and the markov chain is reversible.\n\nEx 3.26 **Birth-and-death chain**\n\nCase: random walk with a partialy relecting boundary.\n\n### 3.8 Absorbing Chains\n\n#### 3.8.1 å®šä¹‰\n\n> **Absorbing State, Absorbing Chain**\n> \n> State $i$ is an absorbing state if $P_{ii}=1$. A Markov chain is called an absorbing chain if it has at leat one absorbing state.\n\næ ¹æ®è¿™ä¸ªå®šä¹‰ï¼Œä¸€ä¸ªå¸æ”¶çš„é©¬å°”å¯å¤«é“¾çš„canoical decompostionå¯ä»¥å†™ä¸ºï¼š\n$$\n  \\boldsymbol{P} = \\lim_{n\\rightarrow\\infty} \\boldsymbol{P}^n=\n\t\\left(\n\t\\begin{array}{c|c}\n\t\\boldsymbol{Q} & \\boldsymbol{R} \\\\\n  \\hline\n  \\boldsymbol{O} & \\boldsymbol{I}\n\t\\end{array}\n\t\\right)\n$$\n\nEx 3.31\n\n#### 3.8.2 Expected Number of Visits to Transient States\n\n> **Theorem 3.11** Consider an absorbing Markov chain with t transient states. Let $\\boldsymbol{F}$ be a $t\\times t$ matrix indexed by transient states. where $F_{ij}$ is the expected number of visits to $j$ given that the chain starts in $i$, Then, \n> $$F=(I-Q)^{-1}$$\n\n#### 3.8.3 Expected Time to Absorption\n\n> **Absorbing Markov Chains**\n> For an absorbing Markov chain with all states either transient or absorbing. Let $F=(I-Q)^{-1}$\n> 1. (Absorption probability) The probability that from transient state $i$ the chain is absorbed in state $j$ is $(FR)_{ij}$\n> 2. (Absorption time) The expected number of steps from transient state $i$ until the chain is absorbed in some absorbing state is $(F1)_i$  \n\n#### 3.8.4 Expected Hitting Time for Irreducible chain\n\n#### 3.8.5 Patterns in Sequences\n\n#### 3.9 Regenration and strong Markov property\n\n#### 3.10 Proofs of limiting Theorem\n\nå‰©ä¸‹çš„éƒ½æ˜¯å¸¸è§„å†…å®¹ã€‚ä¸å†èµ˜è¿°ã€‚\n\næ€»çš„æ¥è¯´ï¼Œè¿™ä¸€ç« çš„ç« èŠ‚ç»„ç»‡å¾ˆæœ‰æ¡ç†ï¼Œå¯¹åˆå­¦è€…å‹å¥½ã€‚è€Œä¸”é€‰çš„ä¾‹å­å¾ˆæœ‰å¯å‘æ€§ã€‚\n\n---\né¢˜å¤–è¯ï¼š\n\næœ‰ä¸ªå€¼å¾—æ€è€ƒçš„é—®é¢˜ï¼Œè¿™ç§åå‘åº”ç”¨çš„æ•°å­¦å†…å®¹çš„æ•™æï¼Œå¦‚ä½•å¹³è¡¡è®ºè¿°çš„é€»è¾‘ï¼Œç†è®ºä»¥åŠæ€è€ƒçš„æ·±åº¦ï¼Œä»¥åŠåº”ç”¨çš„å¹¿åº¦ï¼Œä»¥åŠå¯¹äºè¯»è€…çš„å¸å¼•æ€§å’Œå®ç”¨æ€§ï¼Œéƒ½æ˜¯å¾ˆéœ€è¦åŠŸåº•çš„ã€‚ä½†æ˜¯è¿™æ–¹é¢åšçš„å¥½çš„æ•™æçœŸçš„å¤ªå°‘äº†ã€‚\n\nç†æƒ³çš„å¤§å­¦æ•™å¸ˆï¼Œæ˜¯å­¦æœ¯æˆå°±å’Œæ•™å­¦æˆå°±éƒ½å¾ˆå‡ºè‰²ï¼Œä½†æ˜¯è¿™æ¯•ç«Ÿæ˜¯å°‘æ•°ã€‚\n\næœ‰ä¸€å¯¹å„¿ç›¸äº’çŸ›ç›¾çš„å‘½é¢˜ï¼š\n\n+ å¤§å­¦ç”Ÿåº”è¯¥æé«˜è‡ªå­¦èƒ½åŠ›ï¼Œä¸è¦æŒ‡æœ›è€å¸ˆæ‰‹æŠŠæ‰‹çš„æ•™ï¼Ÿ\n+ å›½å®¶ç»™äº†å¤§å­¦è€å¸ˆå·¥èµ„ï¼Œå¤§å­¦ç”Ÿä¹Ÿä»˜äº†å­¦è´¹ï¼Œå¦‚æœéƒ½é è‡ªå­¦çš„è¯ï¼Œè¦å¤§å­¦å¹²ä»€ä¹ˆï¼Ÿ\n\nä¾ç¬”è€…çœ‹æ¥ï¼Œå¤§å­¦æä¾›çš„æ˜¯ä¸€å¥—é€‚åˆå­¦ä¹ å’Œç ”ç©¶çš„ç¡¬ä»¶è®¾æ–½ï¼Œä¸€å¼ å¹³é™çš„ä¹¦æ¡Œï¼Œä¸€ç¾¤å¿—åŒé“åˆçš„è‰¯å¸ˆç›Šå‹ã€‚è¿™äº›ç¯å¢ƒå’Œäººï¼Œæ˜¯ä»»ä½•å…¶å®ƒæœºæ„æˆ–è€…ç½‘è¯¾ä»£æ›¿ä¸äº†çš„ã€‚","tags":["note","stochastic Process"],"categories":["math"]},{"url":"/2020/05/04/networkdata-quickstart/","content":"\næ‰€é€‰ä¾‹å­å‡ºè‡ª**Modern Statistics for Modern Biology**(Susan Holmes, Wolfgang\nHuber)\n\næ— å‘å›¾çš„é‚»æ¥çŸ©é˜µæ˜¯ä¸€ä¸ª0-1çŸ©é˜µï¼š\n\n```r\nlibrary(igraph)\nlibrary(ggplot2)\nlibrary(ggnetwork)\nlibrary(network)\nedges1 <- matrix(c(1,3,2,3,3,4,4,5,4,6),byrow = TRUE,ncol = 2)\n\n### generate adjacency matrix\nedges1 <- as.data.frame(edges1)\nmat <- matrix(data = 0,nrow = 6,ncol = 6)\nfor(ii in 1:6){\n  mat[edges1[ii,1],edges1[ii,2]] <- 1\n  mat[edges1[ii,2],edges1[ii,1]] <- 1\n}\n\n### Prepare data to plot\ndat_long <- reshape2::melt(mat)\ndat_long$value <- as.factor(dat_long$value)\ncolnames(dat_long) <- c(\"V1\",\"V2\",\"value\")\n### plot\ngg <- ggplot(dat_long)+\n  geom_tile(aes(V1,V2,fill=value), color=\"#7f7f7f\")+\n  scale_fill_manual(values=c(\"white\", \"black\"))+\n  coord_equal()+\n  labs(x=NULL, y=NULL)+\n  scale_x_continuous(breaks = 1:6)+\n  scale_y_reverse(breaks=1:6)+\n  theme_bw()+\n  theme(panel.grid=element_blank())+\n  theme(panel.border=element_blank())\ngg\n```\n\n<img src=\"/figure/posts/networkdata_quickstart_files/figure-gfm/unnamed-chunk-1-1.png\" style=\"display: block; margin: auto;\" />\n\nä»é‚»æ¥çŸ©é˜µå¾—åˆ°Graph:\n\n``` r\ng1 <- graph_from_adjacency_matrix(mat,mode = \"undirected\")\nplot(g1,vertex.size=25,edge.width=5,vertex.color=\"coral\")\n```\n\n<img src=\"/figure/posts/networkdata_quickstart_files/figure-gfm/unnamed-chunk-2-1.png\" style=\"display: block; margin: auto;\" />\n\nç»™å®šedgelistï¼Œå¾—åˆ°Graph\n\n``` r\nedges1 <- matrix(c(1,3,2,3,3,4,4,5,4,6),byrow = TRUE,ncol = 2)\ng1 <- graph_from_edgelist(edges1,directed = F)\nplot(g1,vertex.size=25,edge.width=5,vertex.color=\"coral\")\n```\n\n<img src=\"/figure/posts/networkdata_quickstart_files/figure-gfm/unnamed-chunk-3-1.png\" style=\"display: block; margin: auto;\" />\n\næ›´ä¸ºé«˜çº§çš„æ˜¯ï¼Œä»æ•°æ®ä¸­è®¡ç®—å‡ºé‚»æ¥çŸ©é˜µï¼Œå¹¶ä¸”è‡ªå®šä¹‰å¯è§†åŒ–çš„layoutã€‚\n\n``` r\nlibrary(rworldmap)\n### obtain data; get the binary matrix\nload(\"D:/tmp/Moderstatdata/data/dist2009c.RData\")\ncountry09 = attr(dist2009c, \"Label\")\nmstree2009 = ape::mst(dist2009c)\n\n### calculate layout from world map\nmat = match(country09, countriesLow$NAME)\ncoords2009 = data.frame(\n  lat = countriesLow$LAT[mat],\n  lon = countriesLow$LON[mat],\n  country = country09)\nlayoutCoordinates = cbind(\n  x = jitter(coords2009$lon, amount = 15),\n  y = jitter(coords2009$lat, amount = 8))\nlabc = names(table(country09)[which(table(country09) > 1)])\nmatc = match(labc, countriesLow$NAME)\ndfc = data.frame(\n  latc = countriesLow$LAT[matc],\n  lonc = countriesLow$LON[matc],\n  labc)\ndfctrans = dfc\ndfctrans[, 1] = (dfc[,1] + 31) / 93\ndfctrans[, 2] = (dfc[,2] + 105) / 238\nggeo09 = ggnetwork(mstree2009, arrow.gap = 0, layout = layoutCoordinates)\n###plot\nggplot(ggeo09, aes(x = x, y = y, xend = xend, yend = yend)) +\n  geom_edges(color = \"black\", alpha = 0.5, curvature = 0.1) +\n  geom_nodes(aes(color = vertex.names), size = 2) +\n  theme_blank() +\n  geom_label(data = dfctrans, aes(x = lonc, xend = lonc, y = latc, yend = latc,\n       label = labc, fill = labc), colour = \"white\", alpha = 0.5, size = 3) +\n   theme(legend.position = \"none\")\n```\n\n![](/figure/posts/networkdata_quickstart_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->\n","tags":["R","Graph","Network"],"categories":["implementation"]},{"title":"Calculate pi in R quikstart","url":"/2020/04/24/Calculate-pi-in-R-quikstart/","content":"\n\nRä¸­ä¹Ÿå¯ä»¥ç”¨`Rmpfr`åŒ…å®ç°å¤šç²¾åº¦çš„è®¡ç®—ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹ä»£ç å®ç°AGMç®—æ³•è®¡ç®—Piåˆ°å°æ•°ç‚¹å256ä½ã€‚\n\n``` r\nlibrary(Rmpfr)\npiMpfr <- function(prec=256, itermax = 100, verbose=TRUE) {\n  m2 <- mpfr(2, prec) # '2' as mpfr number\n  ## -> all derived numbers are mpfr (with precision 'prec')\n  p <- m2 + sqrt(m2) # 2 + sqrt(2) = 3.414..\n  y <- sqrt(sqrt(m2)) # 2^ {1/4}\n  x <- (y+1/y) / m2\n  it <- 0L\n  repeat {\n    p.old <- p\n    it <- it+1L\n    p <- p * (1+x) / (1+y)\n    if(verbose) cat(sprintf(\"it=%2d, pi^ = %s, |.-.|/|.|=%e\\n\",\n                            it, formatMpfr(p, min(50, prec/log2(10))), 1-p.old/p))\n    if (abs(p-p.old) <= m2^(-prec))\n      break\n    if(it > itermax) {\n      warning(\"not converged in\", it, \"iterations\") ; break\n    }\n    ## else\n    s <- sqrt(x)\n    y <- (y*s + 1/s) / (1+y)\n    x <- (s+1/s)/2\n  }\n  p\n}\npiMpfr(prec = 256)\n```\n\n    ## it= 1, pi^ = 3.1426067539416226007907198236183018919713562462772, |.-.|/|.|=-8.642723e-02\n    ## it= 2, pi^ = 3.1415926609660442304977522351203396906792842568645, |.-.|/|.|=-3.227958e-04\n    ## it= 3, pi^ = 3.1415926535897932386457739917571417940347896238675, |.-.|/|.|=-2.347934e-09\n    ## it= 4, pi^ = 3.1415926535897932384626433832795028841972241204666, |.-.|/|.|=-5.829228e-20\n    ## it= 5, pi^ = 3.1415926535897932384626433832795028841971693993751, |.-.|/|.|=-1.741826e-41\n    ## it= 6, pi^ = 3.1415926535897932384626433832795028841971693993751, |.-.|/|.|=0.000000e+00\n\n    ## 1 'mpfr' number of precision  256   bits \n    ## [1] 3.141592653589793238462643383279502884197169399375105820974944592307816406286163\n","tags":["R"],"categories":["implementation"]},{"title":"A Hard Rain's A-Gonna Fall","url":"/2020/04/20/A-Hard-Rain-s-A-Gonna-Fall/","content":"\n*A Hard Rain's A-Gonna Fall*æ˜¯ç¾å›½å›½å®çº§æ­Œæ‰‹ï¼Œè¯—äººï¼Œè¯ºè´å°”æ–‡å­¦å¥–å¾—ä¸»Bob Dylançš„åæ›²ä¹‹ä¸€ï¼Œè™½ç„¶åŸå”±è¯´ä¸ä¸Šå¤šä¹ˆå¥½å¬ï¼Œä½†æ˜¯æ­Œè¯å¾ˆæœ‰æ„å¢ƒï¼Œåˆ†äº«å¦‚ä¸‹ï¼š\n\n> A Hard Rain's A-Gonna Fall\n> \n> Bob Dylan\n> \n> Oh, where have you been, my blue-eyed son?\n> \n> Oh, where have you been, my darling young one?\n> \n> I've stumbled on the side of twelve misty mountains\n> \n> I've walked and I've crawled on six crooked highways\n> \n> I've stepped in the middle of seven sad forests\n> \n> I've been out in front of a dozen dead oceans\n> \n> I've been ten thousand miles in the mouth of a graveyard\n> \n> And it's a hard, and it's a hard, it's a hard, and it's a hard\n> And it's a hard rain's a-gonna fall\n> \n> Oh, what did you see, my blue-eyed son?\n> \n> Oh, what did you see, my darling young one?\n> \n> I saw a newborn baby with wild wolves all around it\n> \n> I saw a highway of diamonds with nobody on it\n> \n> I saw a black branch with blood that kept drippin'\n> \n> I saw a room full of men with their hammers a-bleedin'\n> \n> I saw a white ladder all covered with water\n> \n> I saw ten thousand talkers whose tongues were all broken\n> \n> I saw guns and sharp swords in the hands of young children\n> \n> And it's a hard, and it's a hard, it's a hard, it's a hard\n> \n> And it's a hard rain's a-gonna fall\n> \n> And what did you hear, my blue-eyed son?\n> \n> And what did you hear, my darling young one?\n> \n> I heard the sound of a thunder, it roared out a warnin'\n> \n> Heard the roar of a wave that could drown the whole world\n> \n> Heard one person starve, I heard many people laughin'\n> \n> Heard the song of a poet who died in the gutter\n> \n> Heard the sound of a clown who cried in the alley\n> \n> And it's a hard, and it's a hard, it's a hard, it's a hard\n> \n> And it's a hard rain's a-gonna fall\n> \n> Oh, who did you meet, my blue-eyed son?\n> \n> Who did you meet, my darling young one?\n> \n> I met a young child beside a dead pony\n> \n> I met a white man who walked a black dog\n> \n> I met a young woman whose body was burning\n> \n> I met a young girl, she gave me a rainbow\n> \n> I met one man who was wounded in love\n> \n> I met another man who was wounded with hatred\n> \n> And it's a hard, it's a hard, it's a hard, it's a hard\n> \n> It's a hard rain's a-gonna fall\n> \n> Oh, what'll you do now, my blue-eyed son?\n> \n> Oh, what'll you do now, my darling young one?\n> \n> I'm a-goin' back out 'fore the rain starts a-fallin'\n> \n> I'll walk to the depths of the deepest black forest\n> \n> Where the people are many and their hands are all empty\n> \n> Where the pellets of poison are flooding their waters\n> \n> Where the home in the valley meets the damp dirty prison\n> \n> Where the executioner's face is always well-hidden\n> \n> Where hunger is ugly, where souls are forgotten\n> \n> Where black is the color, where none is the number\n> \n> And I'll tell it and think it and speak it and breathe it\n> \n> And reflect it from the mountain so all souls can see it\n> \n> Then I'll stand on the ocean until I start sinkin'\n> \n> But I'll know my song well before I start singin'\n> \n> And it's a hard, it's a hard, it's a hard, it's a hard\n> \n> It's a hard rain's a-gonna fall","tags":["art"],"categories":["others"]},{"title":"LearnSeurat_CITE_seq","url":"/2020/04/20/LearnSeurat_CITEseq/","content":"\n### å‰è¨€\n\nCITE-seqæ˜¯Rahul Satijaå’ŒPeter\nSmibertä¸¤ä¸ªç»„åˆä½œå¼€å‘çš„åœ¨å•ç»†èƒç²¾åº¦ï¼ŒåŒæ—¶æµ‹é‡ç»†èƒè¡¨é¢è›‹ç™½è¡¨è¾¾å’Œè½¬å½•ç»„çš„[æŠ€æœ¯](https://www.nature.com/articles/nmeth.4380)ã€‚è¯¥æŠ€æœ¯åŸç†å¦‚ä¸‹ï¼š\n\n![CITE-seqåŸç†å›¾ï¼Œç”¨æŠ—ä½“æ¥æºæ ‡ç­¾ï¼Œå®ç°ç»†èƒè¡¨é¢è›‹ç™½å®šé‡](https://imgkr.cn-bj.ufileos.com/b7e96d47-230d-4519-a758-c3aa23939b18.png)\n\nè¯¥é¡¹æŠ€æœ¯å¯ä»¥ç”¨äºå…ç–«ç›¸å…³çš„å•ç»†èƒæµ‹åºç ”ç©¶ä¸­ã€‚ä¾‹å¦‚,\næœ‰[ç ”ç©¶è¡¨æ˜](https://www.nature.com/articles/s41586-020-2134-y)ç§°ï¼š\n\n> ä»–ä»¬åœ¨äººå’Œå°é¼ éå°ç»†èƒè‚ºç™Œä¸­è¿›è¡Œå•ç»†èƒRNAæµ‹åºï¼Œé‰´å®šäº†ä¸€ç¾¤DCï¼Œå¹¶å°†å…¶å‘½åä¸ºâ€œå¯Œå«å…ç–«è°ƒèŠ‚åˆ†å­çš„æˆç†ŸDCâ€ï¼ˆmregDCï¼‰ï¼Œè¿™æ˜¯ç”±äºå®ƒä»¬å…±è¡¨è¾¾äº†å…ç–«è°ƒèŠ‚åŸºå› ï¼ˆCd274ï¼ŒPdcd1lg2å’ŒCd200ï¼‰å’Œæˆç†ŸåŸºå› ï¼ˆCd40ï¼ŒCcr7å’ŒIl12bï¼‰ã€‚\n\nè¿™æ®µä¸­æ–‡æŠ¥é“æ¥è‡ª[å°æŸ¯æœºå™¨äºº](http://news.sciencenet.cn/htmlpaper/2020/3/20203301537131655622.shtm)\n\nRahul\nSatijaç»„å¼€å‘çš„è½¯ä»¶Seuratæœ‰ä¸€ä¸ª[æ•™ç¨‹](https://satijalab.org/seurat/v3.1/multimodal_vignette.html)ï¼Œå¯ä»¥åˆ†æCITE-seqæ•°æ®ã€‚æœ¬æ–‡åŸºäºè¯¥æ•™ç¨‹å¯¹è¯¥ç±»å‹æ•°æ®çš„åˆ†æè¿›è¡Œè¯´æ˜ã€‚\n\n### æ•°æ®è½½å…¥\n\né¦–å…ˆæˆ‘ä»¬éœ€è¦è·å–æ•°æ®ï¼Œè¯¥æ•°æ®é›†å–æ ·ä¸º8617ä¸ªè„å¸¦è¡€å•æ ¸ç»†èƒï¼ŒåŒ…å«äº†è¡¨è¾¾è°±æ•°æ®å’Œ11ä¸ªæŠ—ä½“æ¥æºæ ‡ç­¾æ•°æ®ï¼ˆantibody-derived\ntags ,ADT)ã€‚\n\n``` r\nlibrary(Seurat)\nlibrary(SeuratData)\nlibrary(ggplot2)\nlibrary(patchwork)\n### AvailableData() check avaliable data: we choose cbmc\n### InstallData('cbmc')\nlibrary(cbmc.SeuratData)\ndata(\"cbmc\")\n### expression matrix\ncbmc[[\"RNA\"]]@counts[1:10,1:10]\n```\n\n    ## 10 x 10 sparse Matrix of class \"dgCMatrix\"\n    ##                             \n    ## A1BG     . . . . . . . . . .\n    ## A1BG-AS1 . . . . . . . . . .\n    ## A1CF     . . . . . . . . . .\n    ## A2M      . . . . . . . . . .\n    ## A2M-AS1  . . . . . . . 1 . .\n    ## A2ML1    . . . . . . . . . .\n    ## A4GALT   . . . . . . . . . .\n    ## A4GNT    . . . . . . . . . .\n    ## AAAS     . . . . . . . . . 1\n    ## AACS     . . . . . . . . . .\n\n``` r\n### ADT count matrix\n### Actually there are just 10 surface protein\ncbmc[[\"ADT\"]]@counts[1:10,1:10] \n```\n\n    ## 10 x 10 sparse Matrix of class \"dgCMatrix\"\n    ##                                                \n    ## CD3     60   52  89  55  63  82  53  42 103  56\n    ## CD4     72   49 112  66  80  78  63  59 122  70\n    ## CD8     76   59  61  56  94  57  61  55  64  80\n    ## CD45RA 575 3943 682 378 644 479 487 472 540 535\n    ## CD56    64   68  87  58 104  44  64  48 136  91\n    ## CD16   161  107 117  82 168  92  77  99 235 131\n    ## CD11c   77   65  65  44  92  63  70  75 106  69\n    ## CD14   206  129 169 136 164 122 112 111 206 204\n    ## CD19    70  665  79  49  81  44  60  58  61 107\n    ## CD34   179   79  78  83 152 103  79  86 144 193\n\n``` r\n### show default assay\nDefaultAssay(cbmc)\n```\n\n    ## [1] \"RNA\"\n\n### æ ¹æ®åŸºå› è¡¨è¾¾è¿›è¡Œèšç±»\n\næ³¨æ„åœ¨é»˜è®¤å‚æ•°çš„æƒ…å†µä¸‹ï¼Œä¸‹è¿°æ“ä½œæ—¶å¯¹`Default Assay`è¿›è¡Œçš„\n\n``` r\n# standard log-normalization\ncbmc <- NormalizeData(cbmc)\n# choose ~1k variable features\ncbmc <- FindVariableFeatures(cbmc)\n# standard scaling (no regression)\ncbmc <- ScaleData(cbmc)\n# Run PCA, select 13 PCs for tSNE visualization and graph-based clustering\ncbmc <- RunPCA(cbmc, verbose = FALSE)\n```\n\nä¸‹é¢çš„å›¾æ˜¯æ ¹æ®æ ‡å‡†å·®æ¥é€‰æ‹©PCs\n\n``` r\nElbowPlot(cbmc, ndims = 50)\n```\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-3-1.png\" style=\"display: block; margin: auto;\" />\n\nèšç±»å’Œt-SNEé™ç»´\n\n``` r\ncbmc <- FindNeighbors(cbmc, dims = 1:25)\ncbmc <- FindClusters(cbmc, resolution = 0.8)\n```\n\n    ## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n    ## \n    ## Number of nodes: 8617\n    ## Number of edges: 347548\n    ## \n    ## Running Louvain algorithm...\n    ## Maximum modularity in 10 random starts: 0.8592\n    ## Number of communities: 19\n    ## Elapsed time: 3 seconds\n\n``` r\ncbmc <- RunTSNE(cbmc, dims = 1:25, method = \"FIt-SNE\")\n\n# Find the markers that define each cluster, and use these to annotate the clusters, we use\n# max.cells.per.ident to speed up the process\ncbmc.rna.markers <- FindAllMarkers(cbmc, max.cells.per.ident = 100, min.diff.pct = 0.3, only.pos = TRUE)\n\n# Note, for simplicity we are merging two CD14+ Monocyte clusters (that differ in expression of\n# HLA-DR genes) and NK clusters (that differ in cell cycle stage)\nnew.cluster.ids <- c(\"Memory CD4 T\", \"CD14+ Mono\", \"Naive CD4 T\", \"NK\", \"CD14+ Mono\", \"Mouse\", \"B\", \n    \"CD8 T\", \"CD16+ Mono\", \"T/Mono doublets\", \"NK\", \"CD34+\", \"Multiplets\", \"Mouse\", \"Eryth\", \"Mk\", \n    \"Mouse\", \"DC\", \"pDCs\")\nnames(new.cluster.ids) <- levels(cbmc)\ncbmc <- RenameIdents(cbmc, new.cluster.ids)\n```\n\næˆ‘ä»¬çœ‹çœ‹èšç±»ç»“æœï¼š\n\n``` r\nDimPlot(cbmc, label = TRUE) + NoLegend()\n```\n\n    ## Warning: Using `as.character()` on a quosure is deprecated as of rlang 0.3.0.\n    ## Please use `as_label()` or `as_name()` instead.\n    ## This warning is displayed once per session.\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-5-1.png\" style=\"display: block; margin: auto;\" />\n\n### è›‹ç™½è¡¨è¾¾æ•°æ®å¤„ç†\n\nSeurat3çš„assayå®ç°å¤šä¸ªç»„å­¦æˆ–è€…æ¨¡æ€çš„æ•°æ®çš„å­˜å‚¨å’Œè·å–ã€‚ ä»£ç é‡Œçš„æ³¨é‡Šæ¥è‡ªSeuratå®˜ç½‘ã€‚\n\n``` r\n# Now we can repeat the preprocessing (normalization and scaling) steps that we typically run\n# with RNA, but modifying the 'assay' argument.  For CITE-seq data, we do not recommend typical\n# LogNormalization. Instead, we use a centered log-ratio (CLR) normalization, computed\n# independently for each feature.  This is a slightly improved procedure from the original\n# publication, and we will release more advanced versions of CITE-seq normalizations soon.\ncbmc <- NormalizeData(cbmc, assay = \"ADT\", normalization.method = \"CLR\")\ncbmc <- ScaleData(cbmc, assay = \"ADT\")\n```\n\nåœ¨RNAè¡¨è¾¾è°±çš„é™ç»´Embeddingä¸­åŒæ—¶å±•ç¤ºå±•ç¤ºè›‹ç™½è¡¨è¾¾æ°´å¹³å’ŒåŸºå› è¡¨è¾¾æ°´å¹³ï¼š\n\næ•£ç‚¹å›¾ï¼šæ¨ªçºµè½´ä¸ºé™ç»´çš„åæ ‡ï¼š\n\n``` r\n# in this plot, protein (ADT) levels are on top, and RNA levels are on the bottom\nFeaturePlot(cbmc, \n            features = c(\"adt_CD3\", \"adt_CD11c\", \n                         \"adt_CD8\", \"adt_CD16\", \n                         \"CD3E\", \"ITGAX\", \"CD8A\", \"FCGR3A\"),\n            min.cutoff = \"q05\", \n            max.cutoff = \"q95\", \n            ncol = 2)\n```\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-7-1.png\" style=\"display: block; margin: auto;\" />\n\nRidge Plot:\n\n``` r\nRidgePlot(cbmc, features = c(\"adt_CD3\", \"adt_CD8\", \"CD3E\",\"CD8A\"),ncol = 2)\n```\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-8-1.png\" style=\"display: block; margin: auto;\" />\n\næ•£ç‚¹å›¾ï¼šæ¨ªçºµè½´ä¸ºè¡¨è¾¾é‡ï¼›è¿™ä¸ªç±»ä¼¼äºFACS\n\n``` r\n# Draw ADT scatter plots (like biaxial plots for FACS). Note that you can even 'gate' cells if\n# desired by using HoverLocator and FeatureLocator\nFeatureScatter(cbmc, feature1 = \"adt_CD19\", feature2 = \"adt_CD3\")\n```\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-9-1.png\" style=\"display: block; margin: auto;\" />\n\næˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹çœ‹è›‹ç™½è¡¨è¾¾å’ŒåŸºå› è¡¨è¾¾çš„å…³ç³»ï¼š\n\n``` r\n# view relationship between protein and RNA\nFeatureScatter(cbmc, feature1 = \"adt_CD3\", feature2 = \"CD3E\")\n```\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-10-1.png\" style=\"display: block; margin: auto;\" />\n\næˆ‘ä»¬å¯ä»¥çœ‹çœ‹Tç»†èƒï¼š\n\n``` r\n# Let's plot CD4 vs CD8 levels in T cells\ntcells <- subset(cbmc, idents = c(\"Naive CD4 T\", \"Memory CD4 T\", \"CD8 T\"))\nFeatureScatter(tcells, feature1 = \"adt_CD4\", feature2 = \"adt_CD8\")\n```\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-11-1.png\" style=\"display: block; margin: auto;\" />\n\né€‰æ²¡æœ‰æ ‡å‡†åŒ–çš„åŸå§‹æ•°æ®æˆ‘ä»¬çœ‹çœ‹ï¼Œåæ ‡è½´çš„é—´è·å¤ªå¤§ï¼Œä¼šæœ‰misleading\n\n``` r\n# # Let's look at the raw (non-normalized) ADT counts. You can see the values are quite high,\n# particularly in comparison to RNA values. This is due to the significantly higher protein copy\n# number in cells, which significantly reduces 'drop-out' in ADT data\nFeatureScatter(tcells, feature1 = \"adt_CD4\", feature2 = \"adt_CD8\", slot = \"counts\")\n```\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-12-1.png\" style=\"display: block; margin: auto;\" />\n\nè¿™é‡Œè¿˜æ˜¯å¯ä»¥è§‚å¯Ÿåˆ°dropoutsç°è±¡çš„ï¼Œæ®åŸä½œè€…è¯´ï¼š \\> If you look a bit more closely, youâ€™ll\nsee that our CD8 T cell cluster is enriched for CD8 T cells, but still\ncontains many CD4+ CD8- T cells. This is because Naive CD4 and CD8 T\ncells are quite similar transcriptomically, and the RNA dropout levels\nfor CD4 and CD8 are quite high. This demonstrates the challenge of\ndefining subtle immune cell differences from scRNA-seq data alone.\n\nç”»çƒ­å›¾ï¼ŒSeurat3 åŠ äº† downsampleçš„åŠŸèƒ½ã€‚\n\n``` r\n# Downsample the clusters to a maximum of 300 cells each (makes the heatmap easier to see for small clusters)\ncbmc.small <- subset(cbmc, downsample = 300)\n# Find protein markers for all clusters, and draw a heatmap\nadt.markers <- rownames(cbmc.small[[\"ADT\"]]@counts)\n```\n\næˆ‘ä»¬å¯ä»¥çœ‹çœ‹Seuratçƒ­å›¾çš„é»˜è®¤é…è‰²ï¼ˆä¸‰ä¸ªå†’å·å¯ä»¥çœ‹æ›´ä¸ºåº•å±‚çš„å‡½æ•°ï¼‰, ä¸ªäººè§‰å¾—å¹¶ä¸å¥½çœ‹ã€‚\n\n``` r\n# using code from RColorBrewer to demo the palette\nn = 200\npar(mfrow=c(3,1))\nimage(\n  1:n, 1, as.matrix(1:n),\n  col = Seurat:::PurpleAndYellow(k=n),\n  xlab = \"PurpleAndYellow n\", ylab = \"\", xaxt = \"n\", yaxt = \"n\", bty = \"n\"\n)\nimage(\n  1:n, 1, as.matrix(1:n),\n  col = colorRampPalette(c(\"navy\", \"white\", \"firebrick3\"))(n),\n  xlab = \"NavyWhite3Firebrick3 n\", ylab = \"\", xaxt = \"n\", yaxt = \"n\", bty = \"n\"\n)\nimage(\n  1:n, 1, as.matrix(1:n),\n  col = colorRampPalette(RColorBrewer::brewer.pal(11,\"RdBu\"))(n),\n  xlab = \"RdBu n\", ylab = \"\", xaxt = \"n\", yaxt = \"n\", bty = \"n\"\n)\n```\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-14-1.png\" style=\"display: block; margin: auto;\" />\n\næŠŠé»˜è®¤é…è‰²æ¢æ‰,è§\n\n``` r\nmypal <- rev(colorRampPalette(RColorBrewer::brewer.pal(11,\"RdBu\"))(256))\n#mypal2 <- colorRampPalette(c(\"navy\", \"white\", \"firebrick3\"))(256)\nDoHeatmap(cbmc.small, \n          features = unique(adt.markers), \n          assay = \"ADT\", \n          angle = 90,size = 3)+\n  scale_fill_gradientn(colors  = mypal)\n```\n\n    ## Scale for 'fill' is already present. Adding another scale for 'fill', which\n    ## will replace the existing scale.\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-15-1.png\" style=\"display: block; margin: auto;\" />\n\nå»é™¤ç»†èƒæ‚è´¨ï¼Œ\n\n``` r\n# You can see that our unknown cells co-express both myeloid and lymphoid markers (true at the\n# RNA level as well). They are likely cell clumps (multiplets) that should be discarded. We'll\n# remove the mouse cells now as well\ncbmc <- subset(cbmc, idents = c(\"Multiplets\", \"Mouse\"), invert = TRUE)\n```\n\n### ç›´æ¥æ ¹æ®è›‹ç™½è´¨è¡¨è¾¾æ°´å¹³è¿›è¡Œèšç±»\n\n``` r\n# Because we're going to be working with the ADT data extensively, we're going to switch the\n# default assay to the 'CITE' assay.  This will cause all functions to use ADT data by default,\n# rather than requiring us to specify it each time\nDefaultAssay(cbmc) <- \"ADT\"\ncbmc <- RunPCA(cbmc, features = rownames(cbmc), reduction.name = \"pca_adt\", reduction.key = \"pca_adt_\", \n    verbose = FALSE)\n```\n\nå†æ¥çœ‹PCA(å…¶å®è¿™é‡Œç®—æ˜¯degenrateåˆ°çº¿æ€§ç»„åˆäº†)\n\n``` r\nDimPlot(cbmc, reduction = \"pca_adt\")\n```\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-18-1.png\" style=\"display: block; margin: auto;\" />\n\n``` r\n# Since we only have 10 markers, instead of doing PCA, we'll just use a standard euclidean\n# distance matrix here.  Also, this provides a good opportunity to demonstrate how to do\n# visualization and clustering using a custom distance matrix in Seurat\nadt.data <- GetAssayData(cbmc, slot = \"data\")\nadt.dist <- dist(t(adt.data))\n\n# Before we recluster the data on ADT levels, we'll stash the RNA cluster IDs for later\ncbmc[[\"rnaClusterID\"]] <- Idents(cbmc)\n\n# Now, we rerun tSNE using our distance matrix defined only on ADT (protein) levels.\ncbmc[[\"tsne_adt\"]] <- RunTSNE(adt.dist, assay = \"ADT\", reduction.key = \"adtTSNE_\")\ncbmc[[\"adt_snn\"]] <- FindNeighbors(adt.dist)$snn\ncbmc <- FindClusters(cbmc, resolution = 0.2, graph.name = \"adt_snn\")\n```\n\n    ## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n    ## \n    ## Number of nodes: 7895\n    ## Number of edges: 258146\n    ## \n    ## Running Louvain algorithm...\n    ## Maximum modularity in 10 random starts: 0.9491\n    ## Number of communities: 11\n    ## Elapsed time: 2 seconds\n\n``` r\n# We can compare the RNA and protein clustering, and use this to annotate the protein clustering\n# (we could also of course use FindMarkers)\nclustering.table <- table(Idents(cbmc), cbmc$rnaClusterID)\nclustering.table\n```\n\n    ##     \n    ##      Memory CD4 T CD14+ Mono Naive CD4 T   NK    B CD8 T CD16+ Mono\n    ##   0          1754          0        1217   29    0    27          0\n    ##   1             0       2189           0    4    0     0         30\n    ##   2             3          0           2  890    3     1          0\n    ##   3             0          4           0    2  319     0          2\n    ##   4            24          0          18    4    1   243          0\n    ##   5             1         27           4  157    2     2         10\n    ##   6             4          5           0    1    0     0          0\n    ##   7             4         59           4    0    0     0          9\n    ##   8             0          9           0    2    0     0        179\n    ##   9             0          0           1    0    0     0          0\n    ##   10            1          0           2    0   25     0          0\n    ##     \n    ##      T/Mono doublets CD34+ Eryth   Mk   DC pDCs\n    ##   0                5     2     4   24    1    2\n    ##   1                1     1     5   25   55    0\n    ##   2                0     1     3    7    2    1\n    ##   3                0     2     2    3    0    0\n    ##   4                0     0     1    2    0    0\n    ##   5               56     0     9   16    6    2\n    ##   6                1   113    81   16    5    0\n    ##   7              117     0     0    2    0    1\n    ##   8                0     0     0    1    0    0\n    ##   9                0     0     0    0    1   43\n    ##   10               2     0     0    0    0    0\n\nä¸‹é¢è¿™ä¸ªembeding è¿˜æ˜¯æ ¹æ®ADTæ¥çš„ï¼ˆä¸è¿‡åªè¦markerè¿ç»­ï¼Œåªæœ‰10ä¸ªä¹Ÿæ²¡æœ‰å…³ç³»ï¼Ÿï¼‰\n\n``` r\nnew.cluster.ids <- c(\"CD4 T\", \"CD14+ Mono\", \"NK\", \"B\", \"CD8 T\", \"NK\", \"CD34+\", \"T/Mono doublets\", \n    \"CD16+ Mono\", \"pDCs\", \"B\")\nnames(new.cluster.ids) <- levels(cbmc)\ncbmc <- RenameIdents(cbmc, new.cluster.ids)\n\ntsne_rnaClusters <- DimPlot(cbmc, reduction = \"tsne_adt\", group.by = \"rnaClusterID\") + NoLegend()\ntsne_rnaClusters <- tsne_rnaClusters + ggtitle(\"Clustering based on scRNA-seq\") + theme(plot.title = element_text(hjust = 0.5))\ntsne_rnaClusters <- LabelClusters(plot = tsne_rnaClusters, id = \"rnaClusterID\", size = 4)\n\ntsne_adtClusters <- DimPlot(cbmc, reduction = \"tsne_adt\", pt.size = 0.5) + NoLegend()\ntsne_adtClusters <- tsne_adtClusters + ggtitle(\"Clustering based on ADT signal\") + theme(plot.title = element_text(hjust = 0.5))\ntsne_adtClusters <- LabelClusters(plot = tsne_adtClusters, id = \"ident\", size = 4)\n\n# Note: for this comparison, both the RNA and protein clustering are visualized on a tSNE\n# generated using the ADT distance matrix.\nwrap_plots(list(tsne_rnaClusters, tsne_adtClusters), ncol = 2)\n```\n\n<img src=\"/figure/posts/LearnSeurat_CITEseq_files/figure-gfm/unnamed-chunk-20-1.png\" style=\"display: block; margin: auto;\" />\nå¯¹äºè¯¥ç»“æœï¼Œä½œè€…æ˜¯è¿™ä¹ˆè§£é‡Šçš„ï¼š\n\n> The ADT-based clustering yields similar results, but with a few\n> differences + Clustering is improved for CD4/CD8 T cell populations,\n> based on the robust ADT data for + CD4, CD8, CD14, and CD45RA +\n> However, some clusters for which the ADT data does not contain good\n> distinguishing protein markers (i.e.Â Mk/Ery/DC) lose separation You\n> can verify this using FindMarkers at the RNA level, as well\n\n### æ›´å¤š\n\npbmc\n10kçš„ç»†èƒä¹Ÿæä¾›äº†CITE-seqçš„å¤šæ¨¡æ€æ•°æ®ï¼Œå…·ä½“ç»†èŠ‚ï¼Œè¯·çœ‹Seuratå®˜æ–¹[æ•™ç¨‹](https://satijalab.org/seurat/v3.1/multimodal_vignette.html)ã€‚\n","tags":["R","scRNA-seq","sc-seq"],"categories":["implementation"]},{"title":"Learn-igraph-Basic","url":"/2020/04/20/Learnigraph-1-ManuNetworkDataBasic/","content":"\n*Learn-igraph*ç³»åˆ—æ˜¯å¯¹[Statistical Analysis of Network Data with\nR](https://link.springer.com/book/10.1007/978-1-4939-0983-4)ä¸€ä¹¦çš„å­¦ä¹ ç¬”è®°ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨Rè¿›è¡Œç½‘ç»œæ•°æ®åˆ†æï¼Œç½‘ç»œæ•°æ®çš„å¤„ç†ä¸»è¦æ˜¯åŸºäº`igraph`åŒ…ï¼Œå¯è§†åŒ–ç”¨çš„æ˜¯`ggnet`\n\n### 0. åŸºæœ¬æ¦‚å¿µ\n\nä¸€äº›éœ€è¦çŸ¥é“çš„åŸºæœ¬æ¦‚å¿µï¼›\n\n  - Network;\n\n  - Graph;\n\n  - Order of a graph;\n\n  - Size of a graph;\n\n  - directed graph;\n\n  - undirected graph;\n\n  - subgraph;\n\n### 1. åˆ›å»ºigraph class\n\n#### 1.1 æ— å‘å›¾\n\nigraphåŒ…å¤„ç†ç½‘ç»œå›¾çš„æ•°æ®ç»“æ„ä¸ºigraph class, æœ€åŸºç¡€çš„åˆ›å»ºæ–¹å¼å¦‚ä¸‹ï¼š\n\n``` r\nlibrary(igraph)\nlibrary(ggraph)\nlibrary(ggnetwork)\ng <- graph.formula(1-2,1-3,2-3,2-4,3-5,4-5,4-6,4-7,5-6,6-7)\nl <- layout.auto(g)\nplot(g, layout=l, vertex.color=\"skyblue\")\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-1-1.png\" style=\"display: block; margin: auto;\" />\n\nè¯¥ç½‘ç»œçš„åŸºæœ¬ä¿¡æ¯å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å¾—ï¼š\n\n``` r\nV(g)\n###+ 7/7 vertices, named, from 27d8280:\n###[1] 1 2 3 4 5 6 7\nE(g)\n###+ 10/10 edges from 27d8280 (vertex names):\n###[1] 1--2 1--3 2--3 2--4 3--5 4--5 4--6 4--7 5--6 6--7\n###str(g)\nget.adjedgelist(g)\n\n# $`1`\n# + 2/10 edges from f3f6e64 (vertex names):\n#   [1] 1--2 1--3\n# \n# $`2`\n# + 3/10 edges from f3f6e64 (vertex names):\n#   [1] 1--2 2--3 2--4\n# \n# $`3`\n# + 3/10 edges from f3f6e64 (vertex names):\n#   [1] 1--3 2--3 3--5\n# \n# $`4`\n# + 4/10 edges from f3f6e64 (vertex names):\n#   [1] 2--4 4--5 4--6 4--7\n# \n# $`5`\n# + 3/10 edges from f3f6e64 (vertex names):\n#   [1] 3--5 4--5 5--6\n# \n# $`6`\n# + 3/10 edges from f3f6e64 (vertex names):\n#   [1] 4--6 5--6 6--7\n# \n# $`7`\n# + 2/10 edges from f3f6e64 (vertex names):\n#   [1] 4--7 6--7\n\nget.edgelist(g)\n# [,1] [,2]\n# [1,] \"1\"  \"2\" \n# [2,] \"1\"  \"3\" \n# [3,] \"2\"  \"3\" \n# [4,] \"2\"  \"4\" \n# [5,] \"3\"  \"5\" \n# [6,] \"4\"  \"5\" \n# [7,] \"4\"  \"6\" \n# [8,] \"4\"  \"7\" \n# [9,] \"5\"  \"6\" \n# [10,] \"6\"  \"7\" \nprint(g, e=TRUE, v=TRUE)\n# IGRAPH f673c51 UN-- 7 10 -- \n#   + attr: name (v/c)\n# + edges from f673c51 (vertex names):\n#   [1] 1--2 1--3 2--3 2--4 3--5 4--5 4--6 4--7 5--6 6--7\nget.adjacency(g)\n# 7 x 7 sparse Matrix of class \"dgCMatrix\"\n# 1 2 3 4 5 6 7\n# 1 . 1 1 . . . .\n# 2 1 . 1 1 . . .\n# 3 1 1 . . 1 . .\n# 4 . 1 . . 1 1 1\n# 5 . . 1 1 . 1 .\n# 6 . . . 1 1 . 1\n# 7 . . . 1 . 1 .\n```\n\n#### 1.2 æœ‰å‘å›¾\n\nåŒæ ·çš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åˆ›å»ºæœ‰å‘å›¾ï¼›\n\n``` r\ndg <- graph.formula(1-+2,1-+3,2++3)\nop <- par(mfrow=c(1,2))\nplot(g, vertex.size=10,layout=l, vertex.color=\"skyblue\")\nplot(dg,vertex.size=10,vertex.color=\"skyblue\")\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-3-1.png\" style=\"display: block; margin: auto;\" />\n\n``` r\npar(op)\n```\n\n#### 1.3 ä»é‚»æ¥çŸ©é˜µå¯¼å…¥å›¾ï¼›\n\næˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªç¥å¥‡çš„æ•°æ®Arecibo\\_message\\[<https://en.wikipedia.org/wiki/Arecibo_message>\\],\næ¥è¯´æ˜,æœ‰æ—¶å€™,ä¿¡æ¯æ‰€å¯¹åº”çš„çŸ©é˜µï¼Œå¯èƒ½å°±æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå›¾ã€‚\n\n``` r\n###python command comes from\n###https://codegolf.stackexchange.com/questions/182924/output-the-arecibo-message\nmat <- reticulate::py_eval(\"''.join(bin(i)[3:]for i in b'`UP@JB`IDQKJjjd`@@@@@L@@Ah@@CP@@J`@@_@@@@@LNLLP@FPtXpu}}}|@@@@`@@`@@@A@@A~@@~@@@CCCcDA@DMCGM____@@@@HF@H@L@@PX@_`pO`A`@HA@HHF@`LLB@FHX@@s@@Xa`CC@`HD@``L@b@XAD@PDDA@PD@C@F@X@ck@A@P@BCx@DKi[@gI\\x7f\\\\NC\\\\@TGY@hOrAPXDFp@@@@@\\\\D@@zbjipAU@@B`@Gp@@\\x7fx@G@\\\\@X@LAh@lFXCLHhJHQHdPBJH@DHP@H@`@Dh@OOix')[1:]\")\nmat <- as.integer(unlist(strsplit(mat,split = \"\")))\nmat <- matrix(data = mat,nrow = 23,ncol = 73)\n\nexpand.matrix <- function(A){\n  m <- nrow(A)\n  n <- ncol(A)\n  B <- matrix(0,nrow = m, ncol = m)\n  C <- matrix(0,nrow = n, ncol = n)\n  cbind(rbind(B,t(A)),rbind(A,C))\n}\ng1 <- graph_from_adjacency_matrix(expand.matrix(mat),mode = \"undirected\")\nplot(g1,vertex.size=10,edge.width=2,layout=layout.circle,vertex.color=\"coral\")\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-4-1.png\" style=\"display: block; margin: auto;\" />\n\nå¦‚æœç›´æ¥å¯è§†åŒ–è¿™ä¸ªå›¾ï¼Œæˆ‘ä»¬ä»€ä¹ˆä¹Ÿçœ‹ä¸å‡ºæ¥ï¼Œç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬ç”¨å°†åŸæ•°æ®è§†ä¸ºæ …æ ¼æ•°æ®ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬èƒ½çœ‹å‡ºè¿™ä¸ªæ•°æ®çš„å†…æ¶µæ˜¯å¾ˆä¸°å¯Œçš„\n\n``` r\ndat_long <- reshape2::melt(mat)\ndat_long$value <- as.factor(dat_long$value)\ncolnames(dat_long) <- c(\"V1\",\"V2\",\"value\")\n### plot\ngg <- ggplot(dat_long)+\n  geom_tile(aes(V1,V2,fill=value), color=\"#7f7f7f\")+\n  scale_fill_manual(values=c(\"black\", \"white\"))+\n  coord_equal()+\n  labs(x=NULL, y=NULL)+\n  scale_x_continuous(breaks = 1:6)+\n  scale_y_reverse(breaks=1:6)+\n  theme_bw()+\n  theme(panel.grid=element_blank())+\n  theme(panel.border=element_blank(),\n        axis.ticks=element_blank(),\n        axis.text = element_blank(),\n        legend.position = \"none\")\ngg\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-5-1.png\" style=\"display: block; margin: auto;\" />\n\n#### 1.4 ä»data.frameä¸­åˆ›å»ºå›¾\n\néœ€è¦ä¸¤ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªæ˜¯è¾¹çš„ä¿¡æ¯ï¼Œä¸€ä¸ªæ˜¯èŠ‚ç‚¹çš„ä¿¡æ¯\n\n``` r\n## A simple example with a couple of actors\n## The typical case is that these tables are read in from files....\nactors <- data.frame(name=c(\"Alice\", \"Bob\", \"Cecil\", \"David\",\n                            \"Esmeralda\"),\n                     age=c(48,33,45,34,21),\n                     gender=c(\"F\",\"M\",\"F\",\"M\",\"F\"))\nrelations <- data.frame(from=c(\"Bob\", \"Cecil\", \"Cecil\", \"David\",\n                               \"David\", \"Esmeralda\"),\n                        to=c(\"Alice\", \"Bob\", \"Alice\", \"Alice\", \"Bob\", \"Alice\"),\n                        same.dept=c(FALSE,FALSE,TRUE,FALSE,FALSE,TRUE),\n                        friendship=c(4,5,5,2,1,1), advice=c(4,5,5,4,2,3))\ng <- graph_from_data_frame(relations, directed=TRUE, vertices=actors)\n\n\n## The opposite operation\nas_data_frame(g, what=\"vertices\")\n```\n\n    ##                name age gender\n    ## Alice         Alice  48      F\n    ## Bob             Bob  33      M\n    ## Cecil         Cecil  45      F\n    ## David         David  34      M\n    ## Esmeralda Esmeralda  21      F\n\n``` r\nas_data_frame(g, what=\"edges\")\n```\n\n    ##        from    to same.dept friendship advice\n    ## 1       Bob Alice     FALSE          4      4\n    ## 2     Cecil   Bob     FALSE          5      5\n    ## 3     Cecil Alice      TRUE          5      5\n    ## 4     David Alice     FALSE          2      4\n    ## 5     David   Bob     FALSE          1      2\n    ## 6 Esmeralda Alice      TRUE          1      3\n\nå¯è§†åŒ–ï¼Œ\n\n``` r\nplot(g,vertex.size=10,vertex.color=\"skyblue\")\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-7-1.png\" style=\"display: block; margin: auto;\" />\n\n#### 1.5 ç”¨é¢„å®šä¹‰çš„å‡½æ•°ç”Ÿæˆ\n\n`igraph`é‡Œæœ‰å¾ˆå¤šå¸¦makeçš„å‡½æ•°ï¼Œæ˜¯å¯ä»¥ç”Ÿæˆå›¾çš„\n\n``` r\n# ls.str and lsf.str return an object of class \"ls_str\", basically the character vector of matching names (functions only for lsf.str), similarly to ls, with a print() method that calls str() on each object.\n###head(lsf.str(\"package:igraph\"))\ngrep(pattern = \"^make\",x=ls(\"package:igraph\"),value = T)\n```\n\n    ##  [1] \"make_\"                     \"make_bipartite_graph\"     \n    ##  [3] \"make_chordal_ring\"         \"make_clusters\"            \n    ##  [5] \"make_de_bruijn_graph\"      \"make_directed_graph\"      \n    ##  [7] \"make_ego_graph\"            \"make_empty_graph\"         \n    ##  [9] \"make_full_bipartite_graph\" \"make_full_citation_graph\" \n    ## [11] \"make_full_graph\"           \"make_graph\"               \n    ## [13] \"make_kautz_graph\"          \"make_lattice\"             \n    ## [15] \"make_line_graph\"           \"make_ring\"                \n    ## [17] \"make_star\"                 \"make_tree\"                \n    ## [19] \"make_undirected_graph\"\n\næˆ‘ä»¬å±•ç¤ºå…¶ä¸­çš„ä¸€äº›å›¾ï¼š\n\n``` r\ng1 <- make_tree(10, 2)\ng2 <- make_bipartite_graph( rep(0:1,length=10), c(1:10))\ng3 <- make_star(10, mode = \"out\")\ng4 <- make_star(10, mode = \"in\")\nop <- par(mfrow=c(2,2))\nplot(g1,vertex.size=20,vertex.color=\"skyblue\")\nplot(g2,vertex.size=20,vertex.color=\"skyblue\")\nplot(g3,vertex.size=20,vertex.color=\"skyblue\")\nplot(g4,vertex.size=20,vertex.color=\"skyblue\")\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-9-1.png\" style=\"display: block; margin: auto;\" />\n\n``` r\npar(op)\n```\n\n### 2. åŸºæœ¬æ“ä½œ\n\nè¯±å¯¼å­å›¾\n\n``` r\ng <- graph.formula(1-2,1-3,2-3,2-4,3-5,4-5,4-6,4-7,5-6,6-7)\nh <- induced.subgraph(g,1:5)\nprint(h)\n```\n\n    ## IGRAPH d91ee38 UN-- 5 6 -- \n    ## + attr: name (v/c)\n    ## + edges from d91ee38 (vertex names):\n    ## [1] 1--2 1--3 2--3 2--4 3--5 4--5\n\nExclusionï¼š\n\n``` r\nh <- g - vertices(c(6,7))\nprint(h)\n```\n\n    ## IGRAPH d923ec9 UN-- 5 6 -- \n    ## + attr: name (v/c)\n    ## + edges from d923ec9 (vertex names):\n    ## [1] 1--2 1--3 2--3 2--4 3--5 4--5\n\nInclusion:\n\n``` r\nh <- h + vertices(c(6,7))\ng <- h + edges(c(4,6),c(4,7),c(5,6),c(6,7))\nprint(g)\n```\n\n    ## IGRAPH d928f5d UN-- 7 10 -- \n    ## + attr: name (v/c)\n    ## + edges from d928f5d (vertex names):\n    ##  [1] 1--2 1--3 2--3 2--4 3--5 4--5 4--6 4--7 5--6 6--7\n\nunion:\n\n``` r\nh1 <- h\nh2 <- graph.formula(4-6,4-7,5-6,6-7)\ng <- graph.union(h1,h2)\nprint(g)\n```\n\n    ## IGRAPH d92f82f UN-- 7 10 -- \n    ## + attr: name (v/c)\n    ## + edges from d92f82f (vertex names):\n    ##  [1] 6--7 5--6 4--7 4--6 4--5 3--5 2--4 2--3 1--3 1--2\n\n### 3. æŸ¥çœ‹/æ·»åŠ /ä¿®æ”¹ å±æ€§\n\né¦–å…ˆåˆ›å»ºä¸€ä¸ªç¤ºä¾‹çš„å›¾ï¼Œ\n\n``` r\n## A simple example with a couple of actors\n## The typical case is that these tables are read in from files....\nactors <- data.frame(name=c(\"Alice\", \"Bob\", \"Cecil\", \"David\",\n                            \"Esmeralda\"),\n                     age=c(48,33,45,34,21),\n                     gender=c(\"F\",\"M\",\"F\",\"M\",\"F\"))\nrelations <- data.frame(from=c(\"Bob\", \"Cecil\", \"Cecil\", \"David\",\n                               \"David\", \"Esmeralda\"),\n                        to=c(\"Alice\", \"Bob\", \"Alice\", \"Alice\", \"Bob\", \"Alice\"),\n                        same.dept=c(FALSE,FALSE,TRUE,FALSE,FALSE,TRUE),\n                        friendship=c(4,5,5,2,1,1), advice=c(4,5,5,4,2,3))\ng <- graph_from_data_frame(relations, directed=TRUE, vertices=actors)\n```\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡`$`è¿ç®—ç¬¦æ¥æŸ¥çœ‹ï¼Œæ·»åŠ ï¼Œä¿®æ”¹å±æ€§\n\n``` r\n###check edge attribute\nnames(edge_attr(g))\n###[1] \"same.dept\"  \"friendship\" \"advice\" \n###vertext\nnames(vertex_attr(g))\n###[1] \"name\"   \"age\"    \"gender\"\n###Vertex\n# list.vertex.attributes(g)\n# list.edge.attributes(g)\nV(g)$name\n###[1] \"Alice\"     \"Bob\"       \"Cecil\"     \"David\"     \"Esmeralda\"\nedge_attr(g)$same.dept\n###[1] FALSE FALSE  TRUE FALSE FALSE  TRUE\nedge_attr(g)$friendship\n###[1] 4 5 5 2 1 1\n```\n\nå¯è§†åŒ–å¦‚ä¸‹ï¼š\n\n``` r\n## A simple example with a couple of actors\n## The typical case is that these tables are read in from files....\nactors <- data.frame(name=c(\"Alice\", \"Bob\", \"Cecil\", \"David\",\n                            \"Esmeralda\"),\n                     age=c(48,33,45,34,21),\n                     gender=c(\"F\",\"M\",\"F\",\"M\",\"F\"))\nrelations <- data.frame(from=c(\"Bob\", \"Cecil\", \"Cecil\", \"David\",\n                               \"David\", \"Esmeralda\"),\n                        to=c(\"Alice\", \"Bob\", \"Alice\", \"Alice\", \"Bob\", \"Alice\"),\n                        same.dept=c(FALSE,FALSE,TRUE,FALSE,FALSE,TRUE),\n                        friendship=c(4,5,5,2,1,1), advice=c(4,5,5,4,2,3))\ng <- graph_from_data_frame(relations, directed=TRUE, vertices=actors)\n\nV(g)$gender <- plyr::revalue(x=V(g)$gender,\n                            replace=c(\"F\"=\"Female\",\"M\"=\"Male\"))\nV(g)$gender\n```\n\n    ## [1] \"Female\" \"Male\"   \"Female\" \"Male\"   \"Female\"\n\n``` r\ng$name <- \"Toy Graph\"\nset.seed(42)\ntmp.df <- layout.graphopt(g)\nV(g)$color <- plyr::revalue(x=V(g)$gender,\n                            replace=c(\"Female\"=\"skyblue\",\n                                      \"Male\"=\"coral\"))\nplot(g,layout=tmp.df,vertex.size=20,\n     vertex.color=V(g)$color,main=\"Toy Graph\")\nlegend('right',legend=unique(V(g)$gender),pch=c(19,19),col = c(\"skyblue\",\"coral\"))\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-16-1.png\" style=\"display: block; margin: auto;\" />\n\n``` r\nset.seed(42)\ntmp.df <- layout.graphopt(g)\ngg.net = ggnetwork(g,\n                   arrow.gap = 0.05, \n                   layout = tmp.df)\nggplot(gg.net, aes(x = x, y = y, xend = xend, yend = yend)) +\n    geom_edges(color = \"black\", \n               alpha = 0.5, curvature = 0,\n               arrow = arrow(length = unit(6, \"pt\"), \n                             type = \"closed\")) +\n    geom_nodes(aes(color = gender), size = 10) +\n  geom_nodetext(aes(label = name))+\n  scale_color_manual(values = c(\"skyblue\",\"coral\"))+\n    ggtitle(\"Toy Graph\")+\n    theme_blank()\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-17-1.png\" style=\"display: block; margin: auto;\" />\n\n### 4. æ›´å¤šå…³äºå›¾çš„æ¦‚å¿µå’Œæœ¯è¯­\n\n#### 4.1 æ¦‚å¿µ\n\nä¸‹è¿°æ¦‚å¿µä¸æ¬è¿ä¹¦é‡Œçš„å®šä¹‰ï¼›å¿˜è®°å°±æŸ¥ä¹¦ã€‚åé¢çš„ç« èŠ‚ä¼šå†ç”¨åˆ°è¿™äº›æ¦‚å¿µï¼Œè¿›è¡Œå›¾çš„å¯è§†åŒ–ä¸ç»Ÿè®¡åˆ†æã€‚\n\n  - multi-graph\n\n  - simple-graph:\n    å¯ä»¥ç”¨`is.simple()`åˆ¤å®šï¼Œå¯ä»¥ç”¨`simplify()`å°†`multi-graph`è½¬æ¢ä¸º`simple-graph`.\n\n  - neighbors\n\n  - degree: The degree of a vertex v defined as the number of edges\n    incident on v;\n\n  - in-degree\n\n  - out-degree\n\n  - walk\n\n  - trails\n\n  - circuit & cylce;\n\n  - reachable\n\n  - graph connected\n\n  - component of a graph\n\n  - strong connected\n\n  - weak connected\n\n  - distance/geodesic distance\n\n  - diameter\n\n#### 4.2 ä¸€äº›ç‰¹æ®Šçš„å›¾\n\nä¸ç¬¬ä¸€èŠ‚æœ‰é‡å \n\n  - complet graph\n\n  - clique\n\n  - regular graph\n\n  - tree\n\n  - forest\n\n  - root\n\n  - ancestor\n\n  - descendant\n\n  - parents, children\n\n  - k-star\n\n  - dirrected acyclic graph(DAG)\n\n  - bipartite graph\n\n<!-- end list -->\n\n``` r\ng.bip <- graph.formula(actor1:actor2:actor3,\n                       movie1:movie2,\n                       actor1:actor2 - movie1,\n                       actor2:actor3 - movie2)\n\nV(graph = g.bip)$type <- grepl(pattern = \"^movie\",V(graph = g.bip)$name)\n\nV(g.bip)$category <- ifelse(V(graph = g.bip)$type,\"Movie\",\"Actor\")\nV(g.bip)$category\n```\n\n    ## [1] \"Actor\" \"Actor\" \"Actor\" \"Movie\" \"Movie\"\n\n``` r\ng <- g.bip\nset.seed(42)\n### using matrxi product to do layout rotate 3/2pi\ntmp.df <- layout.bipartite(g) %*% matrix(data = c(0,-1,1,0),nrow = 2)\n\ngg.net = ggnetwork(g,\n                   arrow.gap = 0.05, \n                   layout = tmp.df)\nhead(gg.net)\n```\n\n    ##   x   y   name  type category      xend      yend\n    ## 1 0 0.0 actor1 FALSE    Actor 0.9514929 0.2378732\n    ## 2 0 0.5 actor2 FALSE    Actor 0.9514929 0.2621268\n    ## 3 0 0.5 actor2 FALSE    Actor 0.9514929 0.7378732\n    ## 4 0 1.0 actor3 FALSE    Actor 0.9514929 0.7621268\n    ## 5 0 0.0 actor1 FALSE    Actor 0.0000000 0.0000000\n    ## 6 0 0.5 actor2 FALSE    Actor 0.0000000 0.5000000\n\n``` r\nggplot(gg.net, aes(x = x, y = y, xend = xend, yend = yend)) +\n    geom_edges(color = \"black\", \n               alpha = 0.5, curvature = 0\n               # ,arrow = arrow(length = unit(6, \"pt\"), \n               #               type = \"closed\")\n               ) +\n    geom_nodes(aes(color = category), size = 16) +\n  geom_nodetext(aes(label = name))+\n  scale_color_manual(values = c(\"skyblue\",\"coral\"))+\n    ggtitle(\"bipartite graph example\")+\n    theme_blank()\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-18-1.png\" style=\"display: block; margin: auto;\" />\n\n`igraph`è‡ªå¸¦çš„ä¾‹å­ï¼š\n\n``` r\n# Random bipartite graph\ninc <- matrix(sample(0:1, 50, replace = TRUE, prob=c(2,1)), 10, 5)\ng <- graph_from_incidence_matrix(inc)\nplot(g, layout = layout_as_bipartite,vertex.size=20,\n     vertex.color=c(\"skyblue\",\"coral\")[V(g)$type+1])\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-19-1.png\" style=\"display: block; margin: auto;\" />\n\n### é™„å½•ï¼šRé…è‰²\n\nåŸºæœ¬é¢œè‰²ï¼š\n\n``` r\n#### code provided by\n####http://bc.bojanorama.pl/2013/04/r-color-reference-sheet/\nm <- matrix(1:660, 60, 11)\nkol <- colors()[m]\n#op <- par(mar=c(.1, .1, 2, .1))\nimage(1:11, 1:60, t(m), col=kol, axes=FALSE, ann=FALSE)\ntxtcol <- ifelse( apply(col2rgb(kol), 2, mean) < 70, \"white\", \"black\")\ntext( as.numeric(col(m)), as.numeric(row(m)), kol, cex=.8, col=txtcol)\nmtext(\"grDevices::colors\", 3, cex=2)\n```\n\n<img src=\"/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-20-1.png\" style=\"display: block; margin: auto;\" />\n\nè°ƒè‰²ç‰ˆ\n\n``` r\nRColorBrewer::display.brewer.all()\nmtext(\"RColorBrewer\", 3, cex=2)\n```\n\n![](/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-21-1.png)<!-- -->\n\næ¸å˜è‰²\n\n``` r\nlibrary(RColorBrewer)\nlibrary(colorRamps)\nlibrary(viridis)\n### manu\nrdylbu <- colorRampPalette(rev(brewer.pal(n = 11, name =\"RdYlBu\")))\nrdbu <- colorRampPalette(rev(brewer.pal(n = 11, name =\"RdBu\")))\nnavy <- colorRampPalette(c(\"navy\", \"white\", \"firebrick3\"))\njet.colors <-\n  colorRampPalette(c(\"#00007F\", \"blue\", \"#007FFF\", \"cyan\",\n                     \"#7FFF7F\", \"yellow\", \"#FF7F00\", \"red\", \"#7F0000\"))\ncold <- colorRampPalette(c('#f7fcf0','#41b6c4','#253494','#081d58','#081d58'))\nwarm <- colorRampPalette(c('#ffffb2','#fecc5c','#e31a1c','#800026','#800026'))\nwarmcold <- colorRampPalette(c(rev(cold(21)), warm(20)))\n\n\n### add manu with package function\n\nN <- 100 # ramp length\nfunnames <- rev(c(\"manu::rdylbu\",\"manu::rdbu\",\"manu::navy\",\"manu::jet.colors\",\"manu::warmcold\",\n              \"viridis::viridis\",\n              \"grDevices::rainbow\", \"grDevices::heat.colors\",\n              \"grDevices::terrain.colors\", \"grDevices::topo.colors\",\n              \"grDevices::cm.colors\", \n              \"colorRamps::blue2red\",\n              \"colorRamps::blue2green\", \"colorRamps::green2red\",\n              \"colorRamps::blue2yellow\", \"colorRamps::cyan2yellow\",\n              \"colorRamps::magenta2green\", \"colorRamps::matlab.like\",\n              \"colorRamps::matlab.like2\", \"colorRamps::primary.colors\",\n              \"colorRamps::ygobb\"))\nspl <- strsplit(funnames, \"::\")\npkgs <- sapply(spl, \"[\", 1)\nfuns <- sapply(spl, \"[\", 2)\nkolmat <- sapply(funs, do.call, list(N))\nmat <- matrix( seq(1, length(kolmat)), nrow(kolmat), ncol(kolmat))\n\n\nimage(seq(1, nrow(mat)), seq(1, ncol(mat)), mat, col=kolmat,\n      axes=FALSE, ann=FALSE)\ntext( nrow(mat)/2, seq(1, ncol(mat)), funnames)\nmtext(\"Color Ramps function\", 3, cex=2)\n```\n\n![](/figure/posts/Learnigraph-1-ManuNetworkDataBasic_files/figure-gfm/unnamed-chunk-22-1.png)<!-- -->\n","tags":["Graph","Network"],"categories":["implementation"]},{"title":"Combine pheatmap","url":"/2020/04/20/combine_pheatmap/","content":"\nTalk is cheap, this is code:\n\n``` r\nlibrary(grid)\nlibrary(gridExtra)\nlibrary(pheatmap)\nlibrary(ggplot2)\nlibrary(colormap)\nitems=names(colormaps)\nplot_list=list()\nfor (a in items[1:8]){\n  x= pheatmap(volcano,\n              cluster_rows = F,\n              cluster_cols = F,\n              main = a,\n              height = 3,\n              width = 3,\n              border_color = NA,\n              color = colormap_pal(colormap = colormaps[[a]])(100),silent = T)\n  plot_list[[a]] = x[[4]]     ##to save each plot into a list. note the [[4]]\n}\n\ncowplot::plot_grid(plotlist = plot_list[1:8],ncol = 2,nrow = 4)\n```\n\n<img src=\"/figure/posts/combine_pheatmap_files/figure-markdown_github/unnamed-chunk-1-1.png\" style=\"display: block; margin: auto;\" />\n\ntest equation: $E=mc^2$; $P(AB)=P(A)P(B)$\n","tags":["R"],"categories":["implementation"]},{"title":"pheatmap_advanced","url":"/2020/04/20/pheatmap_advanced/","content":"\n\n\n### Case 1\n\nThe datasets were provided by\n[data-to-viz](https://www.data-to-viz.com/story/SevCatOneNumNestedOneObsPerGroup.html)\n\n``` r\nlibrary(tidyverse)\nlibrary(pheatmap)\nlibrary(ggplot2)\nlibrary(viridis)\nlibrary(kableExtra)\n### dataset 1\ndata <- read.table(\"https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/13_AdjacencyDirectedWeighted.csv\", header=TRUE)\n# show data\ndata %>% head(3) %>% select(1:3) %>% kable() %>%\n  kable_styling(bootstrap_options = \"striped\", full_width = F)\n```\n\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n\n<thead>\n\n<tr>\n\n<th style=\"text-align:left;\">\n\n</th>\n\n<th style=\"text-align:right;\">\n\nAfrica\n\n</th>\n\n<th style=\"text-align:right;\">\n\nEast.Asia\n\n</th>\n\n<th style=\"text-align:right;\">\n\nEurope\n\n</th>\n\n</tr>\n\n</thead>\n\n<tbody>\n\n<tr>\n\n<td style=\"text-align:left;\">\n\nAfrica\n\n</td>\n\n<td style=\"text-align:right;\">\n\n3.142471\n\n</td>\n\n<td style=\"text-align:right;\">\n\n0.000000\n\n</td>\n\n<td style=\"text-align:right;\">\n\n2.107883\n\n</td>\n\n</tr>\n\n<tr>\n\n<td style=\"text-align:left;\">\n\nEast Asia\n\n</td>\n\n<td style=\"text-align:right;\">\n\n0.000000\n\n</td>\n\n<td style=\"text-align:right;\">\n\n1.630997\n\n</td>\n\n<td style=\"text-align:right;\">\n\n0.601265\n\n</td>\n\n</tr>\n\n<tr>\n\n<td style=\"text-align:left;\">\n\nEurope\n\n</td>\n\n<td style=\"text-align:right;\">\n\n0.000000\n\n</td>\n\n<td style=\"text-align:right;\">\n\n0.000000\n\n</td>\n\n<td style=\"text-align:right;\">\n\n2.401476\n\n</td>\n\n</tr>\n\n</tbody>\n\n</table>\n\n```r\n### the following function were embeded in pheatmap source code\nscale_rows = function(x){\n    m = apply(x, 1, mean, na.rm = T)\n    s = apply(x, 1, sd, na.rm = T)\n    return((x - m) / s)\n}\n\nscale_mat = function(mat, scale){\n    if(!(scale %in% c(\"none\", \"row\", \"column\"))){\n        stop(\"scale argument shoud take values: 'none', 'row' or 'column'\")\n    }\n    mat = switch(scale, none = mat, row = scale_rows(mat), column = t(scale_rows(t(mat))))\n    return(mat)\n}\n\ngenerate_breaks = function(x, n, center = F){\n    if(center){\n        m = max(abs(c(min(x, na.rm = T), max(x, na.rm = T))))\n        res = seq(-m, m, length.out = n + 1)\n    }\n    else{\n        res = seq(min(x, na.rm = T), max(x, na.rm = T), length.out = n + 1)\n    }\n    \n    return(res)\n}\n\n\ndata.plot <- scale_mat(mat = data,scale = \"column\")\nbreaks <- generate_breaks(data.plot,n = 256,center = F)\n\npheatmap::pheatmap(mat = data.plot,\n                   cluster_cols = F,\n                   cluster_rows = F,\n                   scale = \"column\",border_color = \"white\",\n                   color = viridis(n = 256, alpha = 1, \n                                   begin = 0, end = 1, option = \"viridis\"),\n                   breaks = breaks)\n```\n\n\n<img src=\"/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-2-1.png\" style=\"display: block; margin: auto;\" />\n\n### case 2\n\nthe codes were adapted from\n[slowkow](https://slowkow.com/notes/pheatmap-tutorial/) Sort dendrogram\nis very important\n\n``` r\nset.seed(42)\nrandom_string <- function(n) {\n  substr(paste(sample(letters), collapse = \"\"), 1, n)\n}\n\nmat <- matrix(rgamma(1000, shape = 1) * 5, ncol = 50)\n\ncolnames(mat) <- paste(\n  rep(1:3, each = ncol(mat) / 3),\n  replicate(ncol(mat), random_string(5)),\n  sep = \"\"\n)\nrownames(mat) <- replicate(nrow(mat), random_string(3))\n\nmat %>% as.data.frame %>% head(3) %>% select(1:3) %>% kable() %>%\n  kable_styling(bootstrap_options = \"striped\", full_width = F)\n```\n\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n\n<thead>\n\n<tr>\n\n<th style=\"text-align:left;\">\n\n</th>\n\n<th style=\"text-align:right;\">\n\n1jrqxa\n\n</th>\n\n<th style=\"text-align:right;\">\n\n1pskvw\n\n</th>\n\n<th style=\"text-align:right;\">\n\n1ojvwz\n\n</th>\n\n</tr>\n\n</thead>\n\n<tbody>\n\n<tr>\n\n<td style=\"text-align:left;\">\n\nabv\n\n</td>\n\n<td style=\"text-align:right;\">\n\n9.6964789\n\n</td>\n\n<td style=\"text-align:right;\">\n\n9.172811\n\n</td>\n\n<td style=\"text-align:right;\">\n\n2.827695\n\n</td>\n\n</tr>\n\n<tr>\n\n<td style=\"text-align:left;\">\n\nnft\n\n</td>\n\n<td style=\"text-align:right;\">\n\n0.9020955\n\n</td>\n\n<td style=\"text-align:right;\">\n\n15.575853\n\n</td>\n\n<td style=\"text-align:right;\">\n\n4.328376\n\n</td>\n\n</tr>\n\n<tr>\n\n<td style=\"text-align:left;\">\n\nxha\n\n</td>\n\n<td style=\"text-align:right;\">\n\n2.6721643\n\n</td>\n\n<td style=\"text-align:right;\">\n\n3.127039\n\n</td>\n\n<td style=\"text-align:right;\">\n\n1.765077\n\n</td>\n\n</tr>\n\n</tbody>\n\n</table>\n\nsplit data into 3 groups, and increase the values in group1\n\n``` r\ncol_groups <- substr(colnames(mat), 1, 1)\nmat[,col_groups == \"1\"] <- mat[,col_groups == \"1\"] * 5\n```\n\nmaking the heatmap\n\n``` r\n# install.packages(\"pheatmap\", \"RColorBrewer\", \"viridis\")\nlibrary(pheatmap)\nlibrary(RColorBrewer)\nlibrary(viridis)\n\n# Data frame with column annotations.\nmat_col <- data.frame(group = col_groups)\nrownames(mat_col) <- colnames(mat)\n\n# List with colors for each annotation.\nmat_colors <- list(group = brewer.pal(3, \"Set1\"))\nnames(mat_colors$group) <- unique(col_groups)\n\npheatmap(\n  mat               = mat,\n  color             = inferno(10),\n  border_color      = NA,\n  show_colnames     = FALSE,\n  show_rownames     = FALSE,\n  annotation_col    = mat_col,\n  annotation_colors = mat_colors,\n  drop_levels       = TRUE,\n  fontsize          = 14,\n  main              = \"Default Heatmap\"\n)\n```\n\n![](/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->\n\nThe default color breaks in pheatmap are uniformly distributed across\nthe range of the data.\n\nWe can see that values in group 1 are larger than values in groups 2 and\n3. However, we canâ€™t distinguish different values within groups 2 and 3.\n\n``` r\n## ----uniform-color-breaks------------------------------------------------\n\nmat_breaks <- seq(min(mat), max(mat), length.out = 10)\n\ndat <- data.frame(values = as.numeric(mat))\n\n## ----uniform-color-breaks-detail, fig.height=2, echo=FALSE---------------\ndat_colors <- data.frame(\n  xmin = mat_breaks[1:(length(mat_breaks)-1)],\n  xmax = mat_breaks[2:length(mat_breaks)],\n  ymin = 0,\n  ymax = max(density(mat, bw = \"SJ\")$y),\n  fill = rev(inferno(length(mat_breaks) - 1)),\n  stringsAsFactors = FALSE\n)\nggplot() +\n  geom_rect(\n    data = dat_colors,\n    mapping = aes(\n      xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax, fill = fill\n    )\n  ) +\n  geom_density(\n    data = dat,\n    mapping = aes(values),\n    bw = \"SJ\", color = \"cyan\"\n  ) +\n  scale_fill_manual(values = dat_colors$fill) +\n  cowplot::theme_cowplot()+\n  theme(legend.position = \"none\") +\n  labs(title = \"Uniform breaks\")\n```\n\n<img src=\"/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-6-1.png\" style=\"display: block; margin: auto;\" />\n\nthere are 6 data points greater than or equal to 100 are represented\nwith 4 different colors.\n\n``` r\ndat2 <- as.data.frame(table(cut(\n  mat, mat_breaks\n)))\ndat2$fill <- inferno(nrow(dat2))\nggplot() +\n  geom_bar(\n    data = dat2,\n    mapping = aes(x = Var1, weight = Freq, fill = Var1),\n    color = \"black\", size = 0.1\n  ) +\n  coord_flip() +\n  scale_fill_manual(values = dat2$fill) +\n  cowplot::theme_cowplot()+\n  theme(legend.position = \"none\") +\n  labs(y = \"data points\", x = \"breaks\",\n       title = \"Number of data points per color\")\n```\n\n![](/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-7-1.png)<!-- -->\n\nIf we reposition the breaks at the quantiles of the data, then each\ncolor will represent an equal proportion of the data:\n\n``` r\nquantile_breaks <- function(xs, n = 10) {\n  breaks <- quantile(xs, probs = seq(0, 1, length.out = n))\n  breaks[!duplicated(breaks)]\n}\n\nmat_breaks <- quantile_breaks(mat, n = 11)\n```\n\nlets see\n\n``` r\ndat_colors <- data.frame(\n  xmin = mat_breaks[1:(length(mat_breaks)-1)],\n  xmax = mat_breaks[2:length(mat_breaks)],\n  ymin = 0,\n  ymax = max(density(mat, bw = \"SJ\")$y),\n  fill = rev(inferno(length(mat_breaks) - 1)),\n  stringsAsFactors = FALSE\n)\nggplot() +\n  geom_rect(\n    data = dat_colors,\n    mapping = aes(\n      xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax, fill = fill\n    )\n  ) +\n  geom_density(\n    data = dat,\n    mapping = aes(values),\n    bw = \"SJ\", color = \"cyan\"\n  ) +\n  scale_fill_manual(values = dat_colors$fill) +\n  theme(legend.position = \"none\") +\n  labs(title = \"Quantile breaks\")\n```\n\n![](/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-9-1.png)<!-- -->\n\n``` r\ndat2 <- as.data.frame(table(cut(\n  mat, mat_breaks\n)))\ndat2$fill <- inferno(nrow(dat2))\nggplot() +\n  geom_bar(\n    data = dat2,\n    mapping = aes(x = Var1, weight = Freq, fill = Var1),\n    color = \"black\", size = 0.1\n  ) +\n  coord_flip() +\n  scale_fill_manual(values = dat2$fill) +\n  theme(legend.position = \"none\") +\n  labs(y = \"data points\", x = \"breaks\",\n       title = \"Number of data points per color\")\n```\n\n![](/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-10-1.png)<!-- -->\n\nWhen we use quantile breaks in the heatmap, we can clearly see that\ngroup 1 values are much larger than values in groups 2 and 3, and we can\nalso distinguish different values within groups 2 and 3:\n\n``` r\npheatmap(\n  mat               = mat,\n  color             = inferno(length(mat_breaks) - 1),\n  breaks            = mat_breaks,\n  border_color      = NA,\n  show_colnames     = FALSE,\n  show_rownames     = FALSE,\n  annotation_col    = mat_col,\n  annotation_colors = mat_colors,\n  drop_levels       = TRUE,\n  fontsize          = 14,\n  main              = \"Quantile Color Scale\"\n)\n```\n\n![](/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-11-1.png)<!-- -->\n\nWe can also transform data\n\n``` r\npheatmap(\n  mat               = log10(mat),\n  color             = inferno(10),\n  border_color      = NA,\n  show_colnames     = FALSE,\n  show_rownames     = FALSE,\n  annotation_col    = mat_col,\n  annotation_colors = mat_colors,\n  drop_levels       = TRUE,\n  fontsize          = 14,\n  main              = \"Log10 Transformed Values\"\n)\n```\n\n<img src=\"/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-12-1.png\" style=\"display: block; margin: auto;\" />\n\nsort dendrograms\n\n``` r\nlibrary(dendsort)\n\nmat_cluster_cols <- hclust(dist(t(mat)))\n\n\nsort_hclust <- function(...) as.hclust(dendsort(as.dendrogram(...)))\n\nmat_cluster_cols <- sort_hclust(mat_cluster_cols)\nplot(mat_cluster_cols, main = \"Sorted Dendrogram\", xlab = \"\", sub = \"\")\n```\n\n<img src=\"/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-13-1.png\" style=\"display: block; margin: auto;\" />\n\nsort Dendrogram heatmap\n\n``` r\nmat_cluster_rows <- sort_hclust(hclust(dist(mat)))\npheatmap(\n  mat               = mat,\n  color             = inferno(length(mat_breaks) - 1),\n  breaks            = mat_breaks,\n  border_color      = NA,\n  cluster_cols      = mat_cluster_cols,\n  cluster_rows      = mat_cluster_rows,\n  show_colnames     = FALSE,\n  show_rownames     = FALSE,\n  annotation_col    = mat_col,\n  annotation_colors = mat_colors,\n  drop_levels       = TRUE,\n  fontsize          = 14,\n  main              = \"Sorted Dendrograms\"\n)\n```\n\n<img src=\"/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-14-1.png\" style=\"display: block; margin: auto;\" />\n\nchange colnames angle\n\n``` r\npheatmap(\n  mat               = mat,\n  color             = inferno(length(mat_breaks) - 1),\n  breaks            = mat_breaks,\n  border_color      = NA,\n  cluster_cols      = mat_cluster_cols,\n  cluster_rows      = mat_cluster_rows,\n  show_colnames     = TRUE,\n  show_rownames     = FALSE,\n  annotation_col    = mat_col,\n  angle_col = 90,\n  fontsize_col  = 8,\n  annotation_colors = mat_colors,\n  drop_levels       = TRUE,\n  fontsize          = 10,\n  main              = \"Sorted Dendrograms\"\n)\n```\n\n<img src=\"/figure/posts/pheatmap_advanced_files/figure-gfm/unnamed-chunk-15-1.png\" style=\"display: block; margin: auto;\" />\n","tags":["R"],"categories":["implementation"]},{"title":"rmarkdown-test","url":"/2020/04/20/rmarkdown-test/","content":"\nThis post test blogdown, reference this\n[repo](https://github.com/yihui/blogdown-hexo) This post generate by\n*blogdown::new\\_post(title = â€œRmarkdown\\_testâ€,ext=â€œ.Rmdâ€)*\n\n# R Markdown\n\nThis is an R Markdown document. Please note this page was **not**\nrendered using the [**rmarkdown**](http://rmarkdown.rstudio.com) package\nor [Pandoc](http://pandoc.org). The R Markdown document is compiled to\nMarkdown through **knitr**, and the Markdown document is rendered to\nHTML through [Hexoâ€™s Markdown\nrenderer](https://github.com/hexojs/hexo-renderer-marked).\n\nYou can embed an R code chunk like this:\n\n``` r\nsummary(cars)\n##      speed           dist       \n##  Min.   : 4.0   Min.   :  2.00  \n##  1st Qu.:12.0   1st Qu.: 26.00  \n##  Median :15.0   Median : 36.00  \n##  Mean   :15.4   Mean   : 42.98  \n##  3rd Qu.:19.0   3rd Qu.: 56.00  \n##  Max.   :25.0   Max.   :120.00\nfit <- lm(dist ~ speed, data = cars)\nfit\n## \n## Call:\n## lm(formula = dist ~ speed, data = cars)\n## \n## Coefficients:\n## (Intercept)        speed  \n##     -17.579        3.932\n```\n\n# Including Plots\n\nYou can also embed R plots:\n\n``` r\npar(mar = c(0, 1, 0, 1))\npie(\n  c(280, 60, 20),\n  c('Sky', 'Sunny side of pyramid', 'Shady side of pyramid'),\n  col = c('#0292D8', '#F7EA39', '#C4B632'),\n  init.angle = -50, border = NA\n)\n```\n\n![](/figure/posts/rmarkdown-test_files/figure-gfm/pie-1.png)<!-- -->\n","tags":["R"],"categories":["implementation"]},{"title":"é˜¿é‡Œæ•°å­¦ç«èµ›é¢„èµ›2020å¹´çš„ä¸€é“æ¦‚ç‡é¢˜å­¦ä¹ ","url":"/2020/04/18/é˜¿é‡Œæ•°å­¦ç«èµ›é¢„èµ›2020å¹´çš„ä¸€é“æ¦‚ç‡é¢˜å­¦ä¹ /","content":"\né˜¿é‡Œå·´å·´å…¨çƒæ•°å­¦ç«èµ›æ˜¯é˜¿é‡ŒåŠçš„ä¸€é¡¹æ•°å­¦ç«èµ›ã€‚å‡ºé¢˜èŒƒå›´å’Œå¾€å±Šé¢„é€‰èµ›é¢˜ç›®å¯ä»¥åœ¨å…¶[å®˜ç½‘](https://damo.alibaba.com/alibaba-global-mathematics-competition?lang=zh)ä¸‹æŸ¥çœ‹ ã€‚\n\n2020å¹´çš„é¢„é€‰èµ›ï¼Œæœ‰é“é¢˜ç›®æ˜¯è¿™æ ·çš„ï¼š\n\n> è€ƒè™‘ä¸€ä¸ªç”±ä»å·¦é“å³çš„nä¸ªå°æ–¹æ ¼ç»„æˆçš„$1\\times n$çš„åŒºåŸŸï¼Œä»å·¦åˆ°å³ä¾æ¬¡åœ¨æ¯ä¸ªå°æ–¹æ ¼ç§ä¸€æ£µæ ‘ï¼Œä¸€å…±ç§$n$æ£µã€‚æ ‘çš„ç§ç±»åªæœ‰ä¸¤ç§ï¼šèƒ¡æ¨å’Œæ¨Ÿå­æ¾ã€‚å‡è®¾åœ¨ç¬¬ä¸€ä¸ªå°æ–¹æ ¼ç§æ¤çš„æ•°æ˜¯èƒ¡æ¨çš„æ¦‚ç‡æ˜¯rã€‚åç»­çš„ç§æ ‘çš„è§„åˆ™ä¸ºï¼šå¦‚æœå‰ä¸€ä¸ªå°æ–¹æ ¼ç§çš„æ˜¯èƒ¡æ¨ï¼Œåˆ™æœ¬æ ¼ç§èƒ¡æ¨çš„æ¦‚ç‡ä¸º$s$;å¦‚æœå‰ä¸€ä¸ªå°æ–¹æ ¼ç§çš„æ˜¯æ¨Ÿå­æ¾ï¼Œåˆ™æœ¬æ ¼ç§æ¨Ÿå­æ¾çš„æ¦‚ç‡ä¸º$t,0<r,s,t<1$\n> \n> (a) å‡è®¾$r=1/3,s+t\\ne1$ã€‚æ˜¯å¦å­˜åœ¨$s,t$ä½¿å¾—$\\forall i,2 \\le i \\le n$,åœ¨ç¬¬$i$ä¸ªå°æ–¹æ ¼ç§æ¤çš„æ ‘æ˜¯èƒ¡æ¨çš„æ¦‚ç‡éƒ½ç­‰äºä¸€ä¸ªè·Ÿ$i$æ— å…³çš„å¸¸æ•°ï¼Ÿå¦‚æœå­˜åœ¨ï¼Œè¯·ç»™å‡º$sï¼Œt$æ»¡è¶³çš„å…³ç³»ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œè¯·è¯´æ˜ç†ç”±ã€‚\n> \n> (b) å‡è®¾$r=\\frac{1}{3},s=\\frac{3}{4},t=\\frac{4}{5}$ã€‚å‡è®¾æˆ‘ä»¬è§‚å¯Ÿåˆ°ç¬¬2019ä¸ªå°æ–¹æ ¼é‡Œç§æ¤çš„æ ‘æ˜¯èƒ¡æ¨ï¼Œä½†æˆ‘ä»¬è§‚å¯Ÿä¸åˆ°å…¶å®ƒå°æ–¹æ ¼é‡Œç§æ¤çš„æ˜¯å“ªç§æ ‘ã€‚è¯·é—®ç¬¬ä¸€ä¸ªå°æ–¹æ ¼é‡Œç§æ¤çš„æ ‘æ˜¯èƒ¡æ¨çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ\n\nè¿™é“é¢˜è€ƒå¯Ÿçš„å…¶å®æ˜¯é©¬å°”ç§‘å¤«é“¾ç›¸å…³çš„çŸ¥è¯†ï¼Œç¬¬ä¸€é—®æ˜¯è¯´ä»€ä¹ˆæ¡ä»¶ä¸‹ï¼Œé¢˜ç›®ç»™å®šçš„é©¬å°”å¯å¤«é“¾åœ¨ç¬¬äºŒæ­¥å°±èƒ½è¾¾åˆ°å¹³ç¨³åˆ†å¸ƒï¼›ç¬¬äºŒé—®æ˜¯ä»ç¬¬næ­¥é€†æ¨æœ€èµ·å§‹çš„æ¦‚ç‡ã€‚å½“ç„¶ï¼Œç›´æ¥çš„å·¥å…·æ˜¯æ¡ä»¶æ¦‚ç‡å’Œå…¨æ¦‚ç‡å…¬å¼ã€‚\n\nè§£ç­”ï¼ˆæ ¹æ®å®˜æ–¹ç­”æ¡ˆï¼Œæœ‰æ”¹åŠ¨ï¼‰ï¼š\né¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†æ–‡å­—ä¿¡æ¯è½¬æ¢ä¸ºä¾¿äºå¤„ç†çš„æ•°å­¦è®°å·ï¼Œè®°â€œEâ€è¡¨ç¤ºèƒ¡æ¨ï¼Œâ€œSâ€ è¡¨ç¤ºæ¨Ÿå­æ¾ã€‚ä»¤$X_k$è¡¨ç¤ºç§åœ¨ç¬¬$k$ä¸ªæ–¹æ ¼çš„æ ‘çš„ç§ç±»(æ ¹æ®é¢˜æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªéšæœºå˜é‡)ï¼Œä»¤$p_k=P(X_k = E)$,åˆ™ç”±é¢˜è®¾ï¼Œæœ‰ï¼š\n$$ p_1 = r \\tag{1} $$\nä¸”ç”±å…¨æ¦‚ç‡å…¬å¼\n$$\\begin{aligned}\n  p_k &= P(X_k = E) \\\\\n  &= P(X_k=E|X_{k-1}=E)P(X_{k-1}=E) \\\\\n  & + P(X_k=E|X_{k-1}=S)P(X_{k-1}=S) \\\\\n  &= sp_{k-1}+(1-t)(1-p_{k-1}) \\\\\n  &= (1-t)+(s+t-1)p_{k-1},\\forall k\\ge2 \n  \\end{aligned}$$\nä»¤$k=2$, æˆ‘ä»¬æœ‰ï¼š\n\n$$\\begin{aligned}\n    p_2 &=(1-t)+(s+t-1)p_{1} \\\\\n    &=(1-t)+(s+t-1)r \\\\\n    &=\\frac{3+2-2t}{3} \n  \\end{aligned}$$\nè‹¥$\\forall k \\ge 2,p_k=p_2$æˆç«‹ï¼Œåˆ™,\n\n\n\n$$ p_k = \\frac{1-t}{2-s-t},\\forall k \\ge 2 $$\n\næ•´ç†å¯å¾—\n\n$$(s-2t+1)(s+t-1)=0 $$\n\nå› ä¸º$s+t\\ne1$ï¼Œæ‰€ä»¥å½“$s-2t+1=0$æ—¶ï¼Œ$\\forall k \\ge 2, p_k = p_2$\n\n(b) é¢˜ç›®ç»™çš„$r,s,t$ä¸æ»¡è¶³(a)ä¸­çš„æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ±‚å‡ºä¸€èˆ¬æ¡ä»¶ä¸‹çš„æƒ…å†µã€‚\n\nä»¤$q_k = P(X_k=E|X_1 = E)$,åˆ™éœ€è¦æ±‚çš„æ¦‚ç‡æ˜¯ï¼š\n\n$$\n  P(X_1=E|X_n=E)=\\frac{P(X_n=E|X_1=E)}{P(X_n=E)}=\\frac{rq_n}{p_n},n=2019 \n$$\n\n(a)ä¸­å·²ç»æ±‚å‡ºäº†$p_k$å¾—é€’æ¨å¼, ä»¿ç…§(a)çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡º\n\n$$\n q_k=\\begin{cases}\n   1 , & k = 1 \\\\\n   (1-t)+(s+t-1)q_{k-1}, & k \\ge 2 \n \\end{cases}\n$$\n\nè§£ä¸Šè¿°é€’æ¨å¼ï¼Œå¯å¾—ï¼š\n\n$$\n  \\frac{q_n}{(s+t-1)}=\\frac{(1-t)[\\frac{1}{s+t-1}-\\frac{1}{(s+t-1)^n}]}{s+t-2}+\\frac{1}{s+t-1}\n$$\n\nç±»ä¼¼çš„ï¼Œç”±(2)å¯å¾—\n$$\n  \\frac{p_n}{(s+t-1)}=\\frac{(1-t)[\\frac{1}{s+t-1}-\\frac{1}{(s+t-1)^n}]}{s+t-2}+\\frac{r}{s+t-1}\n$$\n\næ‰€ä»¥æœ‰ï¼š\n$$\n   \\begin{aligned}\n    P(X_1=E|X_n=E) &= \\frac{rq_n}{p_n} \\\\\n    &=r\\frac{\\frac{(1-t)[\\frac{1}{s+t-1}-\\frac{1}{(s+t-1)^n}]}{s+t-2}+\\frac{1}{s+t-1}}{ \\frac{(1-t)[\\frac{1}{s+t-1}-\\frac{1}{(s+t-1)^n}]}{s+t-2}+\\frac{r}{s+t-1}},n=2019\n  \\end{aligned}\n$$\n\nå°†ç»™å…¥æ¡ä»¶å¸¦å…¥(å…¶å®ä¸ç”¨è®¡ç®—ï¼Œå› ä¸º$n=2019,q_n \\approx p_n$ï¼‰ï¼Œå¯å¾—$P(X_1=E|X_n=E)\\approx r =  1/3$\n\n","tags":["note","stochastic Process","Probability"],"categories":["math"]},{"title":"æœºå™¨å­¦ä¹ åœ¨ç”Ÿç‰©å­¦æœ‰åº”ç”¨å—","url":"/2020/04/16/æœºå™¨å­¦ä¹ åœ¨ç”Ÿç‰©å­¦æœ‰åº”ç”¨å—/","content":"\nè¯´æ˜ï¼šè½¬è‡ªç«™é•¿[çŸ¥ä¹å›ç­”](https://www.zhihu.com/question/41428117/answer/1156065522)ã€‚\n\nå½“ç„¶æœ‰åº”ç”¨ï¼Œè€Œä¸”æ˜¯å¾ˆå¹¿æ³›çš„åº”ç”¨ï¼Œå‘¨å¿—åè€å¸ˆçš„[ã€Šæœºå™¨å­¦ä¹ ã€‹](ã€Šæœºå™¨å­¦ä¹ ã€‹ \"å‘¨å¿—å\")ä¸­çš„ç¬¬1ç« çš„ç»ªè®ºçš„1.6èŠ‚åº”ç”¨ç°çŠ¶ä¸­è¿™æ ·å†™åˆ°ï¼š  \n\n> æœºå™¨å­¦ä¹ è¿˜ä¸ºè®¸å¤šäº¤å‰å­¦ç§‘æä¾›äº†é‡è¦çš„æŠ€æœ¯æ”¯æ’‘ã€‚ä¾‹å¦‚ï¼Œâ€œç”Ÿç‰©ä¿¡æ¯å­¦â€è¯•å›¾åˆ©ç”¨ä¿¡æ¯æŠ€æœ¯æ¥ç ”ç©¶ç”Ÿå‘½ç°è±¡å’Œè§„å¾‹ï¼Œè€ŒåŸºå› ç»„è®¡åˆ’çš„å®æ–½å’ŒåŸºå› è¯ç‰©çš„ç¾å¥½å‰æ™¯è®©äººä»¬ä¸ºä¹‹å¿ƒæ½®æ¾æ¹ƒã€‚ç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶æ¶‰åŠä»â€œç”Ÿå‘½ç°è±¡â€åˆ°â€œè§„å¾‹å‘ç°â€çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œå…¶é—´å¿…ç„¶åŒ…æ‹¬æ•°æ®è·å–ã€æ•°æ®ç®¡ç†ã€æ•°æ®åˆ†æã€ä»¿çœŸå®éªŒç­‰ç¯èŠ‚ï¼Œè€Œâ€œæ•°æ®åˆ†æâ€æ°æ˜¯æœºå™¨å­¦ä¹ æŠ€æœ¯çš„èˆå°ï¼Œå„ç§æœºå™¨å­¦ä¹ æŠ€æœ¯å·²ç»åœ¨è¿™ä¸ªèˆå°ä¸Šå¤§æ”¾å¼‚å½©ã€‚\n\nåœ¨æœ¬å›ç­”ä¸­ï¼Œæˆ‘ä»¬å°†ç»“åˆå…·ä½“çš„æ¡ˆä¾‹ï¼Œåˆ†ä¸‰éƒ¨åˆ†è®ºè¿°æœºå™¨å­¦ä¹ ï¼ˆåŒ…å«æ·±åº¦å­¦ä¹ ï¼‰åœ¨ç”Ÿç‰©ç ”ç©¶çš„åº”ç”¨ã€‚ç¬¬ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å…ˆå¯¹æœºå™¨å­¦ä¹ åœ¨ç”Ÿå‘½ç§‘å­¦é¢†åŸŸçš„ç ”ç©¶åšä¸€ä¸ªå…¨æ™¯çš„ä»‹ç»ã€‚ç¬¬äºŒéƒ¨åˆ†ï¼Œæˆ‘ä»¬å†ç»“åˆå…·ä½“æ¡ˆä¾‹å¦‚ä½•åº”ç”¨æœºå™¨å­¦ä¹ æ¨åŠ¨ç›¸å…³ç”Ÿç‰©ç ”ç©¶ï¼Œä»¥åŠç›¸å…³ç”Ÿç‰©ç ”ç©¶ä¸­å‡ºç°çš„é—®é¢˜å¦‚ä½•å‚¬ç”Ÿæ–°çš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚ç¬¬ä¸‰éƒ¨åˆ†æˆ‘ä»¬å°†è¿›è¡Œå›é¡¾å’Œåæ€ï¼Œæ¢è®¨æœªæ¥çš„æœºå™¨å­¦ä¹ å°†å¦‚ä½•æ›´å¥½çš„æ¨åŠ¨ç”Ÿç‰©ç ”ç©¶ã€‚\n\nåœ¨æ­£å¼è®¨è®ºä¹‹å‰ï¼Œæˆ‘ä»¬å€Ÿç”¨å‘¨å¿—åè€å¸ˆçš„ã€Šæœºå™¨å­¦ä¹ ã€‹ä¸€ä¹¦æ¥å¯¹æœºå™¨å­¦ä¹ ä¸‹ä¸€ä¸ªæè¿°æ€§çš„å®šä¹‰ï¼š\n\n> æœºå™¨å­¦ä¹ æ­£æ˜¯è¿™æ ·ä¸€é—¨å­¦ç§‘ï¼Œå®ƒè‡´åŠ›äºç ”ç©¶å¦‚ä½•é€šè¿‡è®¡ç®—çš„æ‰‹æ®µï¼Œåˆ©ç”¨ç»\néªŒæ¥ç«å–„ç³»ç»Ÿè‡ªèº«çš„æ€§èƒ½åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œ\"ç»éªŒ\"é€šå¸¸ä»¥\"æ•°æ®\"å½¢å¼å­˜\nåœ¨ï¼Œå› æ­¤æœºå™¨å­¦ä¹ æ‰€ç ”ç©¶çš„ä¸»è¦å†…å®¹ï¼Œæ˜¯å…³äºåœ¨è®¡ç®—æœºä¸Šä»æ•°æ®ä¸­äº§ç”Ÿ\"æ¨¡\nå‹\" (model) çš„ç®—æ³•ï¼Œå³\"å­¦ä¹ ç®—æ³•\" (learning algorithm). æœ‰äº†å­¦ä¹ ç®—æ³•ï¼Œæˆ‘ä»¬æŠŠç»éªŒæ•°æ®æä¾›ç»™å®ƒï¼Œå®ƒå°±èƒ½åŸºäºè¿™äº›æ•°æ®äº§ç”Ÿæ¨¡å‹;åœ¨é¢å¯¹æ–°çš„æƒ…å†µæ—¶(ä¾‹å¦‚çœ‹åˆ°ä¸€ä¸ªæ²¡å‰–å¼€çš„è¥¿ç“œ)ï¼Œæ¨¡å‹ä¼šç»™æˆ‘ä»¬æä¾›ç›¸åº”çš„åˆ¤æ–­(ä¾‹å¦‚å¥½ç“œ) .å¦‚æœè¯´\nè®¡ç®—æœºç§‘å­¦æ˜¯ç ”ç©¶å…³äº\"ç®—æ³•\"çš„å­¦é—®ï¼Œé‚£ä¹ˆç±»ä¼¼çš„ï¼Œå¯ä»¥è¯´æœºå™¨å­¦ä¹ æ˜¯ç ”ç©¶\nå…³äº\"å­¦ä¹ ç®—æ³•\"çš„å­¦é—®.\n\nåœ¨ä¸‹é¢çš„è®ºè¿°ä¸­ï¼Œæˆ‘ä»¬å°†ä»æ¦‚å†µä»¥åŠå…·ä½“çš„ç”Ÿç‰©åœºæ™¯çœ‹åˆ°è¿™ä¸ªå®šä¹‰è¿˜æ˜¯å¾ˆåˆç†çš„ã€‚\n\næœ¬å›ç­”å‡å®šè¯»è€…å·²ç»äº†è§£è¿‡ä¸€äº›æœºå™¨å­¦ä¹ å’Œç”Ÿç‰©çš„æ¦‚å¿µã€‚ \n\n### ä¸€. æœºå™¨å­¦ä¹ åœ¨ç”Ÿç‰©ç ”ç©¶ä¸­çš„åº”ç”¨æ¦‚è§ˆ\n\n#### 1. åŸºæœ¬æµç¨‹\n\nä¸€èˆ¬æ¥è¯´ï¼Œåœ¨ç”Ÿç‰©ç ”ç©¶ä¸­ï¼Œä¸€é¡¹åº”ç”¨æœºå™¨å­¦ä¹ ä¸­çš„ç®—æ³•çš„ç ”ç©¶å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹äº”æ­¥æµç¨‹ï¼š\n1. è®¾è®¡å®éªŒï¼Œæ”¶é›†æ•°æ®\n2. æ•°æ®æ¸…æ´—\n3. ç‰¹å¾é€‰æ‹©\n4. æ¨¡å‹æ„å»º\n5. æ¨¡å‹è¯„ä¼°\n\nå¦‚ä¸‹é¢çš„æµç¨‹å›¾ï¼Œæ¥è‡ª[Deep learning for computational biology](https://www.embopress.org/doi/10.15252/msb.20156651 \"Deep learning for computational biology\")æ‰€ç¤º\n\n![](https://imgkr.cn-bj.ufileos.com/288cd49c-6d39-414d-991c-cd62172f19d6.png)\n\n\n#### 2. æœ‰ç›‘ç£å­¦ä¹ ä¸æ— ç›‘ç£å­¦ä¹ \n\næ¨¡å‹æ„å»ºçš„æ–¹æ³•ï¼ŒæŒ‰ç…§ç ”ç©¶çš„é—®é¢˜å¯ä»¥åˆ†ä¸ºï¼Œæœ‰ç›‘ç£å’Œæ— ç›‘ç£çš„ã€‚\næœ‰ç›‘ç£å­¦ä¹ æ˜¯æŒ‡**ä¸€ç±»é’ˆå¯¹æœ‰æ ‡ç­¾çš„æ•°æ®æ¥é¢„æµ‹æ— æ ‡ç­¾æ•°æ®çš„æ ‡ç­¾çš„ç®—æ³•**ï¼Œå¦‚æœæˆ‘ä»¬æŠŠè¿ç»­æ•°å€¼å˜é‡ä¹Ÿè§†ä¸ºæ ‡ç­¾çš„è¯ï¼Œé‚£ä¹ˆå›å½’ä¹Ÿæ˜¯æœ‰ç›‘ç£å­¦ä¹ ã€‚è€Œæ— ç›‘ç£å­¦ä¹ æ˜¯æŒ‡**ä¸€ç±»é’ˆå¯¹æ— æ ‡ç­¾çš„æ•°æ®è¿›è¡Œè§„å¾‹å‘ç°çš„ç®—æ³•**ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿæœ‰åŠç›‘ç£å­¦ä¹ ï¼Œå³åœ¨ \n\nä¸€ä¸ªå…¸å‹çš„æœ‰ç›‘ç£çš„é—®é¢˜æ˜¯åˆ†ç±»é—®é¢˜ï¼Œä¸€ä¸ªå…¸å‹çš„æ— ç›‘ç£é—®é¢˜æ˜¯èšç±»é—®é¢˜ã€‚åœ¨è¿™ä¸ªå›ç­”æˆ‘ä»¬å°†ä»‹ç»è¿™ä¸¤ç±»é—®é¢˜çš„å…·ä½“çš„åœºæ™¯ã€‚ä¸‹å›¾æ¥è‡ªç»¼è¿°[Deep learning for computational biology]()\n\n![](https://imgkr.cn-bj.ufileos.com/a8545fe7-dfa9-4fd3-8516-8f8ad51ded9a.png)\n\n#### 3. ä¸‰ç±»åŸºæœ¬æ•°æ®\n\nå¤§å¤šæ•°ç”Ÿç‰©ç ”ç©¶ä¸»è¦å¯¹åºåˆ—æ•°æ®ï¼ŒçŸ©é˜µæˆ–è€…å¼ é‡æ•°æ®ï¼Œæˆåƒæ•°æ®è¿™ä¸‰ç±»åŸºæœ¬çš„æ•°æ®ä¸Šè¿›è¡Œæœºå™¨å­¦ä¹ ç®—æ³•çš„åº”ç”¨ã€‚\n\n##### 3.1 åºåˆ—æ•°æ®\n\næœ€åŸºæœ¬çš„ç”Ÿç‰©æ•°æ®ä¹‹ä¸€ï¼Œé€šå¸¸ä¸ºDNAåºåˆ—ï¼ŒRNAåºåˆ—ï¼Œè›‹ç™½è´¨åºåˆ—ã€‚\nåœ¨äººç±»åŸºå› ç»„è®¡åˆ’æ—©æœŸçš„é—®é¢˜æ˜¯ï¼Œå¦‚ä½•å¿«é€Ÿè¿›è¡ŒåŸºå› ç»„æ³¨é‡Šï¼Œè¯¥é—®é¢˜å¯ä»¥è¡¨ç¤ºå¦‚ä¸‹,å›¾ç‰‡æ¥è‡ª[Machine learning applications in genetics and genomics](https://www.nature.com/articles/nrg3920 \"Machine learning applications in genetics and genomics\")ï¼š\n\n![](https://imgkr.cn-bj.ufileos.com/a401af41-2bf4-43f3-bdaf-e453ed95e82b.png)\n\nåŸºå› ç»„æ³¨é‡Šæ˜¯ä¸€ä¸ªæœ‰ç›‘ç£æˆ–è€…åŠç›‘ç£çš„é—®é¢˜ï¼Œå› ä¸ºä¸€æ®µåºåˆ—æ˜¯ä¸æ˜¯åŸºå› å¯ä»¥é€šè¿‡EST(è¡¨è¾¾åºåˆ—æ ‡ç­¾)æ¥åˆ¤å®šï¼Œå…¶ä»–ç‰¹å¾å¯ä»¥é€šè¿‡ä¸€äº›ç”ŸåŒ–æˆ–è€…åˆ†å­å®éªŒæ¥æ ‡å®šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ•°æ®æ ‡ç­¾ã€‚\n\næ­¤å¤–ï¼Œåºåˆ—æ•°æ®æ›´ä¸ºå¸¸è§çš„æ˜¯è¦åˆ†æä¸€äº›åˆ†å­æ¼”åŒ–çš„é—®é¢˜ï¼Œä¾‹å¦‚æœ€è¿‘å¤§å®¶å…³æ³¨çš„æ–°å† ç—…æ¯’çš„åˆ†å­æ¼”åŒ–ã€‚è¿™æ–¹é¢çš„æ¡ˆä¾‹å’Œç›¸å…³è®¨è®ºå¯è§ï¼š[å‰‘æ¡¥å¤§å­¦ç ”ç©¶ç§°æ–°å† ç—…æ¯’åˆ†ä¸‰ä¸ªå˜ç§ï¼ŒA ç±»ç—…æ¯’ä¸ºã€Œçˆ†å‘æ ¹æºã€ï¼Œæ›´å¤šå‘ç°äºç¾å›½å’Œæ¾³æ´²ï¼Œè¿™ä¸€ç»“è®ºé è°±å—ï¼Ÿ](https://www.zhihu.com/question/386740743 \"å‰‘æ¡¥å¤§å­¦ç ”ç©¶ç§°æ–°å† ç—…æ¯’åˆ†ä¸‰ä¸ªå˜ç§ï¼ŒA ç±»ç—…æ¯’ä¸ºã€Œçˆ†å‘æ ¹æºã€ï¼Œæ›´å¤šå‘ç°äºç¾å›½å’Œæ¾³æ´²ï¼Œè¿™ä¸€ç»“è®ºé è°±å—ï¼Ÿ\")\n\nè¿™æ˜¯ä¸€ä¸ªæ— ç›‘ç£çš„é—®é¢˜ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å…¶å®å¹¶ä¸çŸ¥é“æ–°å† ç—…æ¯’å¯ä»¥åˆ†ä¸ºå‡ ä¸ªå˜ç§ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ•°æ®ä¸­çœ‹å‡ºå®ƒèƒ½åˆ†æˆå‡ ç±»ï¼Œç„¶åå†é€šè¿‡å…¶ä»–è¯æ®è¯æ˜è¿™ç§åˆ†ç±»æ˜¯åˆç†çš„ã€‚\n\n##### 3.2 çŸ©é˜µæ•°æ®\n\nèŠ¯ç‰‡æŠ€æœ¯å’Œåç»­çš„é«˜é€šé‡æµ‹åºæŠ€æœ¯å¸¦æ¥äº†å¾ˆå¤šç§çŸ©é˜µæ•°æ®,è¿™ç±»çŸ©é˜µé€šå¸¸æ˜¯å¯¹æŸç±»å‹ç”Ÿç‰©ç‰¹å¾ï¼ˆåŸºå› ï¼Œè›‹ç™½ï¼Œè¡¨è§‚ä¿®é¥°ï¼ŒæŸ“è‰²è´¨äº’ä½œï¼‰çš„ä¸°åº¦æ±‡æ€»è€Œæˆçš„ã€‚æœ€å…¸å‹çŸ©é˜µæ•°æ®æ˜¯åŸºå› è¡¨è¾¾è°±ï¼ŒåŸºå› è¡¨è¾¾è°±çŸ©é˜µå¯ä»¥é€šè¿‡RNA-seqæ•°æ®è¿›è¡Œæ¯”å¯¹åçš„è½¬å½•æœ¬å®šé‡äº§ç”Ÿï¼ŒåŸºæœ¬æµç¨‹å’Œå¸¸è§åˆ†æç­–ç•¥å¦‚ä¸‹ï¼ˆå›¾ç‰‡æ¥è‡ª[Enter the Matrix: Factorization Uncovers Knowledge from Omics](https://linkinghub.elsevier.com/retrieve/pii/S0168-9525(18)30124-0 \"Enter the Matrix: Factorization Uncovers Knowledge from Omics\"))ï¼š\n\n![](https://imgkr.cn-bj.ufileos.com/bdd2cf7f-00d1-4735-90a9-45206a6d4f00.png)\n\nè¿™ç±»æ•°æ®çš„åˆ†æé€šå¸¸æ˜¯æ— ç›‘ç£æˆ–è€…åŠç›‘ç£çš„ï¼Œæˆ‘ä»¬é€šå¸¸æƒ³é€šè¿‡çŸ©é˜µæ•°æ®å»å‘ç°ä¸€äº›å¯ç”¨äºè¯Šæ–­çš„åˆ†å­markerã€‚\n\n##### 3.3 æˆåƒæ•°æ®\n\nä»æ•°æ®å­˜å‚¨çš„æœ¬è´¨ä¸Šè®²ï¼Œæˆåƒæ•°æ®è¿˜æ˜¯çŸ©é˜µæ•°æ®ï¼ˆä¸è¿‡è€ƒè™‘åˆ°å¤šé€šé“å›¾åƒçš„å­˜åœ¨ï¼Œç§°ä¸ºå¼ é‡æ•°æ®æ›´ä¸ºè´´åˆ‡ï¼‰ï¼Œä½†æ˜¯å†…æ¶µä¸Šæ˜¯ä¸åŒçš„ï¼Œæˆåƒæ•°æ®è¡¨è¾¾æ›´å¤šçš„æ˜¯ç”Ÿç‰©ä½“å†…éƒ¨ç©ºé—´ä½ç½®ï¼ˆè¿˜æœ‰å½¢çŠ¶æˆ–è€…ç»“æ„ï¼‰çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œä¸€å¼ è›‹ç™½äºšç»†èƒå®šä½çš„å›¾åƒï¼Œå¯ä»¥åæ˜ æŸæ ‡è®°çš„æ„Ÿå…´è¶£çš„è›‹ç™½è´¨ä½äºç»†èƒä¸­çš„ä»€ä¹ˆä½ç½®ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¾ˆå¤šè¿™æ ·çš„å›¾ç‰‡ï¼Œæ˜æ™ºçš„æ–¹æ³•æ˜¯å…ˆæ ‡è®°ä¸€éƒ¨åˆ†æ•°æ®ï¼Œè®­ç»ƒä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œï¼Œç„¶åå†å¯¹å‰©ä¸‹çš„å›¾ç‰‡è¿›è¡Œé¢„æµ‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œï¼š \n\n![å›¾ç‰‡æ¥è‡ªç»¼è¿°[2]()](https://imgkr.cn-bj.ufileos.com/2b1dca0a-9369-4ea0-8712-bd0a650e751e.png)\n\n#### 4. å…³äºæ·±åº¦å­¦ä¹ åŠå…¶åœ¨ç”Ÿç‰©ç ”ç©¶ä¸­çš„åº”ç”¨\n\næ·±åº¦å­¦ä¹ åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼ŒæŒ‰ç…§Yann LeCun, Yoshua Bengioï¼ŒGeoffrey Hintonä¸‰ä½ä¸“å®¶åˆå†™çš„[ç»¼è¿°](https://www.nature.com/articles/nature14539 \"Deep Learning\")çš„å®šä¹‰ï¼š\n> Deep-learning methods are representation-learning methods with multiple levels of representation, obtained by composing simple but non-linear modules that each transform the representation at one level (starting with the raw input) into a representation at a higher, slightly more abstract level. With the composition of enough such transformations, very complex functions can be learned For.\n\næ‹™è¯‘ä¸ºï¼šæ·±åº¦å­¦ä¹ æ–¹æ³•æ˜¯ä¸€ç§åŸºäºå¤šç§å±‚çº§è¿›è¡Œè¡¨ç¤ºçš„è¡¨ç¤ºå­¦ä¹ æ–¹æ³•ã€‚å…¶è¡¨ç¤ºèƒ½åŠ›æ˜¯é€šè¿‡ç»„åˆç®€å•çš„éçº¿æ€§çš„æ¨¡å—å®ç°çš„ã€‚æ¯ä¸€ä¸ªå°æ¨¡å—éƒ½å¯ä»¥æŠŠç¬¬ä¸€å±‚çš„åŸå§‹æ•°æ®è½¬æ¢ä¸ºæ›´ç¨å¾®æŠ½åƒçš„ç‰¹å¾ã€‚é€šè¿‡è¶³å¤Ÿå¤šçš„è¿™æ ·çš„è½¬æ¢è¿›è¡Œç»„åˆï¼Œå¯ä»¥å­¦ä¹ åˆ°éå¸¸å¤æ‚çš„å‡½æ•°(åŠŸèƒ½)ã€‚\n\nç›®å‰ï¼Œåœ¨åŸºå› ç»„å­¦çš„ä¸åŒå±‚çº§ï¼Œå‡æœ‰æ·±åº¦å­¦ä¹ çš„åº”ç”¨æ¡ˆä¾‹ï¼š\n\n![](https://imgkr.cn-bj.ufileos.com/2436e54e-084f-4598-8c33-3fd44573caa2.png)\n\nå›¾ç‰‡æ¥è‡ª[A primer on deep learning in genomics](https://www.nature.com/articles/s41588-018-0295-5 \"A primer on deep learning in genomics\"),æƒ³äº†è§£æ›´å¤šï¼Œè¯·é˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚\n\n#### 5. å¸¸è§ä¸åŒæœºå™¨ç®—æ³•çš„å®ç°è½¯ä»¶\n\né’ˆå¯¹ä¸åŒçš„å­¦ä¹ ç®—æ³•ï¼Œåœ¨Rä¸­çš„å¯ç”¨çš„æœºå™¨å­¦ä¹ åŒ…å¦‚ä¸‹ï¼Œå›¾ç‰‡æ¥è‡ª[Machine learning for Big Data analytics in plants](https://www.sciencedirect.com/science/article/abs/pii/S1360138514002192 \"Machine learning for Big Data analytics in plants\"):\n\n![](https://imgkr.cn-bj.ufileos.com/4bb8fef8-d541-478f-8031-bc56bd1ce489.png)\n\npythonä¸Šçš„å¸¸ç”¨ç›¸å…³è½¯ä»¶åŒ…å¦‚ä¸‹.å›¾ç‰‡æ¥è‡ª[Best Python Libraries for Machine Learning and Deep Learning](https://towardsdatascience.com/best-python-libraries-for-machine-learning-and-deep-learning-b0bd40c7e8c \"Best Python Libraries for Machine Learning and Deep Learning\")ï¼š\n\n\n![Best Python Libraries for Machine Learning and Deep Learning](https://imgkr.cn-bj.ufileos.com/0b60d14c-3193-40f4-9d3d-da31e4511e61.png)\n\n\n### äºŒ. æœºå™¨å­¦ä¹ åœ¨ç”Ÿç‰©ç ”ç©¶ä¸­çš„åº”ç”¨æ¡ˆä¾‹\n\n#### 1. åŸºäºæœºå™¨å­¦ä¹ çš„å·®å¼‚è¡¨è¾¾ç½‘ç»œåˆ†æ\n\nç”Ÿç‰©å­¦å®¶å¾ˆæ„Ÿå…´è¶£çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œä¸åŒæ¡ä»¶ä¸‹å“ªäº›åŸºå› è¡¨è¾¾ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™æ ·ä»–ä»¬å¯ä»¥æ·±å…¥ç ”ç©¶å…¶ä¸­çš„åˆ†å­æœºåˆ¶ï¼Œè¿›è€Œæ‰¾åˆ°ä¸€äº›å¯ä»¥æ‰¾åˆ°ä¸€äº›å¢å¼ºæˆ–è€…å‡å¼±ä»–ä»¬æƒ³è¦ç ”ç©¶è¡¨å‹çš„é¶ç‚¹ã€‚\n\nå¸¸è§çš„æ€è·¯æ˜¯åšå‡å®šåŸºå› è¡¨è¾¾æœä»ä¸€ä¸ªåˆ†å¸ƒï¼Œç„¶åæ ¹æ®è¿™ä¸ªå‡è®¾æ„å»ºç»Ÿè®¡é‡ï¼Œè®¡ç®—ç»Ÿè®¡æ˜¾è‘—æ€§ï¼Œè®¾ç½®cutoffæ¥ç­›é€‰å‘ç”Ÿå·®å¼‚è¡¨è¾¾çš„åŸºå› ã€‚\n\nä½†æ˜¯è¿™æ ·åšå¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œä¾‹å¦‚cutoffä¸º $p < 0.05$,é‚£äº›è¢«åˆ¤å®šä¸ºç»Ÿè®¡ä¸æ˜¾è‘—çš„åŸºå› å°±çœŸçš„å’Œè¡¨å‹ç›¸å…³çš„å·®å¼‚è¡¨è¾¾åŸºå› å—ï¼Ÿæœ‰æ— æ›´å¥½çš„æ›¿ä»£æ–¹æ³•ï¼Ÿ\n\næ–‡çŒ®[Machine Learningâ€“Based Differential Network Analysis: A Study of Stress-Responsive Transcriptomes in Arabidopsis](http://www.plantcell.org/content/26/2/520/tab-figures-data \"Machine Learningâ€“Based Differential Network Analysis: A Study of Stress-Responsive Transcriptomes in Arabidopsis\")æä¾›äº†ä¸€ç§æ€è·¯ã€‚å‡å®šæˆ‘ä»¬å¯¹äºæ¨¡å¼æ¤ç‰©æ‹Ÿå—èŠ¥å“åº”å„ç§èƒè¿«æ¡ä»¶æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŸºäºæœºå™¨å­¦ä¹ çš„ç­–ç•¥å¯¹äºä¹‹å‰çš„å·®å¼‚è¡¨è¾¾æ–¹æ³•åšå‡ºæ”¹è¿›ï¼Œåˆ†ä¸ºå¦‚ä¸‹æ­¥éª¤ï¼š\n\n1ï¼‰æ•°æ®æ”¶é›†ï¼Œæ¸…æ´—ä»¥åŠæ­£è´Ÿæ ·æœ¬æ„å»ºï¼š\næ”¶é›†ä¸åŒèƒè¿«æ¡ä»¶ä¸‹çš„åŸºå› è¡¨è¾¾è°±(åŸºå› èŠ¯ç‰‡æ•°æ®ï¼‰ï¼Œè¿›è¡Œé¢„å¤„ç†å’Œæ ‡å‡†åŒ–ï¼Œæ”¶é›†ä¹‹å‰æŠ¥å¯¼è¿‡çš„å’Œç›¸å…³çš„åŸºå› ä½œä¸ºæ­£æ ·æœ¬ï¼Œå°†è¡¨è¾¾è°±ä¸­ä¸å‘ç”Ÿå˜åŒ–çš„åŸºå› ä½œä¸ºè´Ÿæ ·æœ¬ï¼Œå‰©ä¸‹çš„åŸºå› çš„è¡¨è¾¾è°±ä½œä¸ºæ— æ ‡ç­¾æ ·æœ¬ï¼›\n\n2ï¼‰ç‰¹å¾æå–ï¼š\né€šè¿‡å…±è¡¨è¾¾ç½‘ç»œçš„ç­–ç•¥ä»è¡¨è¾¾è°±ä¸­æå–ç‰¹å¾ã€‚åœ¨æ„å»ºå…±è¡¨è¾¾ç½‘ç»œçš„ä¹‹åï¼Œé‡‡ç”¨éšæœºæ£®æ—çš„æ–¹æ³•æŠŠæœªæ ‡ç­¾çš„æ ·æœ¬ä¸­çš„â€œnoninformativeâ€ genesï¼ˆä¸è¡¨è¾¾ï¼ŒæŒç»­è¡¨è¾¾ï¼Œä¸èƒè¿«æ— å…³çš„åŸºå› )è¿‡æ»¤æ‰äº†ï¼Œå‡å°‘äº†å…±è¡¨è¾¾ç½‘ç»œæ„å»ºçš„æ— ç”¨ä¿¡æ¯ã€‚è®¡ç®—æ¯ä¸ªåŸºå› åœ¨å…±è¡¨è¾¾ç½‘ç»œä¸­çš„PageRankç­‰ç»Ÿè®¡é‡ï¼Œä½œä¸ºç‰¹å¾ï¼›\n\n3ï¼‰æ¨¡å‹æ„å»ºï¼š\næ ¹æ®2ï¼‰ä¸­è®¡ç®—çš„ç‰¹å¾ï¼Œä»åˆ†å¥½çš„æ­£è´Ÿæ ·æœ¬ä¸­ï¼Œå†æ¬¡éšæœºæ£®æ—æ„å»ºæ¨¡å‹ï¼›\n\n4ï¼‰æ¨¡å‹è¯„ä¼°\nå’Œlimmaç­‰æ–¹æ³•æ¯”è¾ƒï¼›\n\n5ï¼‰æ¨¡å‹é¢„æµ‹ï¼Œå¹¶è¿›è¡ŒéªŒè¯\nå°†è®­ç»ƒå¥½çš„æ¨¡å‹åº”ç”¨äºæ— æ ‡è®°çš„åŸºå› ä¸Šï¼Œé¢„æµ‹å‡ºå’Œæ–°çš„èƒè¿«ç›¸å…³çš„åŸºå› ï¼Œå¹¶é€šè¿‡TDNAæ’å…¥å®éªŒéªŒè¯ã€‚\n\nä¸Šè¿°æ­¥éª¤å¯ä»¥æ¦‚æ‹¬å¦‚ä¸‹ï¼Œ\n![](https://imgkr.cn-bj.ufileos.com/d6922ac4-dcca-4705-ad3c-9092da5c7813.png)\n\nå›¾ç‰‡æ¥è‡ª[Machine learning for Big Data analytics in plants]()\n\n#### 2. å¹²ç»†èƒåˆ†åŒ–è·¯å¾„é‡æ„ä¸æµå½¢å­¦ä¹ \n\n\næ¡ˆä¾‹1æ˜¯æœ‰ç›‘ç£å­¦ä¹ çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çœ‹æ— ç›‘ç£å­¦ä¹ çš„æ¡ˆä¾‹ã€‚\n\nç”Ÿç‰©å­¦æœ‰ä¸€ä¸ªå¾ˆè‘—åçš„æ¨¡å‹å«åšwaddington landscapeï¼Œè¯¥æ¨¡å‹æè¿°äº†å¹²ç»†èƒåœ¨åˆ†åŒ–è¿‡ç¨‹å¯ä»¥ç±»æ¯”äºä¸€ä¸ªæœ‰è´¨é‡çš„å°çƒè‡ªå‘æ²¿ç€å±±å¡ä»å±±é¡¶æ»šä¸‹å±±è°·çš„è¿‡ç¨‹ï¼Œä¸åŒçš„å±±åº•è¡¨ç¤ºäº†ç»†èƒçš„ç»ˆæœ«åˆ†åŒ–çŠ¶æ€ï¼Œè€Œä¸åŒçš„åˆ†æ”¯ç‚¹çš„å­˜åœ¨åˆ™æ˜¯ç»†èƒå‘½è¿å†³å®šçš„èŠ‚ç‚¹ã€‚è¿™ä¸ªè¿åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œç»†èƒçš„åŸºå› è¡¨è¾¾ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœæˆ‘ä»¬å‡å®šåŸºå› è¡¨è¾¾â€œç›¸è¿‘â€çš„ç»†èƒåœ¨è·¯å¾„ä¸Šä¹ŸæŒ¨å¾—å¾ˆè¿‘ï¼Œé‚£ä¹ˆåœ¨åŸºå› è¡¨è¾¾çš„é«˜ç»´æ•°æ®ä¸­åº”è¯¥åµŒå…¥äº†ä½ç»´çš„åˆ†åŒ–è·¯å¾„ï¼Œåˆ™æˆ‘ä»¬èƒ½é€šè¿‡æµå½¢å­¦ä¹ çš„æŠ€æœ¯ä»åŸºå› è¡¨è¾¾æ•°æ®ä¸­é‡æ„å‡ºåˆ†åŒ–çš„è·¯å¾„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ\n\n![](https://imgkr.cn-bj.ufileos.com/80ff5e2b-bc24-4584-8e75-d7c71107e5d4.png)\n\nå›¾ç‰‡æ¥è‡ª[Manifold learning-based methods for analyzing single-cell RNA-sequencing data](https://www.sciencedirect.com/science/article/pii/S2452310017301877 \"Manifold learning-based methods for analyzing single-cell RNA-sequencing data\")\n\nå…·ä½“æ¥è¯´ï¼Œæµå½¢å­¦ä¹ æ˜¯å¦‚ä½•è¿›è¡Œçš„å‘¢ï¼Ÿå¯ä»¥ç»“åˆå¦‚ä¸‹çš„æ¡ˆä¾‹è¿›è¡Œç†è§£ã€‚ç°åœ¨æœ‰ä¸¤ä¸ªå˜é‡ç»„æˆçš„ä¸€ä¸ªæ•°æ®é›†ï¼Œæˆ‘ä»¬å°†å…¶ç”»åœ¨ç›´è§’åæ ‡ç³»ä¸­ï¼Œå¯ä»¥çœ‹å‡ºæ ·æœ¬ç‚¹ä¸­å­˜åœ¨ä¸€ä¸ªèºæ—‹çš„è¶‹åŠ¿ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªäºŒç»´æ•°æ®é›†ä¸­ä¼¼ä¹åµŒå…¥äº†ä¸€ä¸ªä¸€ç»´æµå½¢ã€‚å¦‚ä½•é€šè¿‡è®¡ç®—çš„æ–¹å¼å°†å…¶æ‰¾å‡ºæ¥å‘¢ã€‚ç›´è§‰å‘Šè¯‰æˆ‘ä»¬ï¼Œå¿…é¡»å…ˆè®¡ç®—æ¯ä¸¤ä¸ªæ ·æœ¬ç‚¹ä¹‹é—´è·ç¦»ã€‚æˆ‘ä»¬åœ¨æ ·æœ¬ç‚¹ä¹‹é—´çš„è·ç¦»ä¹‹åå‘¢ï¼Œä¼šå‘ç°è¿™ä¸ªè·ç¦»é‡Œæ ·æœ¬ç‚¹çš„å±€éƒ¨é‚»è¿‘å…³ç³»å’Œæ•´ä½“é‚»è¿‘å…³ç³»æ··æ·†åœ¨äº†ä¸€èµ·ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å«åšæ ¸å‡½æ•°çš„æŠ€å·§ï¼Œå°†è·ç¦»è½¬æ¢ä¸ºé‚»è¿‘å…³ç³»ã€‚å¾—åˆ°å±€éƒ¨çš„è·ç¦»ä¹‹åå‘¢ï¼Œæˆ‘ä»¬æŠŠç›¸é‚»çš„ç‚¹è¿èµ·æ¥ï¼Œè¿™æ ·ä¾¿å¯ä»¥æœ€ç»ˆå¾—åˆ°é‚£ä¸ªæ ·æœ¬ç‚¹ä¸­åŒ…å«çš„èºæ—‹çš„ä¸€ç»´æµå½¢äº†ã€‚\n\n![](https://imgkr.cn-bj.ufileos.com/a55bbb0c-41f6-4fc2-bc73-f80aaa4e2f9b.png)\n\nå›¾ç‰‡æ¥è‡ª[Manifold learning-based methods for analyzing single-cell RNA-sequencing data]()\n\né™„æ³¨ï¼šç²—æµ…çš„æ¥è¯´ï¼Œæ‰€è°“æµå½¢å°±æ˜¯ä¸€ä¸ªå±€éƒ¨çœ‹èµ·æ¥åƒæ˜¯æ¬§å‡ é‡Œå¾—ç©ºé—´çš„æ‹“æ‰‘ç©ºé—´ã€‚æ¯ä¸ªå±äºè¿™ä¸ªnç»´æµå½¢çš„ç‚¹çš„é‚»åŸŸéƒ½å¯ä»¥ä¸ä¸€ä¸ªnç»´æ¬§æ°ç©ºé—´å»ºç«‹ä¸€ä¸€æ˜ å°„çš„å…³ç³»ã€‚ï¼ˆæ›´ä¸ºä¸¥è°¨çš„å®šä¹‰è¯·çœ‹æ‹“æ‰‘å­¦æ•™æï¼‰ã€‚æµå½¢å­¦ä¹ ä¸€èˆ¬æ˜¯ç”¨æ¥å­¦ä¹ é«˜ç»´æ•°æ®å†…éƒ¨çš„ä½ç»´ç»“æ„ã€‚æœ€åŸºç¡€æµå½¢å­¦ä¹ ç®—æ³•æ˜¯PCAã€‚\n\n\nä»¥æœ€è¿‘å‘è¡¨çš„ä¸€ç§åŒæ—¶å®ç°ç”Ÿç‰©é«˜ç»´æ•°æ®å¯è§†åŒ–å’Œè·¯å¾„æ¨æ–­çš„ç®—æ³•[PHATE](https://www.nature.com/articles/s41587-019-0336-3 \"Visualizing structure and transitions in high-dimensional biological data\")ä¸ºä¾‹ï¼Œè¯¥ç®—æ³•çš„æµç¨‹å¦‚ä¸‹ï¼Œï¼ˆå›¾ç‰‡æ¥è‡ªåŸæ–‡çŒ®ï¼‰ï¼š\n\n![](https://imgkr.cn-bj.ufileos.com/2ed9f281-dd11-4ff2-a524-1c6c1218d4d6.png)\n\nè¯¥ç®—æ³•çš„åŸºæœ¬æµç¨‹å’Œå…¶ä»–çš„æµå½¢å­¦ä¹ æ–¹æ³•å¤§è‡´ç±»ä¼¼ï¼Œä½†æ˜¯ä»–ä»¬çš„åˆ›æ–°ä¹‹å¤„æ˜¯å¼•å…¥äº†éšæœºæ¸¸èµ°ï¼Œè®¡ç®—æ‰©æ•£æ¦‚ç‡ï¼Œä»¥åŠæœ€ç»ˆè®²æ¬§å¼è·ç¦»è½¬åŒ–ä¸ºä¿¡æ¯è·ç¦»æ¥è¿›è¡Œembedingã€‚\n\nç¯‡å¹…æ‰€é™ï¼Œæˆ‘ä»¬ä¸ä¼šåœ¨è¿™é‡Œè°ˆå¾ˆå¤šè¯¥ç®—æ³•çš„è®¡ç®—ç»†èŠ‚ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯çœ‹çŸ¥ä¹ä¸Šä¸­æ–‡çš„ä»‹ç»ï¼š[Nat. Biotechnol | PHATEï¼šé«˜ç»´ç”Ÿç‰©æ•°æ®çš„å¯è§†åŒ–æ–¹æ³•\n](https://zhuanlan.zhihu.com/p/102456357 \"Nat. Biotechnol | PHATEï¼šé«˜ç»´ç”Ÿç‰©æ•°æ®çš„å¯è§†åŒ–æ–¹æ³•\")ï¼Œæˆ–è€…ç›´æ¥é˜…è¯»åŸå§‹æ–‡çŒ®ã€‚\n\n\n#### 3.å†·å†»ç”µé•œä¸­çš„å›¾åƒå¤„ç†\n\nè¿™éƒ¨åˆ†ï¼Œç¬”è€…ä¸æ˜¯ä¸“å®¶ï¼Œåªæ˜¯ä¸ºäº†æ‹“å±•è§†é‡åœ¨é‡Œè®°å½•ã€‚\n\nåŸºç¡€çŸ¥è¯†æ¨èå¤§å®¶çœ‹ä¸‹courseraä¸Šé¢çš„åŠ å·ç†å·¥çš„å†·å†»ç”µé•œçš„è¯¾ç¨‹ï¼Œå°¤å…¶æ˜¯Tomographyé‚£ä¸€èŠ‚ã€‚\nå…³äºå†·å†»ç”µé•œçš„èƒŒæ™¯å¤§å®¶è¯·çœ‹\n[ä¸ºä»€ä¹ˆå†·å†»ç”µé•œ (Cryo-EM) å»å¹´çªç„¶ç«äº†ï¼Ÿæ˜¯æœ‰ä»€ä¹ˆæŠ€æœ¯çªç ´å—ï¼Ÿ](https://daily.zhihu.com/story/4303110 \"ä¸ºä»€ä¹ˆå†·å†»ç”µé•œ (Cryo-EM) å»å¹´çªç„¶ç«äº†ï¼Ÿæ˜¯æœ‰ä»€ä¹ˆæŠ€æœ¯çªç ´å—ï¼Ÿ\") \nä»¥åŠ[ä»€ä¹ˆæ˜¯2015å¹´æœ€å—ç§‘å­¦ç•Œå…³æ³¨çš„æ–°æŠ€æœ¯ï¼Ÿ](https://zhuanlan.zhihu.com/p/20555975 \"ä»€ä¹ˆæ˜¯2015å¹´æœ€å—ç§‘å­¦ç•Œå…³æ³¨çš„æ–°æŠ€æœ¯ï¼Ÿ\")\nå½“ç„¶è¿˜æœ‰natureçš„[æ–°é—»ç¨¿](https://www.nature.com/news/the-revolution-will-not-be-crystallized-a-new-method-sweeps-through-structural-biology-1.18335 \"The revolution will not be crystallized: a new method sweeps through structural biology\")\n\næ ¹æ®natureè¿™ç¯‡æ–°é—»ç¨¿ï¼Œå†·å†»ç”µé•œå–å¾—çªç ´æ€§è¿›å±•ä¸»è¦è¦å½’åŠŸäºä¸¤ä¸ªäººï¼šRichard Hendersonå’ŒSjors Scheresè¿˜æœ‰ä»–ä»¬æ‰€åœ¨çš„å®éªŒå®¤ï¼šUK Medical Research Council Laboratory of Molecular Biology (LMB)ã€‚Richard Hendersonå’Œä»–çš„åŒäº‹ Nigel Unwin åœ¨1975å¹´çš„ä¸€ç‰‡æ–‡ç« ï¼ˆMolecular structure determination by electron microscopy of unstained crystalline specimensï¼‰ä¸­ä¸ºå†·å†»ç”µé•œæŠ€æœ¯åšå‡ºäº†å¥ åŸºæ€§çš„è´¡çŒ®ã€‚è€Œæ–°å‘å±•çš„ç›´æ¥ç”µå­æ¢æµ‹å™¨ä½¿å¾—å¯¹å¤§åˆ†å­çš„é«˜é€ŸåŠ¨æ€æˆåƒæˆä¸ºå¯èƒ½ã€‚æ–°æŠ€æœ¯å¸¦æ¥çš„å¤§æ•°æ®ä½¿å¾—Sjors Scheresæœ‰äº†åœ¨[æ–¹æ³•å­¦](https://www.sciencedirect.com/science/article/abs/pii/S0022283605001932?via%3Dihub \"Maximum-likelihood Multi-reference Refinement for Electron Microscopy Images\")å’Œ[è½¯ä»¶](https://www.sciencedirect.com/science/article/pii/S1047847712002481 \"RELION: Implementation of a Bayesian approach to cryo-EM structure determination\")ä¸Šçš„çªç ´ã€‚\n\né‚£ä¹ˆï¼Œå†·å†»ç”µé•œå¸¦æ¥çš„ç»“æ„ç”Ÿç‰©å­¦çš„é©å‘½æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿç­”æ¡ˆæ˜¯å€Ÿç”¨åˆ°æœºå™¨å­¦ä¹ çš„æ€æƒ³ä¸æ–¹æ³•çš„ï¼Œå¦‚ä¸‹é¢è¿™å¼ å›¾æ‰€ç¤ºï¼š\n\n\n\n![](https://imgkr.cn-bj.ufileos.com/c046c016-c2bd-4c8f-ab90-e7db1021b824.png)\n\n\n\nï¼ˆæ¥è‡ª[How cryo-EM is revolutionizing structural biology](http://www.sciencedirect.com/science/article/pii/S096800041400187X \"How cryo-EM is revolutionizing structural biology\"))\n\nç¬¬ä¸€æ­¥ï¼Œå°†è¦è§£æçš„è›‹ç™½åˆ†ç¦»çº¯åŒ–åˆ¶æ ·ä¹‹åï¼Œç”¨é«˜é€ŸåŠ¨æ€æˆåƒçš„è®°å½•è›‹ç™½çš„å„ç§æ„è±¡;\nç¬¬äºŒæ­¥ï¼Œå¤„ç†å›¾åƒæ•°æ®ï¼ŒæŠŠå–å‘ç›¸åŒçš„å°é¢—ç²’re-alignï¼Œå€Ÿç”¨è´å¶æ–¯çš„æ€æƒ³ï¼›ä»è€Œå°†ç²—é¢—ç²’çš„æ¨¡å‹ç²¾ç»†åŒ–;\nç¬¬ä¸‰æ­¥ï¼Œå¦‚æœæ˜¯æ··æ ·çš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨åˆ†ç±»æˆ–è€…èšç±»çš„æ–¹æ³•ï¼Œå°†æ··æ ·ä¸­å­˜åœ¨çš„ä¸åŒç»“æ„çš„è›‹ç™½æ„åƒè§£æå‡ºæ¥ã€‚\n\nç¬¬äºŒæ­¥çš„åŸºäºè´å¶æ–¯çš„re-alignå’Œç²¾ç»†åŒ–å¯ä»¥æ¦‚æ‹¬å¦‚ä¸‹ï¼š\n\n![](https://imgkr.cn-bj.ufileos.com/84bb8588-fb72-4f61-83f2-0c9b3758e6b0.png)\n\n\nï¼ˆå›¾ç‰‡æ¥è‡ª[A Bayesian View on Cryo-EM Structure Determination](https://www.sciencedirect.com/science/article/pii/S0022283611012290?via%3Dihub \"A Bayesian View on Cryo-EM Structure Determination\")ï¼‰\n\nç­–ç•¥ä¸ºé€šè¿‡å‚…é‡Œå¶å˜æ¢çš„æ–¹æ³•ç”¨è®¡ç®—æœºé‡æ„å‡ºç²—ç•¥çš„ç»“æ„æ¨¡å‹ç„¶åæŠŠè¿™ä¸ªç²—ç•¥çš„ç»“æ„æ¨¡å‹ä¸æˆåƒä¸Šä¸‡çš„æˆåƒæ•°æ®æ¯”å¯¹ï¼Œå¾—åˆ°æ¯ä¸ªå›¾åƒä¹‹é—´çš„ç›¸å¯¹ä½ç½®ã€‚é€šè¿‡ä½œè€…æ”¹è¿›çš„æœºå™¨å­¦ä¹ ä¸­å¸¸ç”¨çš„è´å¶æ–¯æ–¹æ³•ï¼Œå°†ç²—ç•¥çš„ç»“æ„æ¨¡å‹è°ƒæ•´ä¸ºæ–°çš„ä¸€ä¸ªæ›´ç²¾ç¡®çš„ç»“æ„ï¼Œå¦‚æ­¤è¿­ä»£ä»¥ç²¾ç‚¼æˆ‘ä»¬çš„æ¨¡å‹ï¼Œæ–‡ç« æåˆ°å¯¹äºæ ¸ç³–ä½“çš„ç»“æ„çš„è§£æä»–ä»¬è¿­ä»£äº†25æ¬¡ã€‚è¿™æ•´ä¸ªçš„è¿‡ç¨‹å°±æ˜¯æ‰€è°“çš„å–â€œå¹³å‡â€äº†ï¼Œä¸è¿‡æ˜¯åŸºäºæœºå™¨å­¦ä¹ çš„æ–¹æ³•ï¼Œç»“åˆå…ˆéªŒçš„çŸ¥è¯†æ¥å–å¾—â€œå¹³å‡â€å’Œè¿›è¡Œå…‰æ»‘ï¼Œå–å¾—ç²¾ç»†ç»“æ„ã€‚\n\nè¿™éƒ¨åˆ†ä¸æ˜¯å¾ˆæ‡‚ï¼Œå†™çš„ä¸å¥½ï¼Œæ¬¢è¿æˆåƒå’Œå›¾åƒå¤„ç†æ–¹é¢çš„ä¸“å®¶æŒ‡æ­£ã€‚\n\n### ä¸‰. å›é¡¾åæ€\n\n\nåœ¨ä¸Šè¿°è®ºè¿°ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»çš„æœºå™¨å­¦ä¹ åœ¨ç”Ÿç‰©ç ”ç©¶åº”ç”¨æ¡ˆä¾‹éƒ½åªåœ¨é—®è¿™æ ·ä¸€ç±»å‹é—®é¢˜ï¼šâ€æŸä¸€ç”Ÿç‰©ç°è±¡æ˜¯ä»€ä¹ˆï¼Ÿâ€œï¼Œä¸è¿‡å¯¹äºäººç±»ç¤¾ä¼šå‘å±•è€Œè¨€æ›´æœ‰ç›´æ¥æ„ä¹‰çš„é—®é¢˜æ˜¯ï¼Œâ€è®¤è¯†è¿™ä¸€ç”Ÿç‰©ç°è±¡å¯èƒ½çš„æ¨¡å¼ä¹‹åæˆ‘ä»¬è¯¥æ€ä¹ˆåŠâ€œï¼Œé—®è¿™ç±»é—®é¢˜çš„äººä¸€èˆ¬éƒ½æ˜¯åŒ»ç”Ÿæˆ–è€…è¯ä¼çš„ç§‘å­¦å®¶ã€‚å½“ç„¶ï¼Œç›®å‰ä¹Ÿæœ‰è¿™æ–¹é¢çš„æˆç†Ÿæµç¨‹å¯ä»¥å‚è€ƒ:\n\n![](https://imgkr.cn-bj.ufileos.com/248d4059-519b-49f0-a7e7-e790b2e68403.png)\n\nï¼ˆå›¾ç‰‡æ¥è‡ª[Applications of machine learning in\ndrug discovery and development](https://www.nature.com/articles/s41573-019-0024-5 \"Applications of machine learning in drug discovery and development\")\n\næœ€è¿‘ä¹Ÿæœ‰ç§‘å­¦å®¶ç”¨æ·±åº¦å­¦ä¹ çš„æ–¹æ³•ï¼Œå‘ç°äº†æ–°çš„æŠ—ç”Ÿç´ ï¼š\n\n\n![](https://imgkr.cn-bj.ufileos.com/8cff3e43-91bd-4d9d-801b-f0db91db8e3e.png)\n\næ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥çœ‹è¿™ç¯‡æ–‡çŒ®ã€‚\n\næ­¤å¤–ï¼Œä¸ªäººç†è§£ï¼Œæœºå™¨å­¦ä¹ å°±æ˜¯ä¸€ç§æ™ºèƒ½çš„æ•°æ®æŒ–æ˜æŠ€æœ¯ï¼Œå®ƒä¾æ®å…ˆéªŒçš„çŸ¥è¯†å»ºç«‹é¢„æµ‹æ¨¡å‹æ¥è¯†åˆ«å¤§æ•°æ®ä¸­çš„æœ‰ç”¨ä¿¡æ¯ã€‚æ‰€ä»¥åªè¦æœ‰å¤§æ•°æ®å’Œå‰æœŸç§¯ç´¯çš„å…ˆéªŒçŸ¥è¯†ï¼Œå°±æœ‰æœºå™¨å­¦ä¹ æ–¹æ³•ç”¨æ­¦ä¹‹åœ°ã€‚\n\nè¯´å‡ å¥ä¸é¢˜ç›®æ— å…³çš„è¯ï¼Œä¸ªäººæ„Ÿè§‰å…¶å®è¿™ä¸ªé¢˜ç›®ä¹Ÿå¯ä»¥å›ç­”å­¦ç”Ÿç‰©çš„äººå¤šå­¦ç‚¹åŸºç¡€çš„æ•°å­¦å’Œç‰©ç†çŸ¥è¯†æœ‰ç”¨å—ï¼Ÿæˆ‘è§‰å¾—æ˜¯æœ‰ç”¨çš„ï¼Œæ¯”å¦‚ä½ æƒ³ææ¸…æ¥šå†·å†»ç”µé•œæˆåƒçš„åŸç†ï¼Œä½ å¿…é¡»æ‡‚ç‚¹ç‰©ç†çŸ¥è¯†ï¼ˆå¹²æ¶‰è¡å°„ä¹‹ç±»çš„ï¼‰è¿˜å¾—æ‡‚ç‚¹æ•°å­¦ç‰©ç†æ–¹æ³•ï¼ˆå¦‚å‚…é‡Œå¶å˜æ¢ä¸å®ƒçš„é€†ï¼‰ã€‚å½“ç„¶æƒ³è¦è¿›è¡Œæœºå™¨å­¦ä¹ ï¼Œå½“ç„¶å¾—æœ‰ç»Ÿè®¡å­¦å’Œæ•°æ®çš„å¯è§†åŒ–æ–¹æ³•çš„æ•°å­¦åŸºç¡€å’Œè®¡ç®—æœºç¼–ç¨‹åŸºç¡€ï¼ˆPythonæˆ–è€…Rï¼‰äº†ã€‚å­¦ç§‘ä¹‹é—´å…¶å®æ˜¯å¯ä»¥äº’é€šæœ‰æ— çš„ï¼Œç„¶è€Œè¿™ç‚¹å¸¸å¸¸è¢«ç›®å…‰çŸ­æµ…çš„ä¸€äº›äººå¿½ç•¥äº†ï¼Œå¸Œæœ›å…³æ³¨è¿™ä¸ªé—®é¢˜çš„äººå¯ä»¥èƒ½å¤šä»è¿™ä¸ªè§’åº¦æ¥å­¦ä¹ ï¼Œæ€è€ƒé—®é¢˜ï¼Œè§£å†³é—®é¢˜ã€‚\n\n### é™„ï¼šæ—¥å¿—\n\n+ 2016.3 åˆ›å»ºå›ç­”\n+ 2016.4.14 ç”¨å‘¨å¿—åè€å¸ˆã€Šæœºå™¨å­¦ä¹ ã€‹è¡¥å……å‰è¨€\n+ 2020.4.12 åŸå›ç­”å› ã€Œè¿åçŸ¥ä¹ç¤¾åŒºç®¡ç†è§„å®šã€è¢«åˆ é™¤ã€‚\n+ 2020.4.13-15 æŒ‰ç…§çŸ¥ä¹ç¤¾åŒºç®¡ç†è§„å®šåšå‡ºä¿®è®¢ã€‚é‡æ–°æäº¤ã€‚\n+ 2020.04.16 ä¿®æ”¹æ’ç‰ˆé”™è¯¯\n\n\n\n","tags":["note","machine learning"],"categories":["reference"]},{"title":"è¯»å…³äºå¢å¼ºå­ç ”ç©¶çš„ç°çŠ¶ä¸æœªæ¥çš„ä¸€ç¯‡ç»¼è¿°","url":"/2020/04/08/è¯»å…³äºå¢å¼ºå­ç ”ç©¶çš„ç°çŠ¶ä¸æœªæ¥çš„ä¸€ç¯‡ç»¼è¿°/","content":"\n1. æ–‡ç« ä¿¡æ¯\n\n  é¢˜ç›®ï¼š[Towards a comprehensive catalogue of validated and target- linked human enhancers](https://www.nature.com/articles/s41576-019-0209-0)\n\n2. å†…å®¹\n   \n   å›é¡¾äº†Enhancer biologyçš„ç ”ç©¶å†å²ï¼Œæ¦‚è¿°äº†ç°æœ‰çš„ç ”ç©¶æŠ€æœ¯ï¼Œæå‡ºäº†target-linkedçš„ç ”ç©¶æ¡†æ¶ã€‚\n\næ–‡ç« æœ€æœ‰æ„æ€çš„ä¸€ä¸ªæ€»ç»“å›¾å¦‚ä¸‹:\n\n![](https://imgkr.cn-bj.ufileos.com/ed2ff9bd-7fd7-449b-bfd9-661b67c76f37.png)\n\n\n3. æ€»ç»“ä¸è¯„è¿°ï¼š\n\t\t\t\n  + åƒEnhancer biologyè¿™æ ·çš„åˆ†å­æœºåˆ¶ï¼Œå¸¦æœ‰å¾ˆå¼ºçš„å„æ–¹é¢çš„å¼‚è´¨æ€§ï¼Œä¸å…¶å¯»æ±‚ä¸€ä¸ªcomprehensive çš„ç†è§£ï¼Œä¸å¦‚åšé€å½»åœ¨æŸä¸€ç§éå¸¸é‡è¦çš„ç–¾ç—…ï¼Œä¾‹å¦‚Cancerä¸­çš„è°ƒæ§ä½œç”¨ï¼ŸEnhancer+single cellï¼Œç»†èƒå†…éƒ¨è°ƒæ§ä¸ç»†èƒé—´è°ƒæ§çš„ç ”ç©¶éƒ½å¾ˆé‡è¦ã€‚\n\t\n  + é‡Œé¢å…³äºENCODEçš„å„ç§ç»„å­¦æŠ€æœ¯ï¼Œä»¥åŠ3D genomeçš„æŠ€æœ¯å’ŒCRISPR-screençš„ä¼˜ç¼ºç‚¹ä»‹ç»å¾ˆå¥½ã€‚\n\n\n","tags":["sc-seq","genomics","genetics","ENCODE","HiC","ChIP-seq","ATAC-seq"],"categories":["reference"]},{"title":"å…³äºè‚¿ç˜¤çš„å…ç–«æ²»ç–—é¶ç‚¹","url":"/2020/04/08/å…³äºè‚¿ç˜¤çš„å…ç–«æ²»ç–—é¶ç‚¹/","content":"\nä»Šå¤©è¯»åˆ°ä¸€ä¸ªå¾ˆæ¸…æ¥šçš„ç»¼è¿°çš„ç¿»è¯‘ç¬”è®°ï¼Œè®²è‚¿ç˜¤å…ç–«æ²»ç–—é¶ç‚¹çš„ï¼Œè¯»è€…å¯ä»¥ç§»æ­¥åˆ°\n[ç”Ÿç‰©ä¿¡æ¯å­¦ä¸“ä¸šéœ€è¦ä»€ä¹ˆæ ·çš„ç”Ÿç‰©çŸ¥è¯†ï¼Ÿ](https://mp.weixin.qq.com/s/VzxTUFGK6ZdrHPYHpPGTzA)é˜…è¯»ã€‚\n\n[åŸæ–‡çŒ®](https://www.nature.com/articles/s41585-019-0226-y)é‡Œæœ‰å¼ æ€»ç»“çš„å›¾å¾ˆä¸é”™ï¼š\n![](https://imgkr.cn-bj.ufileos.com/4544cdb9-7c57-4efb-974c-aed98bc9dab2.jpg)å¯ä»¥ä½œä¸ºæœ¬æ–‡çš„æ€»ç»“ã€‚\n\n","tags":["note","biology","immunology"],"categories":["reference"]},{"title":"quote_20200405","url":"/2020/04/05/quote-20200405/","content":"\n> æ—¶é—´å°±åƒä¸€æ¡æ²³æµï¼Œ\n  åœ¨è¿™æˆ‘ä»¬é¡ºæµè€Œä¸‹ï¼Œ\n  é‡åˆ°ç°å®ï¼Œ\n  éœ€è¦å†³ç­–ï¼Œ\n  ä½†æˆ‘ä»¬æ— æ³•åœç•™ï¼Œä¹Ÿæ— æ³•å›é¿ï¼Œ\n  åªèƒ½ä»¥æœ€å¥½çš„æ–¹å¼åº”ä»˜ã€‚â€”â€”ã€ŠåŸåˆ™ã€‹\n","tags":["note"],"categories":["others"]},{"title":"cxt_Chap6_Cytokines","url":"/2020/04/05/cxt-Chap6-Cytokines/","content":"\nå¦‚æ— ç‰¹åˆ«è¯´æ˜ï¼Œå¼•ç”¨éƒ¨åˆ†å‡ºè‡ªã€ŠåŒ»å­¦å…ç–«å­¦ã€‹ï¼ˆç¬¬ä¸ƒç‰ˆï¼Œæ›¹é›ªæ¶›ä¸»ç¼–ï¼Œäººå«ç¤¾å‡ºç‰ˆï¼‰ç¬¬å…­ç« ï¼Œç»†èƒå› å­ã€‚\n\n### 1. ç»†èƒå› å­çš„å®šä¹‰\n> ç»†èƒå› å­æ˜¯ç”±å…ç–«ç»†èƒåŠç»„ç»‡ç»†èƒåˆ†æ³Œçš„åœ¨ç»†èƒé—´å‘æŒ¥ç›¸äº’è°ƒæ§ä½œç”¨çš„çš„ä¸€ç±»å°åˆ†å­å¯æº¶æ€§è›‹ç™½è´¨ï¼Œé€šè¿‡ç»“åˆå“åº”å—ä½“è°ƒèŠ‚ç»†èƒç”Ÿé•¿åˆ†åŒ–å’Œæ•ˆåº”ï¼Œè°ƒæ§å…ç–«åº”ç­”ï¼Œåœ¨ä¸€å®šæ¡ä»¶ä¸‹ä¹Ÿå‚ä¸ç‚ç—‡ç­‰å¤šç§ç–¾ç—…çš„å‘ç”Ÿã€‚\n\n>ä½œç”¨æ–¹å¼ï¼šè‡ªåˆ†æ³Œæ–¹å¼ï¼Œæ—åˆ†æ³Œæ–¹å¼ï¼Œå†…åˆ†æ³Œæ–¹å¼ï¼›\n\n>åŠŸèƒ½ç‰¹ç‚¹ï¼šå¤šæ•ˆæ€§ï¼Œé‡å æ€§ï¼ŒååŒæ€§ï¼Œæ‹®æŠ—æ€§ï¼›\n\n### 2. ç»†èƒå› å­çš„ç§ç±»\n>æ ¹æ®ç»“æ„å’ŒåŠŸèƒ½å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å…­å¤§ç±»ï¼š\n- ç™½ç»†èƒä»‹ç´ (interleukin, IL)ï¼ŒIL1-IL38ã€‚\n- é›†è½åˆºæ¿€å› å­(colony-stimulating factor, CSF)ï¼Œæ˜¯æŒ‡èƒ½å¤Ÿåˆºæ¿€å¤šèƒ½é€ è¡€å¹²ç»†èƒå’Œä¸åŒåˆ†åŒ–é˜¶æ®µçš„é€ è¡€ç¥–ç»†èƒåˆ†åŒ–å’Œå¢æ®–çš„ç»†èƒå› å­ã€‚ä¸»è¦åŒ…æ‹¬ç²’ç»†èƒ-å·¨å™¬ç»†èƒé›†è½åˆºæ¿€å› å­(GM-CSF), å·¨å™¬ç»†èƒé›†è½åˆºæ¿€å› å­ï¼ˆM-CSF)ï¼Œçº¢ç»†èƒç”Ÿæˆç´ (EPO)ï¼Œå¹²ç»†èƒå› å­(SCF)å’Œè¡€å°æ¿ç”Ÿæˆç´ (TPO)ç­‰ã€‚åˆ†åˆ«è¯±å¯¼é€ è¡€å¹²ç»†èƒæˆ–ç¥–ç»†èƒåˆ†åŒ–å¢æ®–ä¸ºç›¸åº”çš„ç»†èƒã€‚\n- å¹²æ‰°ç´ ï¼ˆinterferon, IFN), å› å…·æœ‰å¹²æ‰°ç—…æ¯’å¤åˆ¶çš„åŠŸèƒ½è€Œå¾—åã€‚IFNæ ¹æ®å…¶ç»“æ„ç‰¹å¾åŠç”Ÿç‰©å­¦æ´»æ€§å¯åˆ†ä¸ºIå‹ã€IIå‹å’ŒIIIå‹ã€‚Iå‹IFNä¸»è¦åŒ…æ‹¬IFN-$\\alpha$ã€IFN-$\\beta$, ä¸»è¦ç”±ç—…æ¯’æ„ŸæŸ“çš„ç»†èƒã€pDCç»†èƒç­‰äº§ç”Ÿï¼›IIå‹IFNå³IFN-$\\gamma$ï¼Œä¸»è¦ç”±æ´»åŒ–Tç»†èƒå’ŒNKç»†èƒäº§ç”Ÿã€‚IIIå‹IFNåŒ…æ‹¬IFN-$\\lambda 1$(IL-29)ï¼ŒIFN-$\\lambda 2$(IL-28A)å’ŒIFN-$\\lambda 3$(IL-28B)ï¼Œä¸»è¦ç”±DCç»†èƒäº§ç”Ÿã€‚IFNå…·æœ‰æŠ—ç—…æ¯’ã€æŠ—ç»†èƒå¢æ®–ã€æŠ—è‚¿ç˜¤å’Œå…ç–«è°ƒèŠ‚ç­‰ä½œç”¨ã€‚\n-  è‚¿ç˜¤åæ­»å› å­(tumor necrosis factor, TNF)å®¶æ—ã€‚è‚¿ç˜¤åæ­»å› å­å› æœ€åˆè¢«å‘ç°å…¶èƒ½é€ æˆè‚¿ç˜¤ç»„ç»‡åæ­»è€Œå¾—åï¼ŒåŒ…æ‹¬TNF-$\\alpha$å’ŒTNF-$\\beta$ï¼Œå‰è€…ä¸»è¦ç”±æ´»åŒ–çš„å•æ ¸/å·¨å™¬ç»†èƒäº§ç”Ÿï¼Œåè€…ä¸»è¦ç”±æ´»åŒ–çš„Tç»†èƒäº§ç”Ÿï¼Œåˆç§°æ·‹å·´æ¯’ç´ (lymphotoxin, LT)ã€‚TNFå®¶æ—ç›®å‰å·²ç»å‘ç°TRAIL(TNF related apoptosis-inducing ligand)ã€FasLã€CD40Lç­‰30ä½™ç§ç»†èƒå› å­ã€‚TNFå®¶æ—æˆå‘˜åœ¨è°ƒèŠ‚å…ç–«åº”ç­”ã€æ€ä¼¤é¶ç»†èƒå’Œè¯±å¯¼ç»†èƒå‡‹äº¡ç­‰è¿‡ç¨‹ä¸­å‘æŒ¥é‡è¦ä½œç”¨ã€‚\n-  ç”Ÿé•¿å› å­ï¼ˆgrowth factorï¼ŒGF)æ³›æŒ‡ä¸€ç±»å¯ä¿ƒè¿›ç›¸åº”ç»†èƒç”Ÿé•¿å’Œåˆ†åŒ–çš„ç»†èƒå› å­ã€‚å…¶ç§ç±»è¾ƒå¤šï¼ŒåŒ…æ‹¬è½¬åŒ–ç”Ÿé•¿å› å­-$\\beta$(transforming growth factor-$\\beta$,TGF-$\\beta$)ã€è¡€ç®¡å†…çš®ç»†èƒç”Ÿé•¿å› å­(VEGF)ã€è¡¨çš®ç”Ÿé•¿å› å­(EGF)ã€æˆçº¤ç»´ç»†èƒç”Ÿé•¿å› å­(FGF)ã€ç¥ç»ç”Ÿé•¿å› å­(NGF)ã€è¡€å°æ¿ç”Ÿé•¿å› å­(PDGF)ç­‰ã€‚\n-  è¶‹åŒ–å› å­(chemokine) æ˜¯ä¸€ç±»ç»“æ„ç›¸ä¼¼ï¼Œåˆ†å­é‡çº¦8~12kDï¼Œå…·æœ‰è¶‹åŒ–åŠŸèƒ½çš„ç»†èƒå› å­ã€‚å‡ ä¹æ‰€æœ‰çš„è¶‹åŒ–å› å­éƒ½å«æœ‰ç”±2å¯¹æˆ–ä¸€å¯¹ä¿å®ˆçš„åŠèƒ±æ°¨é…¸æ®‹åŸº(C)å½¢æˆçš„åˆ†å­å†…äºŒç¡«åŒ–é”®ã€‚å¯ä»¥æ ¹æ®é è¿‘æ°¨åŸºç«¯çš„Cçš„ä¸ªæ•°ä»¥åŠæ’åˆ—é¡ºåºå°†è¶‹åŒ–å› å­åˆ†ä¸ºå››ä¸ªå®¶æ—ï¼š1ï¼‰Cäºšå®¶æ—ï¼šæ°¨åŸºé…¸ç«¯åªæœ‰1ä¸ªCï¼Œè¯¥åˆ†å­å†…åªæœ‰ä¸€ä¸ªåˆ†å­å†…äºŒç¡«åŒ–é”®ï¼›2ï¼‰CCäºšå®¶æ—ï¼šæ°¨åŸºç«¯2ä¸ªCç›¸é‚»ï¼›3ï¼‰CXCäºšå®¶æ—ï¼šæ°¨åŸºé…¸2ä¸ªCè¢«1ä¸ªæ°¨åŸºé…¸æ®‹åŸºéš”å¼€ï¼›4ï¼‰CX3Cäºšå®¶æ—ï¼šæ°¨åŸºç«¯2ä¸ªCè¢«3ä¸ªæ°¨åŸºé…¸æ®‹åŸºéš”å¼€ï¼Œç¾§åŸºç«¯è·¨ç»†èƒè†œã€‚\nå·²ç»å‘ç°çš„è¶‹åŒ–å› å­æœ‰ï¼ŒCXCL1 ~ 16ï¼ŒCCL1 ~ 28ï¼ŒXCL1 ~ 2ï¼ŒCX3CL1.\n\n### 3. ç»†èƒå› å­å—ä½“\n\n> ç»†èƒå› å­å—ä½“å¯ä»¥æ ¹æ®å…¶ç»“æ„ç‰¹ç‚¹è¢«åˆ†ä¸ºå¦‚ä¸‹å…­ä¸ªå®¶æ—ï¼š\n- Iå‹ç»†èƒå› å­å—ä½“å®¶æ—ï¼Œä¹Ÿç§°ä¸ºè¡€ç»†èƒç”Ÿè¾°ç´ å—ä½“å®¶æ—(hematopoietin receptor family)ï¼Œ é€šè¿‡ JAK-STATé€šè·¯è½¬å¯¼ä¿¡å·ï¼›\n- IIå‹ç»†èƒå› å­å—ä½“å®¶æ—ï¼Œä¹Ÿç§°ä¸ºå¹²æ‰°ç´ å—ä½“å®¶æ—(interferon receptor family)ï¼Œä¹Ÿæ˜¯é€šè¿‡JAK-STATé€šè·¯è½¬å¯¼ä¿¡å·ï¼›\n- è‚¿ç˜¤åæ­»å› å­å—ä½“å®¶æ—(tumor necrosis factor family)ï¼Œä¸»è¦é€šè¿‡TRAF-NF-kBï¼ŒTRAF-AP-1 é€šè·¯è½¬å¯¼ä¿¡å·ï¼›\n- å…ç–«çƒè›‹ç™½è¶…å®¶æ—å—ä½“(Ig superfamily receptor, IgSFR)ï¼Œä¼šç»“åˆé›†è½åˆºæ¿€å› å­ï¼›\n- IL-17å—ä½“å®¶æ—(IL-17 receptor family)ï¼Œä¸»è¦é€šè¿‡TRAF-NF-kBé€šè·¯è½¬å¯¼ä¿¡å·ï¼›\n- è¶‹åŒ–å› å­å—ä½“å®¶æ—(chemokine receptor family) ï¼Œå±äºGPCRä¸­çš„ä¸€å‘˜ã€‚\n\n### 4.remark\n\nå¯å¦ä»åŸºå› è¡¨è¾¾è°ƒæ§å‡ºå‘ï¼Œæ¥æè¿°ç»†èƒå› å­çš„åŠŸèƒ½ï¼Ÿ\n\n2025.01.12 comment\nè¿™äº›éƒ½æ˜¯çŸ¥è¯†æ€§çš„ï¼Œæˆ–è€…å­—å…¸é‡Œçš„å†…å®¹ï¼Œæˆ‘è§‰å¾—éœ€è¦ç»“åˆç»„å­¦ç ”ç©¶å®è·µï¼Œæ‰èƒ½å˜å¾—æœ‰æ„ä¹‰ã€‚","tags":["note","biology","immunology"],"categories":["genomics"]},{"title":"HCL papar","url":"/2020/04/05/HCL-papar/","content":"\n- é¢˜ç›®ï¼šConstruction of human cell landscape at single-cell level\n\n- ç§‘å­¦é—®é¢˜ï¼šå¦‚ä½•æ„å»ºäººç±»ç»†èƒå›¾è°±\n\n- å®éªŒï¼šç”¨å…¶è‡ªå·±å¼€å‘çš„Microwell-seqï¼Œè¯¥ç ”ç©¶å……åˆ†åˆ©ç”¨Microwell-seqæˆæœ¬ä½å»‰ï¼ŒåŒç»†èƒæ±¡æŸ“ç‡ä½å’Œç»†èƒæ™®é€‚æ€§å¹¿ç­‰ä¼˜åŠ¿ï¼Œå»ºç«‹äº†70å¤šä¸‡ä¸ªå•ç»†èƒçš„è½¬å½•ç»„æ•°æ®åº“ï¼Œé‰´å®šäº†äººä½“100ä½™ç§ç»†èƒå¤§ç±»å’Œ800ä½™ç§ç»†èƒäºšç±»ã€‚åŸºäºè¯¥æ•°æ®åº“ï¼Œå›¢é˜Ÿå¼€å‘äº†scHCLå•ç»†èƒæ¯”å¯¹ç³»ç»Ÿç”¨äºäººä½“ç»†èƒç±»å‹çš„è¯†åˆ«ï¼Œå¹¶æ­å»ºäº†äººç±»ç»†èƒè“å›¾ç½‘ç«™http://bis.zju.edu.cn/HCL/ï¼ˆå›½å®¶åŸºå› åº“é•œåƒhttps://db.cngb.org/HCL/ï¼‰ã€‚\n\n- åˆ†æï¼šâ€œtSNE+å›¾èšç±»â€ï¼ˆfig1b,fig1c,fig1d); EC,Epi, Stromal cellåˆ†æ³ŒLigandçš„èƒ½åŠ›ï¼ˆFig2c)ä¸»è¦æ˜¯Adultçš„ç»†èƒï¼ˆå¾®ç¯å¢ƒï¼Ÿï¼‰ï¼›è·¯å¾„åˆ†æï¼ˆFig3)ï¼›è°ƒæ§åˆ†æï¼ˆFig4)\n\n- è®¨è®ºï¼šå›¾è°±å¼å·¥ä½œï¼›è¯æ˜äº†æ¦‚å¿µçš„å¯è¡Œæ€§ï¼›ä½†æ˜¯ä¸å¦‚HCAé‚£ä¹ˆæ¿€åŠ¨äººå¿ƒï¼Ÿ\n","tags":["note","scRNA-seq","biology"],"categories":["reference"]},{"title":"Dobrow-chap2","url":"/2020/04/05/Dobrow-chap2/","content":"å¯¹äº `Introduction to stochastic processes with R`ä¸€ä¹¦çš„ç¬”è®°\n\n> Let us finish the article and the whole book with a good example of dependent trials, which approximately can be considered as a simple chain.\n>                                            â€“Andrei Andreyevich Markov\n\nChap2: Markov Chains: First steps\n\næœ¬ç« è®²é©¬å°”å¯å¤«é“¾\n\n### Introduction \n\n1. å¼•å…¥çš„æ¡ˆä¾‹ï¼š\n   è¿™ä¸€èŠ‚ï¼Œç”¨ä¸€ä¸ªç±»ä¼¼å¤§å¯Œç¿çš„æ¸¸æˆæ¥å¼•å…¥é©¬å°”å¯å¤«å¤«æ€§ã€‚\n2. é©¬å°”å¯å¤«é“¾çš„å½¢å¼åŒ–å®šä¹‰ä¸º\n    > Markov Chain\n    > Let $\\mathcal{S}$ be a discrete set. A Markov chain is a sequence of random variables $X_0,X_1,\\dots$ taking values in $\\mathcal{S}$ with the property that\n    > $$ P(X_{n+1}=j|X_0=x_0,\\dots,X_{n-1}=x_{n-1},X_n=i) \\\\ = P(X_{n+1}=j|X_n=i) \\tag{2.1} $$ \n    > for all $x_0,\\dots,x_{n-1},i,j\\in\\mathcal{S},n\\ge0$ The set $\\mathcal{S}$ is the state space of the Markov chain. ã€\n\n3. $X_n=i$ ç§°ä¸ºåœ¨æ—¶åˆ»nåˆ°è¾¾çŠ¶æ€iã€‚\n   \n4. æ—¶é—´é½æ€§é©¬å°”å¯å¤«é“¾ï¼š\n   $$ P(X_{n+1}=j|X_{n}=i)=P(X_1=j|X_0=i) \\tag{2.2}$$\n\n5. transition matrix:\n   \t1. næ­¥è½¬ç§»çŸ©é˜µè®¡ç®—ï¼ˆçŸ©é˜µä¹˜æ³•ï¼‰\n   \t2. è‹¥å¹²ä¾‹å­ï¼š\n   \t\t1) æ”¶æ•›äºä¸€ä¸ªå„è¡Œç›¸ç­‰çš„çŸ©é˜µï¼›\n   \t\t2) ä¸æ”¶æ•›ï¼Œè¿›å…¥è·³è·ƒçš„çŠ¶æ€ï¼›\n   \t\t3) æ”¶æ•›äºä¸€ä¸ªå„è¡Œä¸ç›¸ç­‰çš„çŸ©é˜µ\n\nç¬¬äº”éƒ¨åˆ†ä»ç›´è§‚ä¸Šä¸ºä¸‹ä¸€ç« é“ºè·¯ã€‚","tags":["note","stochastic Process"],"categories":["math"]},{"title":"Dobrow_chap1","url":"/2020/04/04/Dobrow-chap1/","content":"This is a note of the textbook `Introduction to stochastic processes with R`\n\n> We demand rigidly defined areas of doubt and uncertainty!\n>      â€“Douglas Adams, The Hitchhikerâ€™s Guide to the Galaxy\n\n### Introduction and preview\n\n> We demand rigidly defined areas of doubt and uncertatinty  â€“Douglas Adams, The Hitchhikerâ€™s Guide to the Galaxy\n\n#### 1.1 DETERMINISTIC AND STOCHASTIC MODELS\n\n+ Consider a simple exponential growthmodel\nwhere the random arisesï¼Ÿ\nThe deterministic model does not address the uncertainty present in the reproduction\nrate of individual organisms.\n\n+ In many biological processes, the exponential distribution is a common choice for modeling the times of births and deaths.\n\n+ Ex1.1 PageRank: random walks on graphs\n\n+ Ex1.2 Spread of infectious disease\nSIR model: Susceptible-infected-removed\nReed-Frost model: Stochastic SIR model in discrete time.\n\n#### 1.2 What is a stochastic process\n\n+ The author said\n    > A stochastic process, also called a random process, is simply one in which outcomes are uncertain. By contrast, in a deterministic system there is no randomness. In a deterministic system, the same output is always produced from a given input.\n\n+ A stochastic process is specified by its index and state sapce, and by the dependency relationships among its random variables\n    > Stochastic process: A stochastic process is a collection of random variables $\\{X_t,t \\in I\\}$.The set I is the index set of the process. The random variables are defined on a commmon state space S.\n\n+ Ex 1.3 Monopoly\n+ EX 1.4 Discrete time, continous state space\n+ Ex 1.5 Continuous time, discrete state space\n: arrival process, Poisson process\n+ Ex 1.6 Random walk and gambler's ruin: Random walk, discrete-time stochastic process whose state space is $\\mathbb{Z}$\n+ Ex 1.7 Brownian motion: Brownian motion is a continuous-time, contiuous state space stochastic process\n\n#### 1.3 Monte Carlo Simulation\n\n+ Given a random experiment and event A, a Monte Carlo estimate of $P(A)$ is obtained by repeating random experiment many times and taking the proportion of trials in which A occurs as an approximation for $P(A)$\n\n+ Strong law of large numbers\n     \n     $$ \\lim_{n\\rightarrow\\infty}\\frac{X_1+\\dots+X_n}{n}=P(A), a.s. \\tag{1.1}$$\n\n#### 1.4 Conditional Probability\n\n> The simplest stochastic process is a sequence of i.i.d. random variables. Such\nsequences are often used to model random samples in statistics. However, most\nreal-world systems exhibit some type of dependency between variables, and an\nindependent sequence is often an unrealistic model.\n\n> Thus, the study of stochastic processes really begins with conditional\nprobabilityâ€”conditional distributions and conditional expectation. These will\nbecome essential tools for all that follows.\n\n+ Conditional Probability: \n  \n  $P(A|B) = \\frac{P(A\\bigcap B)}{P(B)}$\n\n+ Law of Total probability:\n  \n  Let $B_1,\\dots,B_k$ be a sequence of events that partition the sample space. That is, the $B_i$ are mutually exclusive(disjoint) and their union is equal to $\\Omega$. Then, for many event A,\n  $$ P(A)=\\sum_{i=1}^{k}P(A\\bigcap B_i)=\\sum_{i=1}^{k}P(A|B_i)P(B_i) $$\n\n+ Ex1.8 Disease tests\n\n+ Ex1.9 Find the probability that it is a heart\n\n+ Ex1.10 Gambler's ruin\n  let $p_k$ denote the probability of reaching n when the gambler's fortune is k.\n  $$ p_k = p_{k+1}(\\frac{1}{2})+p_{k-1}(\\frac{1}{2}) $$\n  or \n  $$ p_{k+1}-p_k = p_k - p_{k-1},  k = 1,\\dots, n-1 \\tag{1.2}$$\n  \n  using $p_0 =0, p_n = 1$\n\n  we have $p_k=kp_1=\\frac{k}{n},k=0,\\dots,n$\n  \n  The gambler's ruin is \\frac{n-k}{n} \n\n+ Bayes Rule\n\n  Given a countable sequence of events $B_1,B_2,\\dots$ which partition the sample space, a more general form of Bayes' rule is\n\n  $$P(B_i|A)=\\frac{P(A|B_i)P(B_i)}{\\sum_jP(A|B_j)P(B_j)}$$ \n\n+ Ex 1.11 The probability that teh employee is in fact lying.\n\n+ Conditional Distribution\n  \n  joint density function:\n\n  $P(X \\le x, Y \\le y) = \\int_{-\\infty}^{x}\\int_{-\\infty}^{y}f(x,t)dtds$\n  \n  + Discrete Case:\n    \n    P(Y=y|X=x)=\\frac{X=x,Y=y}{P(X=x)}\n    \n  + Continuous Case:\n  \n    For continuous randomo variables X and Y, the conditional density function of Y given X=x is \n\n    $f_{Y|X}(y|x)=\\frac{f(x,y)}{f_X(x)}$\n\n    $P(Y \\in R | X = x)=\\int_Rf_{Y|X}(y|x)dy$\n\n#### 1.5 Conditional Expectation of Y given X=x\n\n+ Conditional Expectation of Y given X=x\n\n    $$E(Y|X=x)= \\begin{cases}\\sum_{y}yP(Y=y|X=x),&\\text{discrete} \\\\\n    \\int_{-\\infty}^{\\infty}yf_{Y|X}(y|x)dy, & \\text{continuous}   \n    \\end{cases} $$","tags":["note","stochastic Process"],"categories":["math"]},{"title":"å‡ ä¸ªé‡è¦å‡è®¾æ£€éªŒçš„æ¨å¯¼","url":"/2018/08/01/å‡ ä¸ªé‡è¦å‡è®¾æ£€éªŒçš„æ¨å¯¼/","content":"\n## å‰è¨€\n\nå‡è®¾æ£€éªŒæ˜¯æˆ‘ä»¬åœ¨æ—¥å¸¸ç ”ç©¶ä¸­ï¼Œç»å¸¸ç¢°åˆ°çš„ç»Ÿè®¡é—®é¢˜ã€‚å¯¹äºè¿½æ±‚å®ç”¨ä¸æ•ˆç‡çš„ç§‘ç ”äººå‘˜æ¥è¯´ï¼Œå„ç§ä¸åŒçš„å‡è®¾æ£€éªŒæ˜¯å¯ä»¥ç”¨è½¯ä»¶ï¼Œç‚¹ç‚¹é¼ æ ‡ï¼Œæˆ–è€…å†™å†™ä»£ç ï¼Œå°±å¯ä»¥å®Œæˆçš„ã€‚\n\nä¸è¿‡ï¼Œå¯¹äºæˆ‘ä»¬è¿™äº›æƒ³è¦åœ¨ç”Ÿç‰©ä¿¡æ¯é¢†åŸŸæ·±å…¥å’Œè¿›é˜¶ï¼Œå¹¶ä¸”æœ€ç»ˆæœ‰æ‰€å»ºæ ‘çš„å­¦ç”Ÿæ¥è¯´ï¼Œæˆ‘ä»¬å…‰ä¼šæ‹§èºä¸å’Œç”¨æ¿å­ï¼Œç”¨è½®å­æ˜¯ä¸å¤Ÿçš„ï¼Œå½“æœ‰æ–°çš„æŠ€æœ¯ï¼Œæ–°çš„éœ€æ±‚å‡ºæ¥ä¹‹åï¼Œæˆ‘ä»¬å¾—è¦é€ æ–°è½®å­ï¼Œå¼€å‘æ–°æ–¹æ³•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—å­¦å­¦ç«ç®­æ˜¯å’‹é£èµ·æ¥å’Œæ¿å­ä»¥åŠè½®å­æ˜¯å’‹é€ å‡ºæ¥çš„çŸ¥è¯†ã€‚\n\næˆ‘ä»¬ä»¥å­¦ä¹ å’Œä»‹ç»ç ”ç©¶ä¸­æ¯”è¾ƒåŸºç¡€çš„$\\chi^2,t,F$ä¸‰ç§æ£€éªŒçš„æ‰€å¯¹åº”çš„åˆ†å¸ƒæ¨å¯¼ï¼Œå¼€å§‹æˆ‘ä»¬çš„è¿›é˜¶ä¹‹æ—…ã€‚\n\nè¯´æ˜ï¼šæœ¬æ–‡çš„æ¨å¯¼æ¥è‡ªã€Šæ¦‚ç‡ç»Ÿè®¡è®²ä¹‰ã€‹ç¬¬ä¸‰ç‰ˆé™„å½•äºŒï¼Œé™ˆå®¶é¼ç­‰ç¼–è‘—ï¼Œé«˜ç­‰æ•™è‚²å‡ºç‰ˆç¤¾å‡ºç‰ˆã€‚ç•¥å¾®æœ‰æ‰€ä¿®æ”¹ï¼Œé˜…è¯»æœ¬æ–‡ï¼Œåªéœ€ä¿®è¿‡æœ¬ç§‘é˜¶æ®µéæ•°å­¦ä¸“ä¸šçš„ä¸‰é—¨åŸºç¡€æ•°å­¦è¯¾ï¼šé«˜ç­‰æ•°å­¦(ä¸æ˜¯å¾ˆæ·±ï¼Œä¹Ÿä¸æ˜¯å¾ˆæµ…çš„æ•°å­¦åˆ†æ)ï¼Œçº¿æ€§ä»£æ•°ï¼Œæ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ã€‚\n## æ­£äº¤çŸ©é˜µä¸æ­£æ€åˆ†å¸ƒ\n\nåœ¨çº¿æ€§ä»£æ•°è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œè‹¥$n$é˜¶æ–¹é˜µ$A=(a_{ij})_{n\\times n}$æ»¡è¶³$A^TA=I$ï¼Œå†™æˆæ ‡é‡çš„å½¢å¼å°±æ˜¯ï¼š\n\n$$\n\\sum_{k=1}^{n} a_{ki}a_{kj} = \\begin{cases}  \n1 & i=j\\\\\n0 & i\\ne j\n\\end{cases} \\quad (1)\n$$      \n\næ­¤æ—¶ï¼Œæˆ‘ä»¬ç§°æ–¹é˜µ$A$ä¸ºæ­£äº¤çŸ©é˜µã€‚è€Œä¸”ï¼Œé€šè¿‡çº¿æ€§ä»£æ•°çš„è¯¾ç¨‹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ­£äº¤çŸ©é˜µæ»¡è¶³å¦‚ä¸‹æ€§è´¨ï¼š\n + 1-1 è®¾Aæ˜¯æ­£äº¤çŸ©é˜µï¼Œåˆ™$AA^T=I$ï¼Œå¹¶ä¸”ç»“åˆï¼ˆ1ï¼‰å¯å¾—ï¼š\n\n   $$\n   \\sum_{k=1}^{n} a_{kj} a_{lj} = \\begin{cases} 1 & k=l\\\\\n   0 & k\\ne l\n   \\end{cases} \\quad (2)\n   $$\n \n + 1-2 è®¾Aæ˜¯æ­£äº¤çŸ©é˜µï¼Œåˆ™$A^T$ä¹Ÿæ˜¯æ­£äº¤çŸ©é˜µï¼Œå¹¶ä¸”$|A|=1$æˆ–$|A|=-1$ï¼Œå…¶ä¸­$|\\cdot|$è¡¨ç¤ºè¡Œåˆ—å¼ã€‚\n\n + 1-3 è‹¥$A=(a_{ij})_{n\\times n}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œè€Œ$x_1,x_2,\\dots,x_n$æ˜¯ä»»æ„nä¸ªå®æ•°ï¼Œå¯¹äº\n\n   $$ y_i = \\sum_{i=1}^{n} a_{ik}x_k  \\quad i=1,2,\\dots,n $$ \n   æˆ‘ä»¬æœ‰\n   $$ \\sum_{i=1}^{n}y^2_i = \\sum_{i=1}^{n} x_i^2 \\quad (3)$$ \n\nå¾ˆæŠ±æ­‰ï¼Œå¼€å¤´ç½—åˆ—äº†è¿™ä¹ˆå¤šçº¿æ€§ä»£æ•°çš„äº‹å®ï¼Œä¸è¿‡ï¼Œä¹Ÿæ²¡åŠæ³•ï¼Œè¦åšèœï¼Œæˆ‘ä»¬å¾—å…ˆå¤‡æ–™ä¸æ˜¯å—ã€‚ä¸‹é¢æˆ‘ä»¬å¼€å§‹åšèœäº†ã€‚\n\n**å®šç†1** è®¾$X_1,X_2,\\dots,X_n$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”éƒ½æœä»$N(0,\\sigma^2)$ï¼Œåˆ$A=(a_{ij})$æ˜¯æ­£äº¤çŸ©é˜µï¼Œæ„é€ éšæœºå˜é‡\n$$ Y_i = \\sum_{i=1}^{n}a_{ij}X_j \\quad (1\\le i\\le n) $$\n**è¯æ˜** å› $X_i$çš„åˆ†å¸ƒå¯†åº¦æ˜¯$\\frac{1}{\\sqrt{2\\pi}\\sigma}e^{-\\frac{1}{2\\sigma^2}x^2}$,ä¸”$X_i$æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬ï¼ˆi.i.d.ï¼‰ï¼Œæ•…$X_1,X_2,\\dots,X_n$è”åˆå¯†åº¦ä¸ºï¼š$(\\frac{1}{\\sqrt{2\\pi}\\sigma})^ne^{-\\frac{1}{2\\sigma^2}\\sum_{i=1}^{n}x^2}$\n\næ„é€ nç»´ç©ºé—´ä¸­çš„åŒºåŸŸD:\n$$ D=\\{(x_1,x_2,\\dots,x_n)|a_i < \\sum_{j=1}^{n}a_{ij}x_j < b,i=1,2\\dots,n\\} $$\nåˆ™æœ‰ï¼š\n\n$$\n\\begin{aligned}\n  & P\\{a_1 < Y_1 < b_1,a_2 < Y_2 < b_2, \\dots, a_n < Y_n < b_n \\} \\\\\n  & =P\\{ (X_1,X_2,\\dots,X_n)\\in D \\}\\\\\n  & = \\int_{D}(\\frac{1}{\\sqrt{2\\pi}\\sigma})^ne^{-\\frac{1}{2\\sigma^2}\\sum_{i=1}^{n}x^2}dx_1dx_2\\dots dx_n\n\\end{aligned}\n$$\n\næ³¨æ„åˆ°\n$$ y_i = \\sum_{k=1}^{n}a_{ik}x_k \\quad (i=1,2,\\dots,n)$$\näºæ˜¯ï¼ˆåˆ©ç”¨æ­£äº¤çŸ©é˜µçš„æ€§è´¨ï¼‰\n$$ x_i = \\sum_{k=1}^{n}a_{ki}y_k \\quad (i=1,2,\\dots,n)$$\nå®¹æ˜“éªŒè¯ï¼Œå˜æ¢çš„é›…å¯æ¯”å¼ä¸º\n$$ J(\\frac{x_1,x_2,\\dots,x_n}{y_1,y_2,\\dots,y_n})= |A^T|=1,-1 $$\n\nåˆ$\\sum_{k=1}^{n}x^2_{k}=\\sum_{k=1}^n y_{k}^2$æ•…\n\n$$\n\\begin{aligned}\n  &\\int_D(\\frac{1}{\\sqrt{2\\pi}\\sigma})^ne^{-\\frac{1}{2\\sigma^2}\\sum_{i=1}^{n}x^2}dx_1dx_2\\dots dx_n \\\\\n  &= \\int_{a_1}^{b_1}\\int_{a_2}^{b_2}\\dots\\int_{a_n}^{b_n}(\\frac{1}{\\sqrt{2\\pi}\\sigma})^ne^{-\\frac{1}{2\\sigma^2}\\sum_{i=1}^{n}y^2} \\cdot |J(\\frac{x_1,x_2,\\dots,x_n}{y_1,y_2,\\dots,y_n})| dy_1dy_2\\dots dy_n  \\\\\n  &=\\int_{a_1}^{b_1}\\frac{1}{\\sqrt{2\\pi}\\sigma}e^{-\\frac{-y_1^2}{2\\sigma^2}}dy_1\\cdot\\int_{a_2}^{b_2}\\frac{1}{\\sqrt{2\\pi}\\sigma}e^{-\\frac{-y_2^2}{2\\sigma^2}}dy_2 \\cdots \\int_{a_n}^{b_n}\\frac{1}{\\sqrt{2\\pi}\\sigma}e^{-\\frac{-y_n^2}{2\\sigma^2}}dy_n \\\\\n  &=  P\\{a_1 < Y_1 < b_1\\} \\cdot P\\{a_2 < Y_2 < b_2\\} \\cdots P\\{a_n < Y_n < b_n\\}\n\\end{aligned}\n$$\næ•…$Y_1,Y_2,\\dots,Y_n$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”ä¸éš¾çœ‹å‡ºï¼Œéƒ½æœä»$N(0,\\sigma^2)$ã€‚å®šç†1è¯æ¯•ã€‚\n\n**å®šç†2**è®¾$X_1,X_2,\\dots,X_n$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”$X \\sim N(\\mu,\\sigma^2)$ã€‚$A=(a_{ij})$æ˜¯né˜¶æ­£äº¤çŸ©é˜µ,æ„é€ éšæœºå˜é‡ï¼Œ\n$$ Y_{i}=\\sum_{k=1}^{n}a_{ik}X_k \\quad (i=1,2,\\dots,n) $$\nåˆ™$Y_1,Y_2,\\dots,Y_n$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”\n$$ Y_{i} \\sim N(\\sum_{k=1}^{n}a_{ik}\\mu_k,\\sigma^2) $$\n**è¯æ˜**ä»¤$Z_i = X_i - \\mu$ï¼Œåˆ™$Z_1,Z_2,\\dots,Z_n$ç›¸äº’ç‹¬ç«‹ï¼Œéƒ½æœä»$N(0,\\sigma^2)$,æ ¹æ®å®šç†1çŸ¥ï¼Œ$\\sum_{k=1}^{n}a_{1k}Z_k,\\sum_{k=1}^{n}a_{2k}Z_k,\\dots,\\sum_{k=1}^{n}a_{nk}Z_k$ç›¸äº’ç‹¬ç«‹ã€‚\nä¸”\n$$ \\sum_{k=1}^{n}a_{ik}Z_k \\sim N(0,\\sigma^2)$$\nä½†æ˜¯\n$$ Y_i = \\sum_{k=1}^{n}a_{ik}Z_k + \\sum_{k=1}^{n}a_{ik}\\mu_k $$\næ•…$Y_1,Y_2,\\dots,Y_n$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”$Y_i \\sim N(\\sum_{k=1}^{n}a_{ik}\\mu_k,\\sigma^2) \\quad  (i=1,2,\\dots,n)$\n\n## å…³äº$\\chi^2$åˆ†å¸ƒ\n\nå‰é¢çš„çš„éƒ½æ˜¯å°èœï¼Œæ¥ä¸‹æ¥ä¸Šä¸»èœã€‚æˆ‘ä»¬è¦å¼€å§‹è¯æ˜ä¸€ç³»åˆ—å¾ˆfancyçš„å®šç†\n\n**å®šç†3** è®¾$X_1,X_2,\\dots,X_n$ç›¸äº’ç‹¬ç«‹ï¼Œå¹¶ä¸”éƒ½æœä»$N(0,1)$,åˆ™$\\xi=\\sum_{i=1}^n X^{2}_{i}$æœä»$n$ä¸ªè‡ªç”±åº¦çš„$\\chi^2$åˆ†å¸ƒï¼Œå…¶PDF(probability density function)ä¸º\n$$ p(u) = k_n(u)= \\begin{cases}  \n\\frac{1}{2^{\\frac{n}{2}}\\Gamma(\\frac{n}{2})}u^{\\frac{n}{2}-1}e^{-\\frac{u}{2}} & u>0\\\\\n0 & u\\le 0 \n\\end{cases} \\quad (4)$$\n**è¯æ˜** æˆ‘ä»¬è¯æ˜çš„ç­–ç•¥æ˜¯ï¼Œå…ˆæ±‚å‡ºCDF(cumulative distribution function)$F(u)=P\\{\\xi \\le u\\}$ï¼Œç„¶ååˆ©ç”¨ä¸­å€¼å®šç†ï¼Œè¯æ˜$F^\\prime(u)=k_n(u)$ã€‚\n\næ˜¾ç„¶ï¼Œå½“$u\\le 0,F(u)=0,F^\\prime(u)=k_n(u)$\n\nå½“$u>0$æ—¶ï¼Œç”±äº$X_1,X_2,\\dots,X_n$ç›¸äº’ç‹¬ç«‹ï¼Œæ•…$X_1,X_2,\\dots,X_n$è”åˆå¯†åº¦ä¸º$(\\frac{1}{\\sqrt{2\\pi}})^ne^{-\\frac{1}{2}\\sum_{i=1}^{n}x^2}$ï¼Œ\næ•…\n$$ \n\\begin{aligned}\n F(u) &= P\\{ \\sum_{i=1}^{n}X_{i}^2 \\le u \\} \\\\\n      &=  \\int_{\\sum_{i=1}^{n}x_{i}^2 \\le u}(\\frac{1}{\\sqrt{2\\pi}})^ne^{-\\frac{1}{2}\\sum_{i=1}^{n}x^2}dx_1dx_2\\dots dx_n\n\\end{aligned}  \n$$\næ•…å¯¹äº$h>0$,æœ‰\n$$ \n\\begin{aligned}\n F(u+h) - F(u)  =& \\int_{u < \\sum_{i=1}^{n}x_{i}^2 \\le u+h}(\\frac{1}{\\sqrt{2\\pi}})^ne^{-\\frac{1}{2}\\sum_{i=1}^{n}x^2}dx_1dx_2\\dots dx_n \\\\\n \\le& \\int_{u < \\sum_{i=1}^{n}x_{i}^2 \\le u+h}(\\frac{1}{\\sqrt{2\\pi}})^ne^{-\\frac{u}{2}} dx_1dx_2\\dots dx_n \\\\\n =& (\\frac{1}{\\sqrt{2\\pi}})^n e^{-\\frac{u}{2}} \\int_{u < \\sum_{i=1}^{n}x_{i}^2 \\le u+h} dx_1dx_2\\dots dx_n \n\\end{aligned}  \n$$\n$$ \n\\begin{aligned}\n F(u+h) - F(u)\n\\ge& \\int_{u < \\sum_{i=1}^{n}x_{i}^2 \\le u+h}(\\frac{1}{\\sqrt{2\\pi}})^ne^{-\\frac{u+h}{2}} dx_1dx_2\\dots dx_n \\\\\n=& (\\frac{1}{\\sqrt{2\\pi}})^n e^{-\\frac{u+h}{2}} \\int_{u < \\sum_{i=1}^{n}x_{i}^2 \\le u+h} dx_1dx_2\\dots dx_n\n\\end{aligned}  \n$$\nä»¤$S(x) = \\int_{\\sum_{i=1}^{n}x_{i}^2 \\le x} dx_1dx_2\\dots dx_n \\quad (x>0)$\nåˆ™\n$$ \n(\\frac{1}{\\sqrt{2\\pi}})^n e^{-\\frac{u+h}{2}}\\cdot\\frac{S(u+h)-S(u)}{h} \\\\\n\\le \\frac{F(u+h)-F(u)}{h} \\le \\\\\n(\\frac{1}{\\sqrt{2\\pi}})^n e^{-\\frac{u}{2}}\\cdot\\frac{S(u+h)-S(u)}{h}\n $$\né—®é¢˜ç°åœ¨å˜ä¸ºå¦‚ä½•æ±‚$S(x)$\n\nåšä»£æ¢$x_i= y_i \\sqrt{x}$,åˆ™\n$$ dx_i = \\sqrt{x} dy_i $$\nç”±æ­¤ \n$$ S(x) = \\int_{\\sum_{i=1}^{n}y_{i}^2 \\le 1} (\\sqrt{x})^n dy_1dy_2\\dots dy_n = x^{\\frac{n}{2}}\\cdot C_n $$\næœ‰è¶£çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡º\n$$ C_n = \\int_{\\sum_{i=1}^{n}y_{i}^2 \\le 1}  dy_1dy_2\\dots dy_n $$ \næ˜¯$n$ç»´å•ä½çƒä½“çš„ä½“ç§¯ã€‚ä¸è¿‡åœ¨æˆ‘ä»¬çš„é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºå®ƒåªå’Œ$n$æœ‰å…³çš„é‡ã€‚æ•…$S(x)=\\frac{n}{2}C_nx^{\\frac{n}{2}-1}$\n\næ ¹æ®ä¹‹å‰çš„ä¸ç­‰å¼ï¼Œç»“åˆä¸­å€¼å®šç†ï¼š\n$$ \\lim_{h\\rightarrow0^{+}} \\frac{F(u+h)-F(u)}{h} = (\\frac{1}{\\sqrt{2\\pi}})^nC_n\\frac{n}{2}u^{\\frac{n}{2}-1}e^{-\\frac{n}{2}} $$\n$$ \\lim_{h\\rightarrow0^{-}} \\frac{F(u+h)-F(u)}{h} = (\\frac{1}{\\sqrt{2\\pi}})^nC_n\\frac{n}{2}u^{\\frac{n}{2}-1}e^{-\\frac{n}{2}} $$\næ‰€ä»¥\n$$ F^{\\prime}(u) = B_n u^{\\frac{n}{2}-1}e^{-\\frac{u}{2}} $$\nç»¼ä¸Š\n$$ p(u) = k_n(u)= \\begin{cases}  \nB_nu^{\\frac{n}{2}-1}e^{-\\frac{u}{2}} & u>0\\\\\n0 & u\\le 0 \n\\end{cases} \\quad $$\nç”±å½’ä¸€åŒ–æ¡ä»¶$\\int_{-\\infty}^{+\\infty}p(u)du=1$çŸ¥$\\int_{0}^{+\\infty}B_nu^{\\frac{n}{2}-1}e^{-\\frac{u}{2}}du=1$\nè€Œåœ¨æ•°å­¦åˆ†æçš„çŸ¥è¯†å‘Šè¯‰æˆ‘ä»¬\n$\\int_{0}^{+\\infty}u^{\\frac{n}{2}-1}e^{-\\frac{u}{2}}du=2^{\\frac{n}{2}}\\Gamma(\\frac{n}{2})$\n\n$$ B_n = \\frac{1}{2^{\\frac{n}{2}}\\Gamma(\\frac{n}{2})} $$\nå®šç†å¾—è¯ã€‚\n\nè¿™ä¸ªå®šç†çš„ä¸€ä¸ªå‰¯äº§ç‰©æ˜¯ï¼Œå‘Šè¯‰äº†æˆ‘ä»¬$n$ç»´å•ä½çƒä½“çš„ä½“ç§¯$C_n=\\frac{\\pi^\\frac{n}{2}}{\\Gamma(\\frac{n}{2}+1)}$\n\n**æ¨è®º** è‹¥$\\xi \\sim \\chi^2(n)$ï¼Œåˆ™æœ‰$E(\\xi)=n$\n\n**è¯æ˜** ç”±å®šç†1ï¼Œç»“åˆæ•°å­¦æœŸæœ›çš„æ€§è´¨ï¼ŒçŸ¥$E(\\xi)=E(\\sum_{i=1}^{n}X_i^2)=\\sum_{i=1}^{n}E(X_i^2)=\\sum_{i=1}^{n}(D(X_i)+(E(X_i))^2)=\\sum_{i=1}^{n}1=n$ \n\n$\\quad \\Box$\n\n**å®šç†4** è‹¥$\\xi$ä¸$\\eta$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”$\\xi \\sim\\chi^2(n_1),\\eta \\sim\\chi^2(n_2)$ï¼Œåˆ™$\\xi+\\eta \\sim \\chi^2(n_1+n_2)$\n\n**è¯æ˜** è®¾$\\xi,\\etaï¼Œ\\xi+\\eta$çš„åˆ†å¸ƒå‡½æ•°åˆ†åˆ«ä¸º$p_1(x),p_2(x),p(x)$ï¼Œæˆ‘ä»¬å…ˆåˆ†åˆ«ä¸åŠ è¯æ˜çš„å¼•ç”¨æ¦‚ç‡è®ºå’ŒGammaå‡½æ•°çš„ä¸¤ä¸ªç»“è®ºï¼š\n\n1).å·²çŸ¥(X,Y)çš„è”åˆå¯†åº¦æ˜¯$p(x,y)$ï¼Œ$Z=Y+Y$çš„PDFä¸ºï¼š\n$$ \np_z(z)=\\int_{-\\infty}^{\\infty}p(x,z-x)dx\n $$\n2).$\\int_{0}^{1}v^{p-1}(1-v)^{q-1}dv=\\frac{\\Gamma(p)\\Gamma(q)}{\\Gamma(p+q)}$(p,qä¸ºæ­£æ•´æ•°)\n\nä¸‹é¢å¼€å§‹è¯æ˜ï¼š\nå½“ $x \\le 0$æ—¶ï¼Œ$P(\\xi+\\eta \\le 0)=0,p(x)=0$,å®šç†æˆç«‹ã€‚\n\nå½“ $x > 0$æ—¶ï¼Œ\n\n$$ \\begin{aligned}\np(x) &= \\int_{0}^{x}\\frac{1}{2^{\\frac{n_1}{2}}\\Gamma(\\frac{n_1}{2})}u^{\\frac{n_1}{2}-1}e^{-\\frac{u}{2}}\\frac{1}{2^{\\frac{n_2}{2}}\\Gamma(\\frac{n_2}{2})}(x-u)^{\\frac{n_2}{2}-1}e^{-\\frac{x-u}{2}}du \\\\\n&=\\frac{e^{-\\frac{x}{2}}x^{\\frac{n_1+n_2}{2}-1}}{2^{\\frac{n_1+n_2}{2}}\\Gamma(\\frac{n_1}{2})\\Gamma(\\frac{n_2}{2})}\\int_{0}^{1}v^{\\frac{n_1}{2}-1}(1-v)^{\\frac{n_2}{2}-1}dv ï¼ˆv=\\frac{u}{x}) \\\\\n&=\\frac{e^{-\\frac{x}{2}}x^{\\frac{n_1+n_2}{2}-1}}{2^{\\frac{n_1+n_2}{2}}\\Gamma(\\frac{n_1}{2})\\Gamma(\\frac{n_2}{2})}\\cdot\\frac{\\Gamma(\\frac{n_1}{2})\\Gamma(\\frac{n_2}{2})}{\\Gamma(\\frac{n_1+n_2}{2})} \\\\\n&=\\frac{1}{2^{\\frac{n_1+n_2}{2}}\\Gamma(\\frac{n_1}{2})\\Gamma(\\frac{n_2}{2})}x^{\\frac{n_1+n_2}{2}}e^{-\\frac{x}{2}}\n\\end{aligned} \n$$\n\nç»¼ä¸Šï¼š\n\n$$ \np(x) = \\begin{cases}\n\\frac{1}{2^{\\frac{n_1+n_2}{2}}\\Gamma(\\frac{n_1}{2})\\Gamma(\\frac{n_2}{2})}x^{\\frac{n_1+n_2}{2}}e^{-\\frac{x}{2}} & x>0\\\\\n0 & x\\le 0\n\\end{cases}\n $$ \n $\\Box$\n\n **å®šç†5** è‹¥$x_1,x_2,\\dots,x_n$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”éƒ½æœä»åˆ†å¸ƒ$N(0,1)$,åˆ™æœ‰å¦‚ä¸‹ä¸‰æ¡ç»“è®ºï¼š\n \n 1. $\\bar{X}=\\frac{X_1+X_2+\\dots\n +X_n}{n}\\sim N(0,\\frac{1}{n})$ \n 2. $\\sum_{i=1}^{n}(X_i-\\bar{X}) \\sim \\chi^2(n-1)$\n 3. $\\bar{X}$ä¸$\\sum_{i=1}^{n}(X_i-\\bar{X})$ç›¸äº’ç‹¬ç«‹\n\n**è¯æ˜** æ„é€ æ­£äº¤çŸ©é˜µ\n\n$$ \n  \\begin{bmatrix}\n   \\frac{1}{\\sqrt{n}} & \\frac{1}{\\sqrt{n}} & \\frac{1}{\\sqrt{n}} & \\dots & \\frac{1}{\\sqrt{n}}\\\\\n   \\frac{1}{\\sqrt{1\\cdot 2}} & \\frac{-1}{\\sqrt{1\\cdot 2}} & 0 &\\dots & 0  \\\\\n   \\frac{1}{\\sqrt{2\\cdot 3}} & \\frac{1}{\\sqrt{2\\cdot 3}} & \\frac{-2}{\\sqrt{2\\cdot 3}} &\\dots & 0  \\\\\n   \\vdots & \\vdots & \\vdots & \\ddots & 0 \\\\\n   \\frac{1}{\\sqrt{(n-1)n}} & \\frac{1}{\\sqrt{(n-1)n}} & \\frac{1}{\\sqrt{(n-1)n}} &\\dots & \\frac{-(n-1)}{\\sqrt{(n-1)n}} \n  \\end{bmatrix} \n $$\n ç”±æ­¤æ­£äº¤çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ éšæœºå˜é‡ï¼š\n\n $$ \n \\begin{aligned}\n   Y_1 &= \\frac{1}{\\sqrt{n}}(X_1+X_2+\\dots+X_n) \\\\\n   Y_2 &= \\frac{1}{\\sqrt{1\\cdot 2}}(X_1-X_2) \\\\\n   Y_3 &= \\frac{1}{\\sqrt{2\\cdot 3}}(X_1+X_2-2X_3) \\\\\n   \\dots \\\\\n    Y_n &= \\frac{1}{\\sqrt{(n-1)n}}(X_1+X_2+\\dots+X_{n}-(n-1)X_n)\n \\end{aligned}\n  $$\n  æœ‰å®šç†1å¯çŸ¥ï¼Œ$Y_1,Y_2,\\dots,Y_n$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”éƒ½æœä»$N(0,1)$ï¼Œ\n  æˆ‘ä»¬å‘ç°$Y_1 \\sim N(0,1)$ï¼Œå› æ­¤$\\bar{X}=\\frac{1}{\\sqrt{n}}Y_1\\sim N(0,\\frac{1}{n})$ï¼Œç¬¬ä¸€æ¡ç»“è®ºå¾—è¯ã€‚\n\n  ç”±äº$\\sum_{i=1}^{n}X_i^{2}=\\sum_{i=1}^{n}Y_i^{2}$æ•…\n\n  $$ \n \\begin{aligned}\n   \\sum_{i=1}^{n}(X_i-\\bar{X}) &= \\sum_{i=1}^{n}X_i^2-n\\bar{X} \\\\\n    &= \\sum_{i=1}^{n}Y_i^2-n(\\frac{1}{\\sqrt{n}}Y_i)^2 \\\\\n    &= \\sum_{i=1}^{n}Y_i^2-Y^2_i \\\\\n    &= \\sum_{i=2}^{n}Y_i^2 \\sim \\chi^2(n-1)\n \\end{aligned}\n  $$\n  ç¬¬äºŒæ¡ç»“è®ºå¾—è¯ã€‚\n\n  ç”±äº$Y_1,Y_2,\\dots,Y_n$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”\n  $$ \n  \\bar{X}=\\frac{1}{\\sqrt{n}}Y_1, \\sum_{i=1}^{n}(X_i-\\bar{X})^2=\\sum_{i=2}^{n}Y^{2}_{i}\n   $$\n  æ•…$\\bar{X}$ä¸$\\sum_{i=1}^{n}(X_i-\\bar{X})^2$ç‹¬ç«‹ï¼Œç¬¬ä¸‰æ¡ç»“è®ºå¾—è¯\n  $\\Box$\n\n  **æ¨è®º** è‹¥$x_1,x_2,\\dots,x_n$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”éƒ½æœä»åˆ†å¸ƒ$N(\\mu,\\sigma^2)$,åˆ™æœ‰å¦‚ä¸‹ä¸‰æ¡ç»“è®ºï¼š\n \n 1. $\\bar{X}=\\frac{X_1+X_2+\\dots\n +X_n}{n}\\sim N(\\mu,\\frac{\\sigma^2}{n})$ \n 2. $\\frac{1}{\\sigma^2}\\sum_{i=1}^{n}(X_i-\\bar{X}) \\sim \\chi^2(n-1)$\n 3. $\\bar{X}$ä¸$\\sum_{i=1}^{n}(X_i-\\bar{X})$ç›¸äº’ç‹¬ç«‹\n\n## å…³äºtåˆ†å¸ƒ\n**å®šç†6** è®¾$\\xi,\\eta$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”$\\xi \\sim N(0,1),\\eta \\sim \\chi^2(n)$ï¼Œ åˆ™$\\zeta=\\frac{\\xi}{\\sqrt{\\frac{\\eta}{n}}} \\sim t(n)$ï¼Œå…¶PDFä¸ºï¼š\n$$ \np(u)=t_n(u) = \\frac{\\Gamma(\\frac{n+1}{2})}{\\Gamma(\\frac{n}{2})\\sqrt{n\\pi}}(1+\\frac{u^2}{n})^{-\\frac{n+1}{2}} \\quad (5)\n $$\n**è¯æ˜** ä¸å®šç†3è¯æ˜çš„æ€è·¯ç±»ä¼¼ï¼Œè®¾$F(u) = P\\{\\zeta \\le u\\}$è¯æ˜$F^{\\prime}(u)=t_n(u)$, ç”±å·²çŸ¥ï¼š\n$$ \n\\begin{aligned}\n  F(u) \n  &= P\\{\\frac{\\xi}{\\sqrt{\\frac{\\eta}{n}}} \\le u\\} \\\\\n  &= P\\{\\frac{\\xi}{\\sqrt{\\eta}} \\le \\frac{u}{\\sqrt{n}}\\} \\\\\n  &= \\iint_{\\frac{x}{\\sqrt{y}}\\le\\frac{u}{\\sqrt{n}}} \\frac{1}{\\sqrt{2\\pi}}e^{-\\frac{x^2}{2}}\\cdot\\frac{1}{2^{\\frac{n}{2}}\\Gamma(\\frac{n}{2})}y^{\\frac{n}{2}-1}e^{-\\frac{y}{2}}dxdy \\\\\n  &= \\iint_{t \\le \\frac{u}{\\sqrt{n}},y > 0} \\frac{1}{\\sqrt{2\\pi}2^{\\frac{n}{2}}\\Gamma(\\frac{n}{2})}s^{\\frac{n}{2}-1}\\cdot e^{-\\frac{1}{2}(1+t^2)s}|J(\\frac{x,y}{s,t})|dsdt \\quad (t=\\frac{x}{\\sqrt{y}},y=s) \\\\\n  &= \\int_{-\\infty}^{\\frac{u}{\\sqrt{n}}} \\frac{dt}{\\sqrt{\\pi}\\Gamma(\\frac{n}{2})}\\int_{0}^{+\\infty}(\\frac{s}{2})^{\\frac{n-1}{2}}e^{-\\frac{s}{2}(1+t^2)}d(\\frac{s}{2}) \\\\\n  &= \\int_{-\\infty}^{\\frac{u}{\\sqrt{n}}} \\frac{1}{\\sqrt{\\pi}\\Gamma(\\frac{n}{2})} \\cdot \\frac{\\Gamma(\\frac{n+1}{2})}{(1+t^2)^{\\frac{n+1}{2}}}dt \\\\\n  &= \\int_{-\\infty}^{u} \\frac{1}{\\sqrt{n\\pi}\\Gamma(\\frac{n}{2})} \\cdot \\frac{\\Gamma(\\frac{n+1}{2})}{(1+\\frac{v^2}{n})^{\\frac{n+1}{2}}}dv \\quad (v=t\\sqrt{n})\n\\end{aligned}\n $$\n æ•…$F^{\\prime}(u)= t_n(u) \\quad \\Box$ \n \n å®šç†5,6å¯ä»¥ç”¨æ¥è¯æ˜ä¸‹é¢è¿™ä¸ªåœ¨ç»Ÿè®¡å­¦é‡Œå¾ˆæœ‰ä½œç”¨çš„å®šç†ï¼š\n\n **å®šç†7** è®¾$X_1,X_2,\\dots,X_n (n \\ge 2)$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”éƒ½æœä»$N(\\mu,\\sigma^2)$,åˆ™$T=\\frac{\\bar{X}-\\mu}{\\sqrt{\\frac{S^2}{n}}} \\sim t(n-1)$å…¶ä¸­\n $$ \\bar{X}=\\frac{X_1+X_2+\\dots+X_n}{n}, S^2=\\frac{1}{n-1}\\sum_{i=1}^{n}(X_i-\\bar{X})^2$$\n\n **è¯æ˜** æ„é€ éšæœºå˜é‡\n $$ \n \\xi = \\frac{\\bar{X}-\\mu}{\\sqrt{\\frac{\\sigma^2}{n}}},\\eta=\\frac{1}{\\sigma^2}\\cdot\\sum_{i=1}^{n}(X_i-\\bar{X})^2\n  $$\n æ ¹æ®å®šç†5çš„æ¨è®ºï¼Œæˆ‘ä»¬çŸ¥é“$\\xi,\\eta$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”$\\xi\\sim N(0,1),\\eta\\sim \\chi^2(n-1)$\n æ•…æ ¹æ®å®šç†6ï¼Œ$\\frac{\\xi}{\\sqrt{\\frac{\\eta}{n-1}}}\\sim t(n-1)$\n æ•… \n $$ T=\\frac{\\bar{X}-\\mu}{\\sqrt{\\frac{S^2}{n}}}=\\frac{\\frac{\\bar{X}-\\mu}{\\sqrt{\\frac{\\sigma^2}{n}}}}{\\sqrt{\\frac{S^2}{\\sigma^2}}}=\\frac{\\xi}{\\sqrt{\\frac{\\eta}{n-1}}} \\sim t(n-1) \\quad \\Box$$\n\n ## å…³äºFåˆ†å¸ƒ\n\n **å®šç†8** è®¾$\\xi,\\eta$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”$\\xi\\sim \\chi^2(n_1),\\eta\\sim \\chi^2(n_2)$ åˆ™ $\\zeta=\\frac{\\frac{\\xi}{n_1}}{\\frac{\\eta}{n_2}} \\sim F(n_1,n_2)$ å…¶PDFä¸ºï¼š\n $$ \n p(u) = f_{n_1,n_2}(u) = \\begin{cases}\n   \\frac{\\Gamma(\\frac{n_1+n_2}{2})}{\\Gamma(\\frac{n_1}{2})\\Gamma(\\frac{n_2}{2})}(\\frac{n_1}{n_2})^{\\frac{n_1}{2}}u^{\\frac{n_1}{2}-1}(1+\\frac{n_1}{n_2}u)^{-\\frac{n_1+n_2}{2}} & u > 0 \\\\\n   0 & u \\le 0\n \\end{cases}\n  $$\n**è¯æ˜** è·Ÿä¹‹å‰ä¸€æ ·ï¼Œä»¤$F(u)=P\\{\\xi\\le u\\}$ ï¼Œè¯æ˜$F^{\\prime}(u)=f_{n_1,n_2}(u)$ \n\nå½“ $u \\le 0, F(u)=0$,\n$$ \n\\begin{aligned}\n  F(u) \n  &= P\\{\\xi\\le u\\} \\\\\n  &= P\\{\\frac{\\frac{\\xi}{n_1}}{\\frac{\\eta}{n_2}}\\le u\\} \\\\\n  &= P\\{\\frac{\\xi}{\\eta}\\le \\frac{n_1}{n_2}u\\} \\\\\n  &= \\iint_{\\frac{x}{y}\\le\\frac{n_1}{n_2}u,x>0,y>0}\\frac{1}{2^{\\frac{n_1}{2}}\\Gamma(\\frac{n_1}{2})}x^{\\frac{n_1}{2}-1}e^{-\\frac{x}{2}}\\frac{1}{2^{\\frac{n_2}{2}}\\Gamma(\\frac{n_2}{2})}y^{\\frac{n_2}{2}-1}e^{-\\frac{y}{2}}dxdy \\\\\n  &= \\iint_{0 < t \\le \\frac{n_1}{n_2}u,s>0} \\frac{e^{-\\frac{s}{2}(1+t)}s^{\\frac{n_1+n_2}{2}-2}}{2^{\\frac{n_1+n_2}{2}}\\Gamma(\\frac{n_1}{2})\\Gamma(\\frac{n_2}{2})}t^{\\frac{n_1}{2}-1}\\cdot|J(\\frac{x,y}{s,t})|dsdt \\quad x=st,y=s \\\\\n  &= \\int_{0}^{\\frac{n_1}{n_2}u}\\frac{t^{\\frac{n_1}{2}-1}}{2^{\\frac{n_1+n_2}{2}}\\Gamma(\\frac{n_1}{2})\\Gamma(\\frac{n_2}{2})}dt\\int_{0}^{+\\infty}s^{\\frac{n_1+n_2}{2}-1}t^{\\frac{n_1}{2}-1}dsdt \\\\\n  &= \\int_{0}^{\\frac{n_1}{n_2}u}\\frac{\\Gamma(\\frac{n_1+n_2}{2})}{2^{\\frac{n_1+n_2}{2}}\\Gamma(\\frac{n_1}{2})\\Gamma(\\frac{n_2}{2})}t^{\\frac{n_1}{2}-1}(1+t)^{-\\frac{n_1+n_2}{2}}dt \\\\\n  &= \\int_{0}^{u}\\frac{\\Gamma(\\frac{n_1+n_2}{2})}{2^{\\frac{n_1+n_2}{2}}\\Gamma(\\frac{n_1}{2})\\Gamma(\\frac{n_2}{2})}(\\frac{n_1}{n_2})^{\\frac{n_1}{2}}v^{\\frac{n_1}{2}-1}(1+\\frac{n_1}{n_2}v)^{-\\frac{n_1+n_2}{2}}dv \\quad  (t=\\frac{n_1}{n_2}v)\n\\end{aligned}\n$$\næ•…$F^{\\prime}(u)=f_{n_1,n_2}(u)$  $\\quad \\Box$\n\n**å®šç†9** è®¾$X_1,X_2,\\dots,X_{n_1},Y_1,Y_2,\\dots,Y_n$, è¿™$n_1+n_2$ä¸ªéšæœºå˜é‡ç›¸äº’ç‹¬ç«‹ï¼Œä¸”éƒ½æœä»$N(\\mu,\\sigma^2)$,åˆ™\n$$ \\zeta=\\frac{\\frac{1}{n_1-1}\\sum_{i=1}^{n_1}(X_i-\\bar{X})^2}{\\frac{1}{n_2-1}\\sum_{i=1}^{n_2}(Y_i-\\bar{Y})^2} \\sim F(n_1-1,n_2-1)$$ \n\n**è¯æ˜** æ„é€ éšæœºå˜é‡\n\n$$\n\\xi=\\frac{1}{\\sigma^2}\\cdot\\sum_{i=1}^{n}(X_i-\\bar{Y})^2, \\eta=\\frac{1}{\\sigma^2}\\cdot\\sum_{i=1}^{n}(Y_i-\\bar{Y})^2 \n$$\nç”±ä¹‹å‰çš„ç»“è®ºï¼Œæˆ‘ä»¬çŸ¥é“$\\xi\\sim\\chi^2(n_1-1),\\eta\\sim\\chi^2(n_2-1)$, æ¥ä¸‹æ¥è¯æ˜$\\xi,\\eta$çš„ç‹¬ç«‹æ€§ï¼Œæ„é€ éšæœºå˜é‡ï¼š\n$$ U_i = \\frac{X_i-\\mu}{\\sigma},V_i=\\frac{Y_i-\\mu}{\\sigma} \n$$\nåˆ™\n$$ \n\\xi=\\sum_{i=1}^{n_1}(U_i-\\bar{U}),\\eta=\\sum_{i=1}^{n_2}(V_i-\\bar{V})\n $$\nç”±å·²çŸ¥$U_1,U_2,\\dots,U_{n_1},V_1,V_2,\\dots,V_{n_2}$ ç›¸äº’ç‹¬ç«‹ï¼Œä¸”éƒ½æœä»$N(0,1)$,äºæ˜¯å…¶è”åˆåˆ†å¸ƒå¯†åº¦ä¸º\n$$ \np(u_1,u_2,\\dots,u_{n_1},v_1,v_2,\\dots,v_{n_2}) \\\\\n=(\\frac{1}{\\sqrt{2\\pi}})^{n_1+n_2}\\cdot e^{-\\frac{1}{2}(\\sum_{i=1}^{n_1}u^2_{i}+\\sum_{i=1}^{n_2}v^2_{i})}\n$$\næ‰€ä»¥,å¯¹äºä»»æ„çš„å®æ•°$a,b,c,d$\n$$ \n\\begin{aligned}\n  P\\{a< \\xi < b, c < \\eta < d \\}\n  =& \\int\\limits_{a<\\sum_{i=1}^{n_1}(u_i-\\bar{u})^2 < b,c < \\sum_{i=1}^{n_1}(v_i-\\bar{v})^2 < d  }p(u_1,u_2,\\dots,u_{n_1}v_1,v_2,\\dots,v_{n_2})du_1 \\dots du_{n_1}dv_1\\dots dv_{n_2} \\\\\n  =& \\int_{a<\\sum_{i=1}^{n_1}(u_i-\\bar{u})^2 < b}(\\frac{1}{\\sqrt{2\\pi}})^{n_1}e^{-\\frac{1}{2}\\sum_{i=1}^{n_1}u_i^2}du_1\\dots du_{n_1} \\cdot \\\\\n  &\\int_{a<\\sum_{i=1}^{n_1}(v_i-\\bar{v})^2 < b}(\\frac{1}{\\sqrt{2\\pi}})^{n_1}e^{-\\frac{1}{2}\\sum_{i=1}^{n_1}v_i^2}dv_1\\dots dv_{n_1} \\\\\n  =& P\\{a < \\xi < b\\} \\cdot P\\{c < \\eta < d\\} \n\\end{aligned}\n $$\n ç‹¬ç«‹æ€§å¾—è¯ã€‚\n\n å†ç»“åˆå®šç†8ï¼Œ\n \n $$\\zeta=\\frac{\\frac{1}{n_1-1}\\sum_{i=1}^{n_1}(X_i-\\bar{X})^2}{\\frac{1}{n_2-1}\\sum_{i=1}^{n_2}(Y_i-\\bar{Y})^2} = \\frac{\\frac{\\xi}{n_1-1}}{\\frac{\\eta}{n_2-1}} \\sim F(n_1-1,n_2-1) \\quad \\Box\n $$\n\n\n\n\n","tags":["note","Probability"],"categories":["math"]},{"title":"Hello World","url":"/2018/07/29/hello-world/","content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","tags":["hexo","NodeJS"],"categories":["implementation"]},{"title":"å­¦ä¹ ï¼Œç ”ç©¶ï¼Œåˆ›æ–°ï¼Œåˆ†äº«","url":"/about/index.html","content":"\n#### ä¸ºä½•å»ºç«™\n\nç§‘ç ”ä»å…´è¶£å‡ºå‘ï¼Œç”¨è‰¯å¥½çš„ä¹ æƒ¯åšæŒå’Œæˆé•¿ã€‚æœ¬ç«™æ—¨åœ¨è®°å½•æˆé•¿ç‚¹æ»´ã€‚\n\n#### ä¸ºä½•å†™ä½œ\n\nå†™ä½œå¯ä»¥æŠµæŠ—é—å¿˜å’Œè¡°æœ½ï¼Œå¤äººäº‘ï¼š\n\n> ç›–æ–‡ç« ï¼Œç»å›½ä¹‹å¤§ä¸šï¼Œä¸æœ½ä¹‹ç››äº‹ã€‚å¹´å¯¿æœ‰æ—¶è€Œå°½ï¼Œè£ä¹æ­¢ä¹å…¶èº«ï¼ŒäºŒè€…å¿…è‡³ä¹‹å¸¸æœŸï¼Œæœªè‹¥æ–‡ç« ä¹‹æ— ç©·ã€‚\n                                                             â€”â€”æ›¹ä¸•ã€Šå…¸è®ºÂ·è®ºæ–‡ã€‹èŠ‚é€‰\n\nè€Œåœ¨ç§‘ç ”ä¸­ï¼Œå†™ä½œå¯ä»¥æ•´ç†æ–‡çŒ®ç»¼è¿°ã€ææ–™æ–¹æ³•ï¼Œå·²ç»å–å¾—çš„æ•°æ®ç»“æœã€‚æ›´é‡è¦çš„æ˜¯ç†æ¸…ä¸‹ä¸€æ­¥ç ”ç©¶æ€è·¯å’ŒæŠ€æœ¯è·¯çº¿ã€‚\n\næ­¤å¤–ï¼Œå‹¤ç»ƒå†™ä½œï¼Œå¯ä»¥æé«˜ç ”ç©¶è€…è¡¨è¾¾å’Œæ¨å¹¿è‡ªå·±è§‚ç‚¹å’Œç ”ç©¶æˆæœçš„èƒ½åŠ›ã€‚\n\næœ€ç»ˆå¸Œæœ›å¤§å®¶éƒ½èƒ½åšå­¦é—®æˆ–è€…å­¦è‡ªå·±æ„Ÿå…´è¶£çš„äº‹ç‰©ï¼Œæœ€åèƒ½å¦‚éŸ©æ„ˆä½œæ–‡ä¸€æ ·ï¼Œå®ç°è¿™ç§ç†æƒ³çš„å¢ƒç•Œï¼š\n\n> æœ¬æ·±è€Œæœ«èŒ‚ï¼Œå½¢å¤§è€Œå£°å®ï¼Œè¡Œå³»è€Œè¨€å‰ï¼Œå¿ƒé†‡è€Œæ°”å’Œï¼Œæ˜­æ™°è€…æ— ç–‘ï¼Œä¼˜æ¸¸è€…æœ‰ä½™ã€‚\n\n#### æ¶µç›–ä¸»é¢˜\n\næœ¬ç«™æœ€å…³æ³¨çš„æ˜¯åŸºå› ç»„å­¦å’Œç”Ÿç‰©ä¿¡æ¯å­¦çš„å„é¡¹ç ”ç©¶ä»¥åŠç›¸å…³çš„ç”Ÿç‰©å­¦ï¼Œä¿¡æ¯å­¦ï¼Œæ•°å­¦å’Œç»Ÿè®¡å­¦ï¼ˆå°†æ¥å¯èƒ½è¿˜ä¼šæœ‰ç‰©ç†å­¦å’ŒåŒ–å­¦ï¼‰çš„åŸºç¡€çŸ¥è¯†çš„å­¦ä¹ ã€‚æ›´å¤šè§[è¯é¢˜æ ‡ç­¾](https://landau1994.github.io/tags)\n\n#### å…³äºä½œè€…\n\nç”Ÿç‰©ä¿¡æ¯å­¦åšå£«ã€‚çŸ¥ä¹ä¸»é¡µ[https://www.zhihu.com/people/landau1994]ã€‚"},{"title":"QA","url":"/help/index.html","content":"\n### Q: è¿™ç½‘ç«™æ€ä¹ˆå¼„çš„ï¼Œè¿˜æŒºå¥½çœ‹çš„å•Šï¼Ÿ\n\n> A: æœ¬ç«™æ˜¯é™æ€åšå®¢ï¼Œé€šè¿‡[hexo]()ç”Ÿæˆï¼Œä¸»é¢˜ä¸º[jsimple](),åšäº†ä¸ªæ€§åŒ–çš„å®šåˆ¶ï¼ˆæ¢äº†ç™½å¤©å’Œæ™šä¸Šçš„å›¾ç‰‡ï¼Œä¿®æ”¹äº†é…ç½®æ”¯æŒæ•°å­¦å…¬å¼ï¼‰ã€‚\n\n### Q: ä¸ºä»€ä¹ˆåšå®¢æœ‰æ—¶å€™æ‰“å¼€é€Ÿåº¦å¾ˆæ…¢ï¼Œä¸€ç›´åœ¨åŠ è½½ï¼Œæˆ–è€…æœ‰æ—¶å‹æ ¹æ‰“ä¸å¼€å‘¢ï¼Ÿ\n\n> A: æœ¬ç«™å°šæ— ç‹¬ç«‹åŸŸåï¼Œæš‚æ—¶ä½¿ç”¨[Github Page]()ã€‚æ‰€ä»¥githubå¡æˆ–è€…å´©çš„æ—¶å€™å°±ggäº†ã€‚ä¸è¿‡è¿™éƒ½æ˜¯å°æ¦‚ç‡äº‹ä»¶ã€‚å¼€æºä¸‡å²ï¼Œgithubä¸‡å²,æ‹¥æŠ±å¼€æºçš„å¾®è½¯ä¸‡å²ã€‚\n\n### Q: æˆ‘ä¹Ÿæƒ³æ­ä¸ªåšå®¢ï¼Œä¸çŸ¥é“æ€ä¹ˆå¼„ï¼Ÿ\n\n> A: å‚è€ƒé—®é¢˜1ï¼Œå­¦ä¼šçœ‹å®˜ç½‘æ•™ç¨‹ï¼Œä»¥åŠè‡ªå·±åŠ¨æ‰‹ä¿®æ”¹å’Œè°ƒè¯•é…ç½®æ–‡æ¡£ã€‚ \n\n\n### Q: æœ¬ç«™æ˜¯å¦æ¥å—æŠ•ç¨¿æˆ–è½¬è½½ï¼Ÿ\n\n> ç«™é•¿æœ¬äººä¹‹å¤–çš„æŠ•ç¨¿å’Œè½¬è½½æš‚ä¸æ”¯æŒã€‚\n\n### Q: å…¶ä»–çš„...\n\n> æœ¬ç«™ä¸ºç«™é•¿è‡ªå·±çš„å­¦ä¹ è®°å½•ï¼Œå› ä¸ªäººçŸ¥è¯†æ°´å¹³æ‰€é™ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œè¿˜æœ›[æ‰¹è¯„æŒ‡æ­£](https://github.com/Landau1994/landau1994.github.io/issues)ã€‚\n"},{"title":"tags","url":"/tags/index.html"},{"title":"links","url":"/links/index.html","content":"\n![è®¡ç®—ç”Ÿç‰©å­¦/ç”Ÿç‰©ä¿¡æ¯å­¦å®¶æˆé•¿ä¹‹è·¯](/images/combio_roadmap.png)\n\n#### ä»¥ä¸‹æ‘˜å½•æœ‰è¶£ã€æœ‰æ„ä¹‰ã€æœ‰å½±å“åŠ›çš„é“¾æ¥\n\næŒç»­æ›´æ–°ä¸­ã€‚\n\n> æ­¤å¤„ä¸åšç½‘å€å¯¼èˆªï¼Œæ’åºä¸åˆ†å…ˆå...\n\n## ğŸ”¬ åŸºæœ¬èµ„æº\n\n### ä»£ç ä¸å¼€å‘\n- [GitHub](https://github.com/) - å…¨çƒæœ€å¤§çš„ä»£ç æ‰˜ç®¡å¹³å°\n- [Stack Overflow](https://stackoverflow.com/) - ç¨‹åºå‘˜é—®ç­”ç¤¾åŒº\n- [Biostars](https://www.biostars.org/) - ç”Ÿç‰©ä¿¡æ¯å­¦ä¸“ä¸šé—®ç­”ç¤¾åŒº\n\n### å­¦æœ¯æœç´¢\n- [Google Scholar](https://scholar.google.com/) - å­¦æœ¯æ–‡çŒ®æœç´¢å¼•æ“\n- [PubMed](https://pubmed.ncbi.nlm.nih.gov/) - ç”Ÿç‰©åŒ»å­¦æ–‡çŒ®æ•°æ®åº“\n- [bioRxiv](https://www.biorxiv.org/) - ç”Ÿç‰©å­¦é¢„å°æœ¬æœåŠ¡å™¨\n- [arXiv](https://arxiv.org/) - ç‰©ç†ã€æ•°å­¦ã€è®¡ç®—æœºç§‘å­¦é¢„å°æœ¬\n\n### é¡¶çº§æœŸåˆŠ\n- [Nature](https://www.nature.com/)\n- [Science](https://www.science.org/)\n- [Cell](https://www.cell.com/)\n- [Nature Methods](https://www.nature.com/nmeth/) - æ–¹æ³•å­¦æœŸåˆŠ\n- [Genome Biology](https://genomebiology.biomedcentral.com/)\n- [Bioinformatics](https://academic.oup.com/bioinformatics)\n\n---\n\n## ğŸ“š ç”Ÿç‰©ä¿¡æ¯å­¦èµ„æº\n\n### ä¸­æ–‡ç¤¾åŒº\n- [å®ç”¨ç”Ÿç‰©ä¿¡æ¯æŠ€æœ¯](http://abc.cbi.pku.edu.cn/) - åŒ—å¤§CBIå®ç”¨æ•™ç¨‹\n- [CBI forum](http://202.205.131.32/forum/) - åŒ—å¤§ç”Ÿä¿¡è®ºå›\n- [ç”Ÿä¿¡æŠ€èƒ½æ ‘](http://www.biotrainee.com/) - ç”Ÿä¿¡å­¦ä¹ ç¤¾åŒº\n- [ç”Ÿä¿¡å‘](https://www.bioinfo.info/) - ç”Ÿä¿¡æŠ€æœ¯åˆ†äº«\n- [ç”Ÿä¿¡èœé¸Ÿå›¢](http://www.bio-info-trainee.com/) - ç”Ÿä¿¡å…¥é—¨æ•™ç¨‹\n\n### å›½é™…èµ„æº\n- [Bioconductor](https://www.bioconductor.org/) - R è¯­è¨€ç”Ÿç‰©ä¿¡æ¯å­¦åŒ…\n- [Galaxy](https://usegalaxy.org/) - åŸºäºWebçš„ç”Ÿä¿¡åˆ†æå¹³å°\n- [UCSC Genome Browser](https://genome.ucsc.edu/) - åŸºå› ç»„æµè§ˆå™¨\n- [Ensembl](https://www.ensembl.org/) - åŸºå› ç»„æ³¨é‡Šæ•°æ®åº“\n- [NCBI](https://www.ncbi.nlm.nih.gov/) - ç¾å›½ç”Ÿç‰©æŠ€æœ¯ä¿¡æ¯ä¸­å¿ƒ\n\n### æ•°æ®åº“\n- [UniProt](https://www.uniprot.org/) - è›‹ç™½è´¨åºåˆ—ä¸åŠŸèƒ½æ•°æ®åº“\n- [KEGG](https://www.genome.jp/kegg/) - åŸºå› ä¸åŸºå› ç»„ç™¾ç§‘å…¨ä¹¦\n- [STRING](https://string-db.org/) - è›‹ç™½è´¨ç›¸äº’ä½œç”¨ç½‘ç»œ\n- [Gene Ontology](http://geneontology.org/) - åŸºå› æœ¬ä½“è®º\n- [ExPASy](https://www.expasy.org/) - è›‹ç™½è´¨ç»„å­¦èµ„æº\n\n---\n\n## ğŸ›ï¸ ç ”ç©¶æœºæ„ä¸å¤§å‹é¡¹ç›®\n\n### å›½é™…ç ”ç©¶æœºæ„\n- [Wellcome Sanger Institute](https://www.sanger.ac.uk/) - è‹±å›½æ¡‘æ ¼ç ”ç©¶æ‰€ï¼ŒåŸºå› ç»„å­¦ç ”ç©¶å…ˆé©±\n- [Broad Institute](https://www.broadinstitute.org/) - å“ˆä½›-MITè”åˆç ”ç©¶æ‰€ï¼ŒåŸºå› ç»„åŒ»å­¦\n- [Allen Institute](https://alleninstitute.org/) - è‰¾ä¼¦è„‘ç§‘å­¦ç ”ç©¶æ‰€\n- [Arc Institute](https://arcinstitute.org/) - å‰æ²¿ç”Ÿç‰©åŒ»å­¦ç ”ç©¶æœºæ„\n- [European Bioinformatics Institute (EBI)](https://www.ebi.ac.uk/) - æ¬§æ´²ç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶æ‰€\n\n### å¤§å‹ç§‘ç ”è®¡åˆ’\n- [Human Cell Atlas](https://www.humancellatlas.org/) - äººç±»ç»†èƒå›¾è°±è®¡åˆ’\n- [Chan Zuckerberg Initiative (CZI)](https://chanzuckerberg.com/) - é™ˆ-æ‰å…‹ä¼¯æ ¼å€¡è®®\n  - [CZ Biohub](https://www.czbiohub.org/) - CZ ç”Ÿç‰©ä¸­å¿ƒ\n  - [CZ CELLxGENE](https://cellxgene.cziscience.com/) - å•ç»†èƒæ•°æ®é—¨æˆ·\n- [ENCODE Project](https://www.encodeproject.org/) - DNAå…ƒä»¶ç™¾ç§‘å…¨ä¹¦è®¡åˆ’\n- [1000 Genomes Project](https://www.internationalgenome.org/) - åƒäººåŸºå› ç»„è®¡åˆ’\n- [GTEx Portal](https://gtexportal.org/) - åŸºå› å‹-ç»„ç»‡è¡¨è¾¾é¡¹ç›®\n- [Human Protein Atlas](https://www.proteinatlas.org/) - äººç±»è›‹ç™½è´¨å›¾è°±\n\n### å•ç»†èƒèµ„æº\n- [Single Cell Portal](https://singlecell.broadinstitute.org/) - Broadç ”ç©¶æ‰€å•ç»†èƒé—¨æˆ·\n- [10x Genomics Resources](https://www.10xgenomics.com/resources) - 10x å•ç»†èƒæŠ€æœ¯èµ„æº\n- [scRNA-seq Database](https://bioinfo.uth.edu/scrnaseqdb/) - å•ç»†èƒæ•°æ®åº“é›†åˆ\n\n---\n\n## ğŸ› ï¸ å·¥å…·ä¸æ•™ç¨‹\n\n### åœ¨çº¿å·¥å…·\n- [BLAST](https://blast.ncbi.nlm.nih.gov/) - åºåˆ—æ¯”å¯¹å·¥å…·\n- [Clustal Omega](https://www.ebi.ac.uk/Tools/msa/clustalo/) - å¤šåºåˆ—æ¯”å¯¹\n- [SnapGene Viewer](https://www.snapgene.com/snapgene-viewer/) - è´¨ç²’æŸ¥çœ‹å·¥å…·\n- [DeepL](https://www.deepl.com/) - AI ç¿»è¯‘å·¥å…·\n\n### ç¼–ç¨‹å­¦ä¹ \n- [Rosalind](http://rosalind.info/) - ç”Ÿç‰©ä¿¡æ¯å­¦ç¼–ç¨‹ç»ƒä¹ \n- [Kaggle](https://www.kaggle.com/) - æ•°æ®ç§‘å­¦ç«èµ›å¹³å°\n- [DataCamp](https://www.datacamp.com/) - æ•°æ®ç§‘å­¦åœ¨çº¿è¯¾ç¨‹\n- [Coursera](https://www.coursera.org/) - åœ¨çº¿è¯¾ç¨‹å¹³å°\n\n### æ–‡æ¡£æ•™ç¨‹\n- [The Carpentries](https://carpentries.org/) - ç§‘ç ”è®¡ç®—æŠ€èƒ½åŸ¹è®­\n- [NGS Analysis](https://github.com/griffithlab/rnaseq_tutorial) - NGS æ•°æ®åˆ†ææ•™ç¨‹\n- [Awesome Bioinformatics](https://github.com/danielecook/Awesome-Bioinformatics) - ç”Ÿä¿¡èµ„æºé›†åˆ\n- [scRNA-tools](https://www.scrna-tools.org/) - å•ç»†èƒåˆ†æå·¥å…·æ•°æ®åº“\n\n---\n\n## ğŸ§¬ AI ç”Ÿç‰©å­¦å·¥å…·\n\n### è›‹ç™½è´¨ç»“æ„é¢„æµ‹\n- [AlphaFold 3](https://alphafoldserver.com/) - DeepMind è›‹ç™½è´¨ç»“æ„é¢„æµ‹ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰\n  - [AlphaFold Database](https://alphafold.ebi.ac.uk/) - 2äº¿+è›‹ç™½è´¨ç»“æ„æ•°æ®åº“\n  - [AlphaFold GitHub](https://github.com/deepmind/alphafold) - AlphaFold å¼€æºä»£ç \n- [RoseTTAFold](https://robetta.bakerlab.org/) - Baker Lab è›‹ç™½è´¨ç»“æ„é¢„æµ‹\n  - [RoseTTAFold GitHub](https://github.com/RosettaCommons/RoseTTAFold) - å¼€æºå®ç°\n- [ESMFold](https://esmatlas.com/) - Meta å¿«é€Ÿè›‹ç™½è´¨ç»“æ„é¢„æµ‹\n  - [ESM Metagenomic Atlas](https://esmatlas.com/about) - 6äº¿+å®åŸºå› ç»„è›‹ç™½ç»“æ„\n\n### è›‹ç™½è´¨è®¾è®¡\n- [ProteinMPNN](https://github.com/dauparas/ProteinMPNN) - è›‹ç™½è´¨åºåˆ—è®¾è®¡\n- [RFdiffusion](https://github.com/RosettaCommons/RFdiffusion) - åŸºäºæ‰©æ•£æ¨¡å‹çš„è›‹ç™½è´¨è®¾è®¡\n- [Chroma](https://generatebiomedicines.com/chroma) - Generate Biomedicines è›‹ç™½è´¨ç”Ÿæˆæ¨¡å‹\n\n### åŸºå› ç»„ä¸åºåˆ—åˆ†æ\n- [AlphaGenome](https://www.deepmind.com/) - DeepMind åŸºå› ç»„åˆ†æï¼ˆå¼€å‘ä¸­ï¼‰\n- [Enformer](https://github.com/deepmind/deepmind-research/tree/master/enformer) - åŸºå› è¡¨è¾¾é¢„æµ‹\n- [DNA Foundation Models](https://www.nucleate.xyz/) - DNA å¤§æ¨¡å‹åˆé›†\n\n### åˆ†å­å¯¹æ¥ä¸è¯ç‰©å‘ç°\n- [DiffDock](https://github.com/gcorso/DiffDock) - æ‰©æ•£æ¨¡å‹åˆ†å­å¯¹æ¥\n- [AlphaFold-Multimer](https://github.com/deepmind/alphafold) - è›‹ç™½è´¨å¤åˆç‰©é¢„æµ‹\n- [Uni-Mol](https://github.com/dptech-corp/Uni-Mol) - åˆ†å­æ€§è´¨é¢„æµ‹ç»Ÿä¸€æ¨¡å‹\n\n### RNA ç»“æ„é¢„æµ‹\n- [AlphaFold-RNA](https://alphafold.com/) - RNA ç»“æ„é¢„æµ‹ï¼ˆé›†æˆäº AlphaFold 3ï¼‰\n- [RNAfold](http://rna.tbi.univie.ac.at/cgi-bin/RNAWebSuite/RNAfold.cgi) - RNA äºŒçº§ç»“æ„é¢„æµ‹\n- [RhoFold](https://github.com/ml4bio/RhoFold) - åŸºäº AI çš„ RNA 3D ç»“æ„é¢„æµ‹\n\n---\n\n## ğŸ¤– AI å¤§è¯­è¨€æ¨¡å‹\n\n### å›½é™…ä¸»æµæ¨¡å‹\n- [OpenAI ChatGPT](https://chat.openai.com/) - GPT-5.3ï¼Œæœ€å¼ºå¤§çš„é€šç”¨å¤§æ¨¡å‹\n  - [OpenAI API](https://platform.openai.com/) - OpenAI å¼€å‘è€…å¹³å°\n  - [OpenAI Playground](https://platform.openai.com/playground) - API æµ‹è¯•ç¯å¢ƒ\n- [Anthropic Claude](https://claude.ai/) - Claude 4ï¼Œæ“…é•¿é•¿æ–‡æœ¬å’Œæ¨ç†\n  - [Claude API](https://console.anthropic.com/) - Anthropic å¼€å‘è€…å¹³å°\n- [Google Gemini](https://gemini.google.com/) - Google æœ€æ–°å¤šæ¨¡æ€å¤§æ¨¡å‹\n  - [Gemini API](https://ai.google.dev/) - Google AI å¼€å‘å¹³å°\n- [Meta Llama](https://llama.meta.com/) - Meta å¼€æºå¤§æ¨¡å‹å®¶æ—\n- [Mistral AI](https://mistral.ai/) - æ¬§æ´²å¼€æºå¤§æ¨¡å‹é¢†å†›è€…\n- [Perplexity](https://www.perplexity.ai/) - AI æœç´¢å¼•æ“\n\n### å›½å†…ä¸»æµæ¨¡å‹\n- [æ–‡å¿ƒä¸€è¨€](https://yiyan.baidu.com/) - ç™¾åº¦å¤§æ¨¡å‹\n- [é€šä¹‰åƒé—®](https://tongyi.aliyun.com/) - é˜¿é‡Œäº‘å¤§æ¨¡å‹\n- [è±†åŒ…](https://www.doubao.com/) - å­—èŠ‚è·³åŠ¨å¤§æ¨¡å‹\n- [æ™ºè°±æ¸…è¨€](https://chatglm.cn/) - æ¸…åæ™ºè°± ChatGLM\n- [Kimi](https://kimi.moonshot.cn/) - æœˆä¹‹æš—é¢ï¼Œæ“…é•¿é•¿æ–‡æœ¬\n- [DeepSeek](https://www.deepseek.com/) - æ·±åº¦æ±‚ç´¢ï¼Œå¼ºæ¨ç†èƒ½åŠ›\n- [è…¾è®¯æ··å…ƒ](https://hunyuan.tencent.com/) - è…¾è®¯å¤§æ¨¡å‹\n- [è®¯é£æ˜Ÿç«](https://xinghuo.xfyun.cn/) - ç§‘å¤§è®¯é£å¤§æ¨¡å‹\n\n### å¼€æºæ¨¡å‹ç¤¾åŒº\n- [Hugging Face](https://huggingface.co/) - æœ€å¤§çš„å¼€æºæ¨¡å‹ç¤¾åŒº\n  - [Hugging Face Models](https://huggingface.co/models) - æ¨¡å‹åº“\n  - [Hugging Face Spaces](https://huggingface.co/spaces) - åœ¨çº¿æ¼”ç¤º\n- [ModelScope](https://modelscope.cn/) - é­”æ­ç¤¾åŒºï¼Œå›½å†…æ¨¡å‹å¹³å°\n- [GitHub Models](https://github.com/marketplace/models) - GitHub æ¨¡å‹å¸‚åœº\n- [Ollama](https://ollama.com/) - æœ¬åœ°è¿è¡Œå¤§æ¨¡å‹å·¥å…·\n\n### ç”Ÿç‰©åŒ»å­¦ä¸“ç”¨æ¨¡å‹\n- [BioGPT](https://github.com/microsoft/BioGPT) - å¾®è½¯ç”Ÿç‰©åŒ»å­¦æ–‡æœ¬ç”Ÿæˆæ¨¡å‹\n- [Med-PaLM](https://sites.research.google/med-palm/) - Google åŒ»ç–—ä¸“ç”¨å¤§æ¨¡å‹\n- [GeneGPT](https://github.com/ncbi/GeneGPT) - NCBI åŸºå› ä¿¡æ¯é—®ç­”æ¨¡å‹\n- [BioMed-LLM](https://github.com/OpenBioLink/biomedlm) - ç”Ÿç‰©åŒ»å­¦å¼€æºå¤§æ¨¡å‹\n- [Scientific Large Language Models](https://github.com/HKUNLP/Binder) - ç§‘ç ”ä¸“ç”¨æ¨¡å‹é›†åˆ\n\n### AI è¾…åŠ©å·¥å…·\n- [Cursor](https://cursor.sh/) - AI ä»£ç ç¼–è¾‘å™¨\n- [GitHub Copilot](https://github.com/features/copilot) - AI ç¼–ç¨‹åŠ©æ‰‹\n- [Codeium](https://codeium.com/) - å…è´¹ AI ä»£ç è¡¥å…¨\n- [Consensus](https://consensus.app/) - AI æ–‡çŒ®æœç´¢ä¸æ€»ç»“\n- [Elicit](https://elicit.org/) - AI ç ”ç©¶åŠ©æ‰‹\n- [SciSpace](https://scispace.com/) - AI è®ºæ–‡é˜…è¯»ä¸ç†è§£\n\n---\n\n## ğŸ“ åšå®¢ä¸å…¬ä¼—å·\n\n### æŠ€æœ¯åšå®¢\n- [Living in an Ivory Basement](https://ivory.idyll.org/blog/) - Titus Brown\n- [Simply Statistics](https://simplystatistics.org/) - ç»Ÿè®¡å­¦åšå®¢\n- [Bits of DNA](https://liorpachter.wordpress.com/) - Lior Pachter\n- [Heng Li's Blog](https://lh3.github.io/) - ææ’çš„åšå®¢\n\n### å¾®ä¿¡å…¬ä¼—å·\n- biobabble - ç”Ÿç‰©ä¿¡æ¯å­¦ç§‘æ™®\n- ç”Ÿä¿¡æŠ€èƒ½æ ‘ - ç”Ÿä¿¡å­¦ä¹ èµ„æº\n- ç”Ÿä¿¡èœé¸Ÿå›¢ - å…¥é—¨æ•™ç¨‹\n- Yå¤§å®½ - ç§‘ç ”ä¸ç¼–ç¨‹\n- ç”Ÿç‰©ä¿¡æ¯å­¦ä¹ åœˆ - å­¦ä¹ äº¤æµ\n\n---\n\n## ğŸ“ è¯¾ç¨‹ä¸è§†é¢‘\n\n### å…¬å¼€è¯¾\n- [MIT OpenCourseWare](https://ocw.mit.edu/) - MIT å¼€æ”¾è¯¾ç¨‹\n- [ç”Ÿç‰©ä¿¡æ¯å­¦å¯¼è®º](https://www.icourse163.org/) - ä¸­å›½å¤§å­¦MOOC\n- [Introduction to Genomic Data Science](https://www.coursera.org/specializations/genomic-data-science) - Coursera\n\n### è§†é¢‘æ•™ç¨‹\n- [YouTube - StatQuest](https://www.youtube.com/c/joshstarmer) - ç»Ÿè®¡å­¦ä¸æœºå™¨å­¦ä¹ \n- [Bilibili - ç”Ÿä¿¡äºº](https://space.bilibili.com/338686099) - ä¸­æ–‡ç”Ÿä¿¡æ•™ç¨‹\n\n---\n\n## ğŸ“Š å¯è§†åŒ–å·¥å…·\n\n- [ggplot2](https://ggplot2.tidyverse.org/) - R è¯­è¨€ç»˜å›¾åŒ…\n- [Matplotlib](https://matplotlib.org/) - Python ç»˜å›¾åº“\n- [Cytoscape](https://cytoscape.org/) - ç½‘ç»œå¯è§†åŒ–\n- [IGV](https://software.broadinstitute.org/software/igv/) - åŸºå› ç»„æµè§ˆå™¨\n- [BioRender](https://biorender.com/) - ç§‘ç ”æ’ç”»å·¥å…·\n\n---\n\n## ğŸŒŸ å…¶ä»–èµ„æº\n\n### ç§‘ç ”å·¥å…·\n- [Zotero](https://www.zotero.org/) - æ–‡çŒ®ç®¡ç†è½¯ä»¶\n- [Mendeley](https://www.mendeley.com/) - æ–‡çŒ®ç®¡ç†ä¸ç¤¾äº¤\n- [Overleaf](https://www.overleaf.com/) - åœ¨çº¿ LaTeX ç¼–è¾‘å™¨\n- [Sci-Hub](https://sci-hub.se/) - æ–‡çŒ®ä¸‹è½½ï¼ˆä½¿ç”¨éœ€è°¨æ…ï¼‰\n\n### æ•°æ®åˆ†æ\n\n#### ç¼–ç¨‹è¯­è¨€\n- [R Project](https://www.r-project.org/) - R è¯­è¨€å®˜ç½‘\n- [Python.org](https://www.python.org/) - Python å®˜ç½‘\n\n#### IDE ä¸ç¼–è¾‘å™¨\n- [RStudio](https://posit.co/) - R è¯­è¨€ä¸“ä¸š IDEï¼ˆPosit å…¬å¸ï¼‰\n- [Positron](https://github.com/posit-dev/positron) - Posit æ–°ä¸€ä»£æ•°æ®ç§‘å­¦ IDEï¼Œæ”¯æŒ Python å’Œ R\n- [Visual Studio Code](https://code.visualstudio.com/) - å¾®è½¯å¼€æºä»£ç ç¼–è¾‘å™¨\n  - [Python Extension](https://marketplace.visualstudio.com/items?itemName=ms-python.python) - Python å¼€å‘æ’ä»¶\n  - [R Extension](https://marketplace.visualstudio.com/items?itemName=REditorSupport.r) - R è¯­è¨€æ”¯æŒ\n- [PyCharm](https://www.jetbrains.com/pycharm/) - JetBrains Python IDE\n- [Jupyter Lab](https://jupyter.org/) - æ–°ä¸€ä»£ Jupyter ç•Œé¢\n- [Jupyter Notebook](https://jupyter.org/) - ç»å…¸äº¤äº’å¼ç¬”è®°æœ¬\n- [Google Colab](https://colab.research.google.com/) - åœ¨çº¿ Jupyter ç¯å¢ƒï¼Œå…è´¹ GPU\n- [Spyder](https://www.spyder-ide.org/) - ç§‘å­¦è®¡ç®— Python IDE\n- [Sublime Text](https://www.sublimetext.com/) - è½»é‡çº§æ–‡æœ¬ç¼–è¾‘å™¨\n\n#### åŒ…ç®¡ç†å·¥å…·\n- [uv](https://github.com/astral-sh/uv) - è¶…å¿«çš„ Python åŒ…å’Œé¡¹ç›®ç®¡ç†å™¨ï¼ˆRust ç¼–å†™ï¼‰\n- [Conda](https://docs.conda.io/) - è·¨å¹³å°åŒ…ç®¡ç†å™¨\n- [pip](https://pip.pypa.io/) - Python åŒ…ç®¡ç†å·¥å…·\n- [Poetry](https://python-poetry.org/) - ç°ä»£ Python ä¾èµ–ç®¡ç†å’Œæ‰“åŒ…å·¥å…·\n- [pipx](https://pipx.pypa.io/) - éš”ç¦»å®‰è£… Python åº”ç”¨ç¨‹åº\n- [rig](https://github.com/r-lib/rig) - R ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œè½»æ¾å®‰è£…å’Œåˆ‡æ¢å¤šä¸ª R ç‰ˆæœ¬\n- [renv](https://rstudio.github.io/renv/) - R é¡¹ç›®ç¯å¢ƒç®¡ç†\n\n### äº‘è®¡ç®—å¹³å°\n- [Google Colab](https://colab.research.google.com/) - å…è´¹ GPU/TPU è®¡ç®—\n- [AWS](https://aws.amazon.com/) - äºšé©¬é€Šäº‘æœåŠ¡\n- [é˜¿é‡Œäº‘](https://www.aliyun.com/) - å›½å†…äº‘è®¡ç®—å¹³å°\n\n---\n\n## ğŸ’¡ å­¦ä¹ å»ºè®®\n\n1. **ä»åŸºç¡€å¼€å§‹**ï¼šæŒæ¡ç¼–ç¨‹åŸºç¡€ï¼ˆPython/Rï¼‰å’Œ Linux æ“ä½œ\n2. **å¤šçœ‹å¤šç»ƒ**ï¼šå…³æ³¨ç¤¾åŒºåŠ¨æ€ï¼Œå®è·µå¼€æºé¡¹ç›®\n3. **å»ºç«‹ä½“ç³»**ï¼šç³»ç»Ÿå­¦ä¹ ç”Ÿç‰©å­¦èƒŒæ™¯çŸ¥è¯†\n4. **ä¿æŒæ›´æ–°**ï¼šå…³æ³¨æœ€æ–°æ–‡çŒ®å’Œå·¥å…·å‘å±•\n5. **äº¤æµåˆ†äº«**ï¼šåŠ å…¥ç¤¾åŒºï¼Œå‚ä¸è®¨è®º\n\n---\n\n*æœ€åæ›´æ–°ï¼š2026-02-25*"},{"title":"timeline","url":"/timeline/index.html","content":"\næš‚æ—¶æ²¡æœ‰ï¼Œå¯ä»¥çœ‹æ ‡ç­¾å’Œå½’æ¡£ã€‚"}]